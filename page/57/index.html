<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>Morris&#39; Blog</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="ACMer NEET NCU UVa OJ">
<meta property="og:type" content="website">
<meta property="og:title" content="Morris' Blog">
<meta property="og:url" content="http://morris821028.github.io/page/57/">
<meta property="og:site_name" content="Morris' Blog">
<meta property="og:description" content="ACMer NEET NCU UVa OJ">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Morris' Blog">
<meta name="twitter:description" content="ACMer NEET NCU UVa OJ">
<link rel="publisher" href="108158678174364350000">

  
    <link rel="alternative" href="/atom.xml" title="Morris&#39; Blog" type="application/atom+xml">
  
  
    <meta name="google-site-verification" content="5mRgj8NanEMpGZuNfHNJNmH90RgNlrnJXsFlTaKD6Gs" />
  
  
    <link rel="shortcut icon" href="/img/f.ico">
  
  <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  <script src="/js/jquery-2.1.0.min.js"></script>
  <link rel="stylesheet" href="/css/style.css" type="text/css">

  
  <!-- mathjax config similar to math.stackexchange -->

<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    tex2jax: {
      inlineMath: [ ['$','$'], ["\\(","\\)"] ],
      processEscapes: true
    }
  });
</script>

<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
      tex2jax: {
        skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
      }
    });
</script>

<script type="text/x-mathjax-config">
    MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax(), i;
        for(i=0; i < all.length; i += 1) {
            all[i].SourceElement().parentNode.className += ' has-jax';
        }
    });
</script>

<script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>
  <link rel="stylesheet" href="http://cdn.oesmith.co.uk/morris-0.5.1.css">
<script src="//cdnjs.cloudflare.com/ajax/libs/raphael/2.1.0/raphael-min.js"></script>
<script src="http://cdn.oesmith.co.uk/morris-0.5.1.min.js"></script>
</head>
<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"><div id="banner-right"></div></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">Morris&#39; Blog</a>
      </h1>
      
        <h2 id="subtitle-wrap">
          <a href="/" id="subtitle">Can you find me ?</a>
        </h2>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          
            <a class="main-nav-link" href="/"><i class=icon-home title='Home'></i></a>
          
        
          
            <a class="main-nav-link" href="/about"><i class=icon-user title='About'></i></a>
          
        
          
            <a class="main-nav-link" href="/archives"><i class=icon-archive title='Archives'></i></a>
          
        
          
            <a class="main-nav-link" href="/tags"><i class=icon-tags title='Tags'></i></a>
          
        
          
            <a class="main-nav-link" href="/picture"><i class=icon-camera title='Pictures'></i></a>
          
        
          
            <a class="main-nav-link" href="/works"><i class=icon-trophy title='Works'></i></a>
          
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" results="0" class="search-form-input" placeholder="Search"><input type="submit" value="&#xF002;" class="search-form-submit"><input type="hidden" name="q" value="site:http://morris821028.github.io"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        
          <section id="main">
  
    <article id="post-oj/uva/uva-349" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2014/06/24/oj/uva/uva-349/" class="article-date">
  <time datetime="2014-06-24T13:02:14.000Z" itemprop="datePublished">Jun 24 2014</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/解題區/">解題區</a>►<a class="article-category-link" href="/categories/解題區/解題區-UVa/">解題區 - UVa</a>
  </div>

  </div>
  <div class="article-inner ">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2014/06/24/oj/uva/uva-349/">UVa 349 - Transferable Voting (II)</a>
    </h1>
  

      </header>
        
    <footer class="article-footer">
      <a data-url="http://morris821028.github.io/2014/06/24/oj/uva/uva-349/" data-id="5qiqbt66f3tunapn" class="article-share-link">Share</a>
      
        <a href="http://morris821028.github.io/2014/06/24/oj/uva/uva-349/#disqus_thread" class="article-comment-link">Comments</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/模擬/">模擬</a></li></ul>

    </footer>
    <div class="article-entry article-index" itemprop="articleBody">
      
          
        
          <div class="toggle-content">
            <h2 id="Problem">Problem</h2>
<p>The Transferable Vote system for determining the winner of an election requires that a successful candidate obtain an absolute majority of the votes cast, even when there are more than two candidates. To achieve this goal, each voter completes his or her ballot by listing all the candidates in order of preference. Thus if there are five candidates for a single position, each voter’s ballot must contain five choices, from first choice to fifth choice.</p>
<p>In this problem you are to determine the winner, if any, of elections using the Transferable Vote system. If there are c candidates for the single position, then each voter’s ballot will include c distinct choices, corresponding to identifying the voter’s first place, second place, tex2html_wrap_inline32 , and nth place selections. Invalid ballots will be discarded, but their presence will be noted. A ballot is invalid if a voter’s choices are not distinct (choosing the same candidate as first and second choice isn’t permitted) or if any of the choices aren’t legal (that is, in the range 1 to c).</p>
<p>For each election candidates will be assigned sequential numbers starting with 1. The maximum number of voters in this problem will be 100, and the maximum number of candidates will be 5.</p>
<pre><code>                           <span class="keyword">Table</span> A                 <span class="keyword">Table</span> B
               -------------------------------    --------- 
               Voter    <span class="keyword">First</span>   Second  Third
                        Choice  Choice  Choice
                 <span class="number">1</span>        <span class="number">1</span>       <span class="number">2</span>       <span class="number">4</span>
                 <span class="number">2</span>        <span class="number">1</span>       <span class="number">3</span>       <span class="number">2</span>       <span class="number">1</span>   <span class="number">3</span>   <span class="number">2</span>
                 <span class="number">3</span>        <span class="number">3</span>       <span class="number">2</span>       <span class="number">1</span>       <span class="number">3</span>   <span class="number">2</span>   <span class="number">1</span>
                 <span class="number">4</span>        <span class="number">3</span>       <span class="number">2</span>       <span class="number">1</span>       <span class="number">3</span>   <span class="number">2</span>   <span class="number">1</span>
                 <span class="number">5</span>        <span class="number">1</span>       <span class="number">2</span>       <span class="number">3</span>       <span class="number">1</span>   <span class="number">2</span>   <span class="number">3</span>
                 <span class="number">6</span>        <span class="number">2</span>       <span class="number">3</span>       <span class="number">1</span>       <span class="number">3</span>   <span class="number">1</span>
                 <span class="number">7</span>        <span class="number">3</span>       <span class="number">2</span>       <span class="number">1</span>       <span class="number">3</span>   <span class="number">2</span>   <span class="number">1</span>
                 <span class="number">8</span>        <span class="number">3</span>       <span class="number">1</span>       <span class="number">1</span>
                 <span class="number">9</span>        <span class="number">3</span>       <span class="number">2</span>       <span class="number">1</span>       <span class="number">3</span>   <span class="number">2</span>   <span class="number">1</span>
                <span class="number">10</span>        <span class="number">1</span>       <span class="number">2</span>       <span class="number">3</span>       <span class="number">1</span>   <span class="number">2</span>   <span class="number">3</span>
                <span class="number">11</span>        <span class="number">1</span>       <span class="number">3</span>       <span class="number">2</span>       <span class="number">1</span>   <span class="number">3</span>   <span class="number">2</span>
                <span class="number">12</span>        <span class="number">2</span>       <span class="number">3</span>       <span class="number">1</span>       <span class="number">3</span>   <span class="number">1</span>
</code></pre><p>Consider a very small election. In Table A are the votes from the 12 voters for the three candidates. Voters 1 and 8 cast invalid ballots; they will not be counted. This leaves 10 valid ballots, so a winning candidate will require at least 6 votes (the least integer value greater than half the number of valid ballots) to win. Candidates 1 and 3 each have 4 first choice votes, and candidate 2 has two. There is no majority, so the candidate with the fewest first choice votes, candidate 2, is eliminated. If there had been several candidates with the fewest first choice votes, any of them, selected at random, could be selected for elimination.</p>
<p>With candidate 2 eliminated, we advance the second and third choice candidates from those voters who voted for candidate 2 as their first choice. The result of this action is shown in Table B. Now candidate 3 has picked up 2 additional votes, giving a total of 6. This is sufficient for election. Note that if voter 12 had cast the ballot <code>2 1 3</code> then there would have been a tie between candidates 1 and 3.</p>
<h2 id="Input">Input</h2>
<p>There will be one or more elections to consider. Each will begin with a line containing the number of candidates and the number of voters, c and n. Data for the last election will be followed by a line containing two zeroes.</p>
<p>Following the first line for each election will be n additional lines each containing the choices from a single ballot. Each line will contain only c non-negative integers separated by whitespace.</p>
<h2 id="Output">Output</h2>
<p>For each election, print a line identifying the election number (they are numbered sequentially starting with 1). If there were any invalid ballots, print an additional line specifying the number of such. Finally, print a line indicating the winner of the election, if any, or indication of a tie; be certain to identify the candidates who are tied. Look at the samples below for the exact output format.</p>
<h2 id="Sample_Input">Sample Input</h2>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div></pre></td><td class="code"><pre><div class="line">3 12</div><div class="line">1 2 4</div><div class="line">1 3 2</div><div class="line">3 2 1</div><div class="line">3 2 1</div><div class="line">1 2 3</div><div class="line">2 3 1</div><div class="line">3 2 1</div><div class="line">3 1 1</div><div class="line">3 2 1</div><div class="line">1 2 3</div><div class="line">1 3 2</div><div class="line">2 3 1</div><div class="line">3 12</div><div class="line">1 2 4</div><div class="line">1 3 2</div><div class="line">3 2 1</div><div class="line">3 2 1</div><div class="line">1 2 3</div><div class="line">2 3 1</div><div class="line">3 2 1</div><div class="line">3 1 1</div><div class="line">3 2 1</div><div class="line">1 2 3</div><div class="line">1 3 2</div><div class="line">2 1 3</div><div class="line">4 15</div><div class="line">4 3 1 2</div><div class="line">4 1 2 3</div><div class="line">3 1 4 2</div><div class="line">1 3 2 4</div><div class="line">4 1 2 3</div><div class="line">3 4 2 1</div><div class="line">2 4 3 1</div><div class="line">3 2 1 4</div><div class="line">3 1 4 2</div><div class="line">1 4 2 3</div><div class="line">3 4 1 2</div><div class="line">3 2 1 4</div><div class="line">4 1 3 2</div><div class="line">3 2 1 4</div><div class="line">4 2 1 4</div><div class="line">0 0</div></pre></td></tr></table></figure>

<h2 id="Sample_Output">Sample Output</h2>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">Election <span class="preprocessor">#1</span></div><div class="line">   <span class="number">2</span> bad ballot(s)</div><div class="line">   Candidate <span class="number">3</span> <span class="keyword">is</span> elected.</div><div class="line">Election <span class="preprocessor">#2</span></div><div class="line">   <span class="number">2</span> bad ballot(s)</div><div class="line">   The following candidates are tied: <span class="number">1</span> <span class="number">3</span></div><div class="line">Election <span class="preprocessor">#3</span></div><div class="line">   <span class="number">1</span> bad ballot(s)</div><div class="line">   Candidate <span class="number">3</span> <span class="keyword">is</span> elected.</div></pre></td></tr></table></figure>

<h2 id="Solution">Solution</h2>
<p><strong> 題目描述： </strong></p>
<p>投票時紀錄自願序，接著每一輪刷掉得票數量最小的候選人，直到所有候選人得票數皆相同或者只剩下一個候選人。若自願序中前位者遭到刷掉，則由下一個志願候選人替補。</p>
<p>如果發現志願序中有重複候選人、或者是不存在的候選人則將此票視為廢票。</p>
<p><strong> 題目解法： </strong></p>
<p>模擬！</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div></pre></td><td class="code"><pre><div class="line"><span class="preprocessor">#<span class="keyword">include</span> &lt;stdio.h&gt;</span></div><div class="line"><span class="preprocessor">#<span class="keyword">include</span> &lt;string.h&gt;</span></div><div class="line"><span class="preprocessor">#<span class="keyword">include</span> &lt;algorithm&gt;</span></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"></div><div class="line"><span class="keyword">int</span> main() {</div><div class="line">	<span class="keyword">int</span> n, m, cases = <span class="number">0</span>, x;</div><div class="line">	<span class="keyword">while</span>(<span class="built_in">scanf</span>(<span class="string">"%d %d"</span>, &amp;n, &amp;m) == <span class="number">2</span> &amp;&amp; n+m) {</div><div class="line">		<span class="keyword">int</span> bad[<span class="number">1024</span>] = {}, A[<span class="number">1024</span>][<span class="number">16</span>];</div><div class="line">		<span class="keyword">int</span> badCount = <span class="number">0</span>;</div><div class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; m; i++) {</div><div class="line">			<span class="keyword">int</span> mark[<span class="number">16</span>] = {};</div><div class="line">			<span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; n; j++) {</div><div class="line">				<span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;x);</div><div class="line">				A[i][j] = x;</div><div class="line">				<span class="keyword">if</span>(x &gt; n || x &lt; <span class="number">1</span>) {</div><div class="line">					bad[i] = <span class="number">1</span>;</div><div class="line">					<span class="keyword">continue</span>;</div><div class="line">				}</div><div class="line">				mark[x]++;</div><div class="line">				<span class="keyword">if</span>(mark[x] &gt; <span class="number">1</span>)</div><div class="line">					bad[i] = <span class="number">1</span>;</div><div class="line">			}</div><div class="line">			badCount += bad[i];</div><div class="line">		}</div><div class="line">		</div><div class="line">		<span class="built_in">printf</span>(<span class="string">"Election #%d\n"</span>, ++cases);</div><div class="line">		<span class="built_in">printf</span>(<span class="string">"   %d bad ballot(s)\n"</span>, badCount);</div><div class="line">		</div><div class="line">		<span class="keyword">int</span> Atop[<span class="number">1024</span>] = {}, alive[<span class="number">1024</span>] = {}, aliveCount = n;</div><div class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; n; i++) {</div><div class="line">			<span class="keyword">int</span> votes[<span class="number">16</span>] = {}, mx = <span class="number">0</span>, del = -<span class="number">1</span>;</div><div class="line">			<span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; m; j++) {</div><div class="line">				<span class="keyword">if</span>(bad[j])	<span class="keyword">continue</span>;</div><div class="line">				<span class="keyword">while</span>(alive[A[j][Atop[j]]])</div><div class="line">					Atop[j]++;</div><div class="line">				votes[A[j][Atop[j]]]++;</div><div class="line">			}</div><div class="line">			<span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= n; j++)</div><div class="line">				mx = max(mx, votes[j]);</div><div class="line">			<span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= n; j++) {</div><div class="line">				<span class="keyword">if</span>(votes[j] &lt; mx &amp;&amp; alive[j] == <span class="number">0</span>)</div><div class="line">					del = j, mx = votes[j];</div><div class="line">			}</div><div class="line">			<span class="keyword">if</span>(del == -<span class="number">1</span>)	<span class="keyword">break</span>;</div><div class="line">			alive[del] = <span class="number">1</span>, aliveCount--;</div><div class="line">		}</div><div class="line">		<span class="keyword">if</span>(aliveCount == <span class="number">1</span>) {</div><div class="line">			<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++)</div><div class="line">				<span class="keyword">if</span>(alive[i] == <span class="number">0</span>)</div><div class="line">					<span class="built_in">printf</span>(<span class="string">"   Candidate %d is elected.\n"</span>, i);</div><div class="line">		} <span class="keyword">else</span> {</div><div class="line">			<span class="built_in">printf</span>(<span class="string">"   The following candidates are tied:"</span>);</div><div class="line">			<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++)</div><div class="line">				<span class="keyword">if</span>(alive[i] == <span class="number">0</span>)</div><div class="line">					<span class="built_in">printf</span>(<span class="string">" %d"</span>, i);</div><div class="line">			<span class="built_in">puts</span>(<span class="string">""</span>);</div><div class="line">		}</div><div class="line">	}</div><div class="line">	<span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">}</div></pre></td></tr></table></figure>
          </div>
          <div class="toggle-input article-more-link"><a>Read More +</a></div>
        
      
    </div>

  </div>
  
</article>


  
    <article id="post-oj/uva/uva-302" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2014/06/24/oj/uva/uva-302/" class="article-date">
  <time datetime="2014-06-24T12:50:43.000Z" itemprop="datePublished">Jun 24 2014</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/解題區/">解題區</a>►<a class="article-category-link" href="/categories/解題區/解題區-UVa/">解題區 - UVa</a>
  </div>

  </div>
  <div class="article-inner ">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2014/06/24/oj/uva/uva-302/">UVa 302 - John&#39;s trip</a>
    </h1>
  

      </header>
        
    <footer class="article-footer">
      <a data-url="http://morris821028.github.io/2014/06/24/oj/uva/uva-302/" data-id="nfakc2h3reunnlcr" class="article-share-link">Share</a>
      
        <a href="http://morris821028.github.io/2014/06/24/oj/uva/uva-302/#disqus_thread" class="article-comment-link">Comments</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/尤拉環道/">尤拉環道</a></li></ul>

    </footer>
    <div class="article-entry article-index" itemprop="articleBody">
      
          
        
          <div class="toggle-content">
            <h2 id="Problem">Problem</h2>
<p>Little Johnny has got a new car. He decided to drive around the town to visit his friends. Johnny wanted to visit all his friends, but there was many of them. In each street he had one friend. He started thinking how to make his trip as short as possible. Very soon he realized that the best way to do it was to travel through each street of town only once. Naturally, he wanted to finish his trip at the same place he started, at his parents’ house.</p>
<p>The streets in Johnny’s town were named by integer numbers from 1 to n, n &lt; 1995. The junctions were independently named by integer numbers from 1 to m, tex2html_wrap_inline32 . All junctions in the town had different numbers. Each street was connecting exactly two (not necessarily different) junctions. No two streets in the town had the same number. He immediately started to plan his round trip. If there was more than one such round trip, he would have chosen the one which, when written down as a sequence of street numbers is lexicographically the smallest.</p>
<p>But Johnny was not able to find even one such round trip. Help Johnny and write a program which finds the desired shortest round trip. If the round trip does not exist the program should write a message. Assume that Johnny lives at the junction ending the 1st street input with smaller number. All streets in the town are two way. There exists a way from each street to another street in the town. The streets in the town are very narrow and there is no possibility to turn back the car once he is in the street.</p>
<h2 id="Input">Input</h2>
<p>Input file consists of several blocks. Each block describes one town. Each line in the block contains three integers x, y, z, where x &gt; 0 and y &gt; 0 are the numbers of junctions which are connected by the street number z. The end of the block is marked by the line containing x = y = 0. At the end of the input file there is an empty block, x = y = 0.</p>
<h2 id="Output">Output</h2>
<p>The output file consists of 2 line blocks corresponding to the blocks of the input file. The first line of each block contains the sequence of street numbers (single members of the sequence are separated by space) describing Johnny’s round trip. If the round trip cannot be found the corresponding output block contains the message ``Round trip does not exist.’’. The second line of each block is empty.</p>
<h2 id="Sample_Input">Sample Input</h2>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line">1 2 1</div><div class="line">2 3 2</div><div class="line">3 1 6</div><div class="line">1 2 5</div><div class="line">2 3 3</div><div class="line">3 1 4</div><div class="line">0 0</div><div class="line">1 2 1</div><div class="line">2 3 2</div><div class="line">1 3 3</div><div class="line">2 4 4</div><div class="line">0 0</div><div class="line">0 0</div></pre></td></tr></table></figure>

<h2 id="Sample_Output">Sample Output</h2>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="number">1</span> <span class="number">2</span> <span class="number">3</span> <span class="number">5</span> <span class="number">4</span> <span class="number">6</span></div><div class="line"></div><div class="line"><span class="variable">Round</span> trip does <span class="keyword">not</span> exist.</div></pre></td></tr></table></figure>

<h2 id="Solution">Solution</h2>
<p><strong> 題目描述： </strong></p>
<p>每一條路上都有編號，並且每個編號唯一且個數小於 44。</p>
<p>求一條經過所有邊且不重複的環道。</p>
<p><strong> 題目解法： </strong></p>
<p>記得注意起始是第一條邊最小編號的點。</p>
<p>之後對於每一個點相鄰邊根據編號進行排序即可，按著窮舉思路由小開始枚舉即可。</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div></pre></td><td class="code"><pre><div class="line"><span class="preprocessor">#<span class="keyword">include</span> &lt;stdio.h&gt;</span></div><div class="line"><span class="preprocessor">#<span class="keyword">include</span> &lt;string.h&gt;</span></div><div class="line"><span class="preprocessor">#<span class="keyword">include</span> &lt;vector&gt;</span></div><div class="line"><span class="preprocessor">#<span class="keyword">include</span> &lt;algorithm&gt;</span></div><div class="line"><span class="preprocessor">#<span class="keyword">include</span> &lt;deque&gt;</span></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"><span class="keyword">struct</span> edge {</div><div class="line">	<span class="keyword">int</span> to, label;</div><div class="line">	edge(<span class="keyword">int</span> a=<span class="number">0</span>, <span class="keyword">int</span> b=<span class="number">0</span>):</div><div class="line">		to(a), label(b) {}</div><div class="line">	<span class="keyword">bool</span> <span class="keyword">operator</span>&lt;(<span class="keyword">const</span> edge &amp;x) <span class="keyword">const</span> {</div><div class="line">		<span class="keyword">return</span> label &lt; x.label;</div><div class="line">	}</div><div class="line">};</div><div class="line"><span class="preprocessor">#<span class="keyword">define</span> MAXN 2048</span></div><div class="line"><span class="stl_container"><span class="built_in">vector</span>&lt;edge&gt;</span> g[MAXN];</div><div class="line"><span class="keyword">int</span> label_used[MAXN];</div><div class="line"><span class="stl_container"><span class="built_in">deque</span>&lt;<span class="keyword">int</span>&gt;</span>	path;</div><div class="line"><span class="keyword">void</span> dfs(<span class="keyword">int</span> u) {</div><div class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; g[u].size(); i++) {</div><div class="line">        <span class="keyword">if</span>(label_used[g[u][i].label] == <span class="number">0</span>) {</div><div class="line">        	label_used[g[u][i].label] = <span class="number">1</span>;</div><div class="line">            dfs(g[u][i].to);</div><div class="line">            path.push_front(g[u][i].label);</div><div class="line">        }</div><div class="line">    }</div><div class="line">}</div><div class="line"><span class="keyword">int</span> main() {</div><div class="line">	<span class="keyword">int</span> x, y, z;</div><div class="line">    <span class="keyword">while</span>(<span class="keyword">true</span>) {</div><div class="line">    	<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; MAXN; i++)</div><div class="line">    		g[i].clear();</div><div class="line">    	<span class="keyword">int</span> e = <span class="number">0</span>, start = <span class="number">0</span>;</div><div class="line">    	<span class="keyword">while</span>(<span class="built_in">scanf</span>(<span class="string">"%d %d"</span>, &amp;x, &amp;y) == <span class="number">2</span>) {</div><div class="line">    		<span class="keyword">if</span>(x == <span class="number">0</span> &amp;&amp; y == <span class="number">0</span>)</div><div class="line">    			<span class="keyword">break</span>;</div><div class="line">    		<span class="comment">/* Johnny lives at the junction ending the 1st street </span></div><div class="line">				input with smaller number. */</div><div class="line">    		<span class="keyword">if</span>(e == <span class="number">0</span>)</div><div class="line">    			start = min(x, y);</div><div class="line">    		<span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;z);</div><div class="line">    		g[x].push_back(edge(y, z));</div><div class="line">    		g[y].push_back(edge(x, z));</div><div class="line">    		e++;</div><div class="line">    	}</div><div class="line">    	<span class="keyword">if</span>(e == <span class="number">0</span>)	<span class="keyword">break</span>;</div><div class="line">    	</div><div class="line">    	<span class="keyword">int</span> odd = <span class="number">1</span>;</div><div class="line">    	<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; MAXN; i++) {</div><div class="line">    		odd &amp;= g[i].size()%<span class="number">2</span> == <span class="number">0</span>;</div><div class="line">    	}</div><div class="line">    	<span class="keyword">if</span>(!odd) {</div><div class="line">    		<span class="built_in">puts</span>(<span class="string">"Round trip does not exist.\n"</span>);</div><div class="line">    		<span class="keyword">continue</span>;</div><div class="line">    	}</div><div class="line">    	<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; MAXN; i++)</div><div class="line">    		sort(g[i].begin(), g[i].end());</div><div class="line">    	<span class="built_in">memset</span>(label_used, <span class="number">0</span>, <span class="keyword">sizeof</span>(label_used));</div><div class="line">    	path.clear();</div><div class="line">    	dfs(start);</div><div class="line">    	<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; path.size(); i++) </div><div class="line">    		<span class="built_in">printf</span>(<span class="string">"%d%c"</span>, path[i], i == path.size()-<span class="number">1</span> ? <span class="string">'\n'</span> : <span class="string">' '</span>);</div><div class="line">    	<span class="built_in">puts</span>(<span class="string">""</span>);</div><div class="line">    }</div><div class="line">    <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">}</div></pre></td></tr></table></figure>
          </div>
          <div class="toggle-input article-more-link"><a>Read More +</a></div>
        
      
    </div>

  </div>
  
</article>


  
    <article id="post-oj/uva/uva-11837" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2014/06/24/oj/uva/uva-11837/" class="article-date">
  <time datetime="2014-06-24T11:15:39.000Z" itemprop="datePublished">Jun 24 2014</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/解題區/">解題區</a>►<a class="article-category-link" href="/categories/解題區/解題區-UVa/">解題區 - UVa</a>
  </div>

  </div>
  <div class="article-inner ">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2014/06/24/oj/uva/uva-11837/">UVa 11837 - Musical Plagiarism</a>
    </h1>
  

      </header>
        
    <footer class="article-footer">
      <a data-url="http://morris821028.github.io/2014/06/24/oj/uva/uva-11837/" data-id="q0ihnifiide2y33d" class="article-share-link">Share</a>
      
        <a href="http://morris821028.github.io/2014/06/24/oj/uva/uva-11837/#disqus_thread" class="article-comment-link">Comments</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/KMP/">KMP</a></li></ul>

    </footer>
    <div class="article-entry article-index" itemprop="articleBody">
      
          
        
          <div class="toggle-content">
            <h2 id="Problem">Problem</h2>
<p>The musical notes are the basic units of Western music. Each note is associated with a frequency. Two notes for which the fundamental frequencies have a ratio of power of 2 (one is half of the other, one is double of the other, etc..) are perceived as very similar. Therefore, any notes with that kind of relationship are given the same name, as described below.</p>
<p>There are twelve basic notes in a sequence of increasing frequency, each note separated from the previous note by the same distance in the musical scale (this distance is called a semitone). Seven of these twelve notes are represented by letters of the alphabet (A, B, C, D, E, F and G). The table below shows the distance, in semitones, between the notes.</p>
<p>Notes     A-B     B-C     C-D     D-E     E-F     F-G     G-A<br>Number of semitone     2     1     2     2     1     2     2     </p>
<p>Notice that there are five notes that are not represented by letters of the alphabet: the notes between A and B, between C and D, between D and E, betwen F and G and between G and A.</p>
<p>Notes can be modified by two accidentals, called sharp and flat, represented respectively by the symbols <code>#&#39; and</code>b’. A sharp raises the note a semitone, a flat lowers the note a semitone. A note with an accidental is denoted by the name of the note followed by the accidental symbol. Notice that with this scheme we can represent all twelve notes.</p>
<p>The figure below illustrates the name of the notes in accordance with the scheme described above, in a fragment of a piano keyboard.</p>
<p>A melody can be represented by a sequence of notes. For example,</p>
<p>A A D C# C# D E E E F# A D G# A</p>
<p>is a well known melody. Note however that as the distances between the semitones are always equal, the same melody can be written starting with another note (we say that the melody is in another key):</p>
<p>B B E D# D# E Gb Gb Gb G# B E A# B</p>
<p>Your neighbor is a famous composer who suspects someone has plagiarized one of her songs. She asked your help to write a program that, given the sequence of notes of the melody in her song, and the sequence of notes of a suspicious snippet of melody, determines if the suspicious snippet occurs, in some key, in her song.</p>
<h2 id="Input">Input</h2>
<p>The input consists of several test cases. The first line of a test case contains two integers M and T ( 1$ \le$M$ \le$105, 1$ \le$T$ \le$104, T$ \le$M), indicating the number of notes in the song suspected of having been plagiarized and in the suspect snippet. Each of the next two lines contains M and T notes, respectively, indicating the notes of the song and of the suspect snippet.</p>
<p>Notes in each line are separated by one space; each note is one among <code>A&#39;,</code>B’, <code>C&#39;,</code>D’, <code>E&#39;,</code>F’ or <code>G&#39;, possibly followed by an accidental sign:</code>#’ for sharp or `b’ for flat.</p>
<p>The last test case is followed by a line containing only two zeros separated by a blank space.</p>
<h2 id="Output">Output</h2>
<p>For each test case your program must print a single line containing one character, <code>S&#39; in case the song has been plagiarized by the text, or</code>N’ in case the song has not been plagiarized by the text.</p>
<h2 id="Sample_Input">Sample Input</h2>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="number">16</span> <span class="number">4</span></div><div class="line"><span class="keyword">D</span> G A B <span class="keyword">C</span> <span class="keyword">D</span> G G G <span class="keyword">C</span> <span class="keyword">D</span> <span class="keyword">E</span> F# G <span class="keyword">C</span> <span class="keyword">C</span></div><div class="line">G G <span class="keyword">C</span> <span class="keyword">D</span></div><div class="line"><span class="number">12</span> <span class="number">2</span></div><div class="line"><span class="keyword">C</span> <span class="keyword">C</span># <span class="keyword">D</span> <span class="keyword">D</span># <span class="keyword">E</span> F F# G G# A A# B</div><div class="line"><span class="keyword">C</span> <span class="keyword">D</span></div><div class="line"><span class="number">12</span> <span class="number">2</span></div><div class="line"><span class="keyword">C</span> Db <span class="keyword">D</span> Eb <span class="keyword">E</span> F Gb G Ab A Bb B</div><div class="line"><span class="keyword">C</span> <span class="keyword">D</span></div><div class="line"><span class="number">4</span> <span class="number">3</span></div><div class="line"><span class="keyword">C</span> <span class="keyword">E</span> G Bb</div><div class="line"><span class="keyword">D</span> F# A</div><div class="line"><span class="number">0</span> <span class="number">0</span></div></pre></td></tr></table></figure>

<h2 id="Sample_Output">Sample Output</h2>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">S</div><div class="line"><span class="keyword">N</span></div><div class="line"><span class="keyword">N</span></div><div class="line">S</div></pre></td></tr></table></figure>

<h2 id="Solution">Solution</h2>
<p><strong> 題目描述： </strong></p>
<blockquote>
<p>音階 全全半全全全半，全音中間夾一個黑/白鍵，半音之間沒有。</p>
</blockquote>
<p>計算是否為旋律中的一部分，計算旋律時只需考慮音符之間的距離即可，與高低幾度偏移沒有關係。</p>
<p><strong> 題目解法： </strong></p>
<p>特別小心，查詢的旋律長度為 1 的時候，無法判斷 (雖然以子字串是有在的)。</p>
<p>接著，直接對距離之間取模之後得到兩個整數序列，直接套用 KMP 判斷序列是否在另一個序列中。</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div></pre></td><td class="code"><pre><div class="line"><span class="preprocessor">#<span class="keyword">include</span> &lt;stdio.h&gt;</span></div><div class="line"><span class="preprocessor">#<span class="keyword">include</span> &lt;algorithm&gt;</span></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"><span class="keyword">int</span> notes[<span class="number">128</span>] = {};</div><div class="line"><span class="keyword">int</span> kmpTable[<span class="number">500005</span>];</div><div class="line"><span class="keyword">void</span> KMPtable(<span class="keyword">int</span> *P, <span class="keyword">int</span> len) {</div><div class="line">    <span class="keyword">int</span> i, j;</div><div class="line">    kmpTable[<span class="number">0</span>] = -<span class="number">1</span>, i = <span class="number">1</span>, j = -<span class="number">1</span>;</div><div class="line">    <span class="keyword">while</span>(i &lt; len) {</div><div class="line">        <span class="keyword">while</span>(j &gt;= <span class="number">0</span> &amp;&amp; P[j+<span class="number">1</span>] != P[i])</div><div class="line">            j = kmpTable[j];</div><div class="line">        <span class="keyword">if</span>(P[j+<span class="number">1</span>] == P[i])</div><div class="line">            j++;</div><div class="line">        kmpTable[i++] = j;</div><div class="line">    }</div><div class="line">}</div><div class="line"><span class="keyword">int</span> KMPmatching(<span class="keyword">int</span> T[], <span class="keyword">int</span> P[], <span class="keyword">int</span> tlen, <span class="keyword">int</span> plen) {</div><div class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>, j = -<span class="number">1</span>; i &lt; tlen; i++) {</div><div class="line">        <span class="keyword">while</span>(j &gt;= <span class="number">0</span> &amp;&amp; P[j+<span class="number">1</span>] != T[i])</div><div class="line">            j = kmpTable[j];</div><div class="line">        <span class="keyword">if</span>(P[j+<span class="number">1</span>] == T[i])  j++;</div><div class="line">        <span class="keyword">if</span>(j == plen-<span class="number">1</span>) {</div><div class="line">            j = kmpTable[j];</div><div class="line">            <span class="keyword">return</span> i;</div><div class="line">        }</div><div class="line">    }</div><div class="line">    <span class="keyword">return</span> -<span class="number">1</span>;</div><div class="line">}</div><div class="line"><span class="keyword">int</span> main() {</div><div class="line">	<span class="keyword">int</span> M, T;</div><div class="line">	<span class="keyword">int</span> A[<span class="number">100005</span>], B[<span class="number">10005</span>];</div><div class="line">	<span class="keyword">char</span> s[<span class="number">10</span>];</div><div class="line">	notes[<span class="string">'C'</span>] = <span class="number">0</span>, notes[<span class="string">'D'</span>] = <span class="number">2</span>;</div><div class="line">	notes[<span class="string">'E'</span>] = <span class="number">4</span>,	notes[<span class="string">'F'</span>] = <span class="number">5</span>;</div><div class="line">	notes[<span class="string">'G'</span>] = <span class="number">7</span>,	notes[<span class="string">'A'</span>] = <span class="number">9</span>;</div><div class="line">	notes[<span class="string">'B'</span>] = <span class="number">11</span>;</div><div class="line">	<span class="keyword">while</span>(<span class="built_in">scanf</span>(<span class="string">"%d %d"</span>, &amp;M, &amp;T) == <span class="number">2</span> &amp;&amp; M + T) {</div><div class="line">		<span class="keyword">int</span> prev, x;</div><div class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; M; i++) {</div><div class="line">			<span class="built_in">scanf</span>(<span class="string">"%s"</span>, &amp;s);</div><div class="line">			x = (notes[s[<span class="number">0</span>]] + (s[<span class="number">1</span>] == <span class="string">'#'</span>) - (s[<span class="number">1</span>] == <span class="string">'b'</span>) + <span class="number">12</span>)%<span class="number">12</span>;</div><div class="line">			<span class="keyword">if</span>(i)	A[i - <span class="number">1</span>] = (prev - x + <span class="number">12</span>)%<span class="number">12</span>;</div><div class="line">			prev = x;</div><div class="line">		}</div><div class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; T; i++) {</div><div class="line">			<span class="built_in">scanf</span>(<span class="string">"%s"</span>, &amp;s);</div><div class="line">			x = (notes[s[<span class="number">0</span>]] + (s[<span class="number">1</span>] == <span class="string">'#'</span>) - (s[<span class="number">1</span>] == <span class="string">'b'</span>) + <span class="number">12</span>)%<span class="number">12</span>;</div><div class="line">			<span class="keyword">if</span>(i)	B[i - <span class="number">1</span>] = (prev - x + <span class="number">12</span>)%<span class="number">12</span>;</div><div class="line">			prev = x;</div><div class="line">		}</div><div class="line">		KMPtable(A, M - <span class="number">1</span>);</div><div class="line">		<span class="built_in">puts</span>( KMPmatching(A, B, M - <span class="number">1</span>, T - <span class="number">1</span>) &gt;= <span class="number">0</span> ? <span class="string">"S"</span> : <span class="string">"N"</span>);</div><div class="line">	}</div><div class="line">	<span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">}</div></pre></td></tr></table></figure>

          </div>
          <div class="toggle-input article-more-link"><a>Read More +</a></div>
        
      
    </div>

  </div>
  
</article>


  
    <article id="post-oj/uva/uva-198" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2014/06/24/oj/uva/uva-198/" class="article-date">
  <time datetime="2014-06-24T10:55:25.000Z" itemprop="datePublished">Jun 24 2014</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/解題區/">解題區</a>►<a class="article-category-link" href="/categories/解題區/解題區-UVa/">解題區 - UVa</a>
  </div>

  </div>
  <div class="article-inner ">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2014/06/24/oj/uva/uva-198/">UVa 198 - Peter&#39;s Calculator</a>
    </h1>
  

      </header>
        
    <footer class="article-footer">
      <a data-url="http://morris821028.github.io/2014/06/24/oj/uva/uva-198/" data-id="rhwlqzsuuesl2dgg" class="article-share-link">Share</a>
      
        <a href="http://morris821028.github.io/2014/06/24/oj/uva/uva-198/#disqus_thread" class="article-comment-link">Comments</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/五則運算/">五則運算</a></li></ul>

    </footer>
    <div class="article-entry article-index" itemprop="articleBody">
      
          
        
          <div class="toggle-content">
            <h2 id="Problem">Problem</h2>
<p>Unfortunately, Peter’s Calculator broke down last week. Now Peter is left with his computer, which has no calculator application, and paper and pencil, which is too tiresome for an engineer. As one of Peter’s friends, you are asked to write him a calculator application. After talking to him, you figure out the following:</p>
<ul>
<li>Peter does only integer arithmetic. The operations he needs are addition, subtraction and multiplication.</li>
<li>He would like to use an arbitrary number of variables whose names are not longer than 50 characters.</li>
<li>His main way of doing calculations are to type in a few formulas and to assign them to variables. Some formulas are complicated expressions, which can refer to yet undefined variables, while other formulas consist of a single number. Then Peter asks for the value of some variables, i.e. he evaluates the formulas.</li>
<li>Peters wants to redefine some variables and then to reevaluate formulas that depend on these variables.  </li>
</ul>
<p>The input strictly adheres to the following syntax (given in EBNF):</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">file = line <span class="tuple">{ line }</span> &lt;<span class="variable">EOF</span>&gt;.</div><div class="line">line = [ assignment | print | reset ] &lt;<span class="variable">CR</span>&gt;.</div><div class="line">assignment = var <span class="string">":="</span> expression.</div><div class="line">print = <span class="string">"PRINT"</span> var.</div><div class="line">reset = <span class="string">"RESET"</span>.</div><div class="line">expression = term <span class="tuple">{ addop term }</span>.</div><div class="line">term = factor <span class="tuple">{ mulop factor }</span>.</div><div class="line">factor = <span class="string">"("</span> expression <span class="string">")"</span> | var | number.</div><div class="line">addop = <span class="string">"+"</span> | <span class="string">"-"</span>.</div><div class="line">mulop = <span class="string">"*"</span>.</div></pre></td></tr></table></figure>

<p>In the Extended Backus-Naur Formalism (EBNF), A = B C declares that the grammatical construct A consists of a B followed by a C . A = B | C means that A consists of a B or, alternatively, of a C . A = [ B ] defines construct A to be either a B or nothing and A = B tells you that A consists of the concatenation of any number of B’s (including none).</p>
<p>The production var stands for the name of a variable, which starts with a letter followed by up to 49 letters or digits. Letters may be uppercase or lowercase. The production number stands for a integer number. The precise syntax for these productions are given below. The case of letters is important for both variables and statements.</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">var = letter { letter | digit }.</div><div class="line">number = [ <span class="string">"-"</span> ] digit { digit }.</div><div class="line">letter = <span class="string">"A"</span> | <span class="string">"B"</span> | <span class="keyword">...</span> | <span class="string">"Z"</span> | <span class="string">"a"</span> | <span class="string">"b"</span> | <span class="keyword">...</span> | <span class="string">"z"</span>.</div><div class="line">digit = <span class="string">"0"</span> | <span class="string">"1"</span> | <span class="keyword">...</span> | <span class="string">"8"</span> | <span class="string">"9"</span>.</div></pre></td></tr></table></figure>

<p>Between the parts of a grammatical construct but not within the names of variables or integer numbers, any number of spaces may appear. <eof> stands for the end of the input file and <cr> stands for the new-line character. All lines in the input file are shorter than 200 characters.</cr></eof></p>
<p>The value of a variable is said to be undefined:</p>
<ul>
<li>if it has not yet been defined or it refers to a variable, which has not yet been defined;</li>
<li>if the definition of the variable contains a cycle. </li>
</ul>
<p>Your are to write a program that implements Peter’s calculator. It should store all variable definitions and for each “PRINT” statement evaluate the specified variable based on the latest variable definitions. If your program encounters a “RESET” statement, it should delete all stored variables so that all variables become undefined.</p>
<h2 id="Input">Input</h2>
<p>The input file contains calculations adhering to the syntax given above. Each line contains either an assignment to a variable, a “PRINT” statement, a “RESET” statement or nothing.</p>
<h2 id="Output">Output</h2>
<p>For each “PRINT” statement found in the input file, your program should output a line containing the numerical value of the specified variable or the word “UNDEF” if the variable is undefined.</p>
<h2 id="Sample_Input">Sample Input</h2>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">a := b + c</div><div class="line">b := <span class="number">3</span></div><div class="line">c := <span class="number">5</span></div><div class="line"><span class="keyword">PRINT</span> d</div><div class="line"><span class="keyword">PRINT</span> a</div><div class="line">b := <span class="number">8</span></div><div class="line"><span class="keyword">PRINT</span> a</div><div class="line">RESET</div><div class="line"><span class="keyword">PRINT</span> a</div></pre></td></tr></table></figure>

<h2 id="Sample_Output">Sample Output</h2>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="title">UNDEF</span></div><div class="line"><span class="number">8</span></div><div class="line"><span class="number">13</span></div><div class="line">UNDEF</div></pre></td></tr></table></figure>

<h2 id="Solution">Solution</h2>
<p><strong> 題目描述： </strong></p>
<p>輸入有一連串的變數函數，適時地打印出詢問的變數值，如果存在循環依靠 (無法推論) 或者是變數尚未定義，直接輸出 UNDEF。</p>
<p>後輸入的變數函數會覆蓋原先的函數。</p>
<p><strong> 題目解法： </strong></p>
<p>將每一組函數轉成後序運算式子，爾後再使用深度優先搜索走訪查看是否有環。</p>
<p>著重的問題在於負數的分析，例如 <code>0 - -50</code>, <code>(a + b) - 50</code> 等等。</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div><div class="line">132</div><div class="line">133</div><div class="line">134</div><div class="line">135</div><div class="line">136</div><div class="line">137</div><div class="line">138</div><div class="line">139</div><div class="line">140</div><div class="line">141</div><div class="line">142</div><div class="line">143</div><div class="line">144</div><div class="line">145</div><div class="line">146</div><div class="line">147</div><div class="line">148</div><div class="line">149</div><div class="line">150</div><div class="line">151</div><div class="line">152</div><div class="line">153</div><div class="line">154</div><div class="line">155</div><div class="line">156</div><div class="line">157</div><div class="line">158</div><div class="line">159</div><div class="line">160</div></pre></td><td class="code"><pre><div class="line"><span class="preprocessor">#<span class="keyword">include</span> &lt;stdio.h&gt;</span></div><div class="line"><span class="preprocessor">#<span class="keyword">include</span> &lt;stack&gt;</span></div><div class="line"><span class="preprocessor">#<span class="keyword">include</span> &lt;string.h&gt;</span></div><div class="line"><span class="preprocessor">#<span class="keyword">include</span> &lt;algorithm&gt;</span></div><div class="line"><span class="preprocessor">#<span class="keyword">include</span> &lt;ctype.h&gt;</span></div><div class="line"><span class="preprocessor">#<span class="keyword">include</span> &lt;iostream&gt;</span></div><div class="line"><span class="preprocessor">#<span class="keyword">include</span> &lt;sstream&gt;</span></div><div class="line"><span class="preprocessor">#<span class="keyword">include</span> &lt;map&gt;</span></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"><span class="keyword">int</span> priority_op(<span class="keyword">char</span> c) {</div><div class="line">    <span class="keyword">switch</span>(c) {</div><div class="line">        <span class="keyword">case</span> <span class="string">'('</span>:<span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">        <span class="keyword">case</span> <span class="string">'+'</span>: <span class="keyword">case</span> <span class="string">'-'</span>:<span class="keyword">return</span> <span class="number">1</span>;</div><div class="line">        <span class="keyword">case</span> <span class="string">'*'</span>: <span class="keyword">case</span> <span class="string">'/'</span>:<span class="keyword">return</span> <span class="number">2</span>;</div><div class="line">    }</div><div class="line">    <span class="keyword">return</span> -<span class="number">1</span>;</div><div class="line">}</div><div class="line"><span class="keyword">int</span> isoperator(<span class="keyword">char</span> c) {</div><div class="line">    <span class="keyword">switch</span>(c) {</div><div class="line">        <span class="keyword">case</span> <span class="string">'('</span>:<span class="keyword">case</span> <span class="string">')'</span>:<span class="keyword">case</span> <span class="string">'+'</span>: <span class="keyword">case</span> <span class="string">'-'</span>:<span class="keyword">case</span> <span class="string">'*'</span>: <span class="keyword">case</span> <span class="string">'/'</span>:<span class="keyword">return</span> <span class="number">1</span>;</div><div class="line">    }</div><div class="line">    <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">}</div><div class="line"><span class="keyword">int</span> isvariable(<span class="built_in">string</span> token) {</div><div class="line">	<span class="keyword">return</span> <span class="built_in">isalpha</span>(token[<span class="number">0</span>]);</div><div class="line">}</div><div class="line"><span class="keyword">void</span> trans(<span class="keyword">const</span> <span class="keyword">char</span> *infix, <span class="keyword">char</span> buffer[]) {</div><div class="line">    <span class="keyword">int</span> len = <span class="built_in">strlen</span>(infix), prevOp = <span class="number">1</span>;</div><div class="line">    <span class="keyword">char</span> *ptr = buffer;</div><div class="line">    <span class="stl_container"><span class="built_in">stack</span>&lt;<span class="keyword">char</span>&gt;</span> op;</div><div class="line">    *ptr = <span class="string">'\0'</span>;</div><div class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; len; i++) {</div><div class="line">        <span class="keyword">if</span>(<span class="built_in">isalpha</span>(infix[i]) || <span class="built_in">isdigit</span>(infix[i]) </div><div class="line">			|| (infix[i] == <span class="string">'-'</span> &amp;&amp; <span class="built_in">isdigit</span>(infix[i+<span class="number">1</span>]) &amp;&amp; prevOp)) {</div><div class="line">			prevOp = <span class="number">0</span>;</div><div class="line">        	<span class="built_in">sprintf</span>(ptr, <span class="string">"%c"</span>, infix[i]), i++;</div><div class="line">        	<span class="keyword">while</span>(*ptr)    ptr++;</div><div class="line">			<span class="keyword">while</span>(<span class="built_in">isalpha</span>(infix[i]) || <span class="built_in">isdigit</span>(infix[i])) {</div><div class="line">            	<span class="built_in">sprintf</span>(ptr, <span class="string">"%c"</span>, infix[i]), i++;</div><div class="line">            	<span class="keyword">while</span>(*ptr)    ptr++;</div><div class="line">            }</div><div class="line">            <span class="built_in">sprintf</span>(ptr, <span class="string">" "</span>), i--;</div><div class="line">            <span class="keyword">while</span>(*ptr)		ptr++;</div><div class="line">        } <span class="keyword">else</span> {</div><div class="line">        	prevOp = <span class="number">0</span>;</div><div class="line">            <span class="keyword">if</span>(infix[i] == <span class="string">')'</span>) {</div><div class="line">                <span class="keyword">while</span>(!op.empty() &amp;&amp; op.top() != <span class="string">'('</span>) {</div><div class="line">                    <span class="built_in">sprintf</span>(ptr, <span class="string">"%c "</span>, op.top()), op.pop();</div><div class="line">                    <span class="keyword">while</span>(*ptr) ptr++;</div><div class="line">                }</div><div class="line">                op.pop();</div><div class="line">            } <span class="keyword">else</span> {</div><div class="line">                <span class="keyword">if</span>(infix[i] != <span class="string">'('</span>) {</div><div class="line">	                <span class="keyword">while</span>(!op.empty() &amp;&amp; priority_op(op.top()) &gt;= priority_op(infix[i])) {</div><div class="line">	                    <span class="built_in">sprintf</span>(ptr, <span class="string">"%c "</span>, op.top()), op.pop();</div><div class="line">	                    <span class="keyword">while</span>(*ptr) ptr++;</div><div class="line">	                }</div><div class="line">            	}</div><div class="line">	        	prevOp = <span class="number">1</span>;</div><div class="line">                op.push(infix[i]);</div><div class="line">            }</div><div class="line">        }</div><div class="line">    }</div><div class="line">    <span class="keyword">while</span>(!op.empty()) {</div><div class="line">        <span class="built_in">sprintf</span>(ptr, <span class="string">"%c "</span>, op.top()), op.pop();</div><div class="line">        <span class="keyword">while</span>(*ptr) ptr++;</div><div class="line">    }</div><div class="line">}</div><div class="line"><span class="keyword">void</span> trimWhiteSpace(<span class="keyword">char</span> s[]) {</div><div class="line">	<span class="keyword">int</span> j = <span class="number">0</span>;</div><div class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; s[i]; i++)</div><div class="line">		<span class="keyword">if</span>(!<span class="built_in">isspace</span>(s[i]))</div><div class="line">			s[j++] = s[i];</div><div class="line">	s[j] = <span class="string">'\0'</span>;</div><div class="line">}</div><div class="line"><span class="stl_container"><span class="built_in">map</span>&lt;<span class="built_in">string</span>, <span class="built_in">string</span>&gt;</span> VAL_exp;</div><div class="line"><span class="stl_container"><span class="built_in">map</span>&lt;<span class="built_in">string</span>, <span class="keyword">int</span>&gt;</span>	VAL_val;</div><div class="line"><span class="stl_container"><span class="built_in">map</span>&lt;<span class="built_in">string</span>, <span class="keyword">int</span>&gt;</span>	VAL_stk;</div><div class="line"><span class="keyword">int</span> error_FLAG;</div><div class="line"><span class="keyword">int</span> calcPostfix(<span class="keyword">const</span> <span class="keyword">char</span>* postfix);</div><div class="line"><span class="keyword">int</span> getValue(<span class="built_in">string</span> VAL_name) {</div><div class="line">    <span class="keyword">if</span>(!isvariable(VAL_name)) {</div><div class="line">    	<span class="built_in">stringstream</span> scin(VAL_name);</div><div class="line">    	<span class="keyword">int</span> value;</div><div class="line">    	scin &gt;&gt; value;</div><div class="line">    	<span class="keyword">return</span> value;</div><div class="line">    }</div><div class="line">	<span class="keyword">if</span>(VAL_exp.find(VAL_name) == VAL_exp.end() || VAL_stk[VAL_name]) {</div><div class="line">		error_FLAG = <span class="number">1</span>;</div><div class="line">		<span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">	}</div><div class="line">	<span class="keyword">if</span>(VAL_val.find(VAL_name) == VAL_val.end()) {</div><div class="line">		VAL_stk[VAL_name] = <span class="number">1</span>;</div><div class="line"><span class="comment">//		cout &lt;&lt; "solving " &lt;&lt; VAL_name &lt;&lt; ", " &lt;&lt; VAL_exp[VAL_name] &lt;&lt; endl; </span></div><div class="line">		VAL_val[VAL_name] = calcPostfix(VAL_exp[VAL_name].c_str());</div><div class="line"><span class="comment">//		cout &lt;&lt; "solved " &lt;&lt; VAL_name &lt;&lt; ", val = " &lt;&lt; VAL_val[VAL_name] &lt;&lt; endl;</span></div><div class="line">		VAL_stk[VAL_name] = <span class="number">0</span>;</div><div class="line">	}</div><div class="line">	<span class="keyword">return</span> VAL_val[VAL_name];</div><div class="line">}</div><div class="line"><span class="keyword">int</span> calcPostfix(<span class="keyword">const</span> <span class="keyword">char</span>* postfix) {</div><div class="line">	<span class="built_in">stringstream</span> 	scin(postfix);</div><div class="line">    <span class="stl_container"><span class="built_in">stack</span>&lt;<span class="keyword">int</span>&gt;</span> 		stk;</div><div class="line">	<span class="built_in">string</span>			token;</div><div class="line">    <span class="keyword">int</span> 			a, b;</div><div class="line">    </div><div class="line">    <span class="keyword">while</span>(scin &gt;&gt; token) {</div><div class="line">    	<span class="keyword">if</span>(token.length() == <span class="number">1</span> &amp;&amp; isoperator(token[<span class="number">0</span>])) {</div><div class="line">            b = stk.top(), stk.pop();</div><div class="line">            a = stk.top(), stk.pop();</div><div class="line">            <span class="keyword">switch</span>(token[<span class="number">0</span>]) {</div><div class="line">                <span class="keyword">case</span> <span class="string">'+'</span>: a = a+b;<span class="keyword">break</span>;</div><div class="line">                <span class="keyword">case</span> <span class="string">'-'</span>: a = a-b;<span class="keyword">break</span>;</div><div class="line">                <span class="keyword">case</span> <span class="string">'*'</span>: a = a*b;<span class="keyword">break</span>;</div><div class="line">                <span class="keyword">case</span> <span class="string">'/'</span>: a = a/b;<span class="keyword">break</span>;</div><div class="line">            }</div><div class="line">            stk.push(a);</div><div class="line">    	} <span class="keyword">else</span> {</div><div class="line">    		stk.push(getValue(token));</div><div class="line">    	}</div><div class="line">    	<span class="keyword">if</span>(error_FLAG)	<span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">    }</div><div class="line">    <span class="keyword">return</span> stk.top();</div><div class="line">}</div><div class="line"><span class="keyword">void</span> printVal(<span class="built_in">string</span> valName) {</div><div class="line">	error_FLAG = <span class="number">0</span>;</div><div class="line">	VAL_val.clear();</div><div class="line">	VAL_stk.clear();</div><div class="line">	<span class="keyword">int</span> val = getValue(valName);</div><div class="line">	<span class="keyword">if</span>(error_FLAG)</div><div class="line">		<span class="built_in">puts</span>(<span class="string">"UNDEF"</span>);</div><div class="line">	<span class="keyword">else</span></div><div class="line">		<span class="built_in">printf</span>(<span class="string">"%d\n"</span>, val);</div><div class="line">}</div><div class="line"><span class="keyword">int</span> main() {</div><div class="line"><span class="comment">//	freopen("input.txt", "r+t", stdin);</span></div><div class="line"><span class="comment">//	freopen("out.txt", "w+t", stdout); </span></div><div class="line">	<span class="built_in">string</span> 	LHS, RHS;</div><div class="line">	<span class="keyword">int</span> 	pos;</div><div class="line">	<span class="keyword">char</span> 	postfix[<span class="number">32767</span>], lines[<span class="number">32767</span>];</div><div class="line">	</div><div class="line">    <span class="keyword">while</span>(gets(lines)) {</div><div class="line">    	trimWhiteSpace(lines);</div><div class="line">    	<span class="built_in">string</span> str(lines);</div><div class="line">    	<span class="keyword">if</span>(str.find(<span class="string">":="</span>) != string::npos) {</div><div class="line">    		pos = str.find(<span class="string">":="</span>);</div><div class="line">    		LHS = str.substr(<span class="number">0</span>, pos);</div><div class="line">    		RHS = str.substr(pos + <span class="number">2</span>);</div><div class="line">    		trans(RHS.c_str(), postfix);</div><div class="line">    		VAL_exp[LHS] = postfix;</div><div class="line">    	} <span class="keyword">else</span> <span class="keyword">if</span>(str.find(<span class="string">"PRINT"</span>) != string::npos) {</div><div class="line">    		pos = str.find(<span class="string">"PRINT"</span>);</div><div class="line">    		RHS = str.substr(pos + <span class="number">5</span>);</div><div class="line">    		printVal(RHS);</div><div class="line">    	} <span class="keyword">else</span> <span class="keyword">if</span>(str.find(<span class="string">"RESET"</span>) != string::npos) {</div><div class="line">    		VAL_exp.clear();</div><div class="line">    	}</div><div class="line">    }</div><div class="line">    <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">}</div></pre></td></tr></table></figure>

          </div>
          <div class="toggle-input article-more-link"><a>Read More +</a></div>
        
      
    </div>

  </div>
  
</article>


  
    <article id="post-oj/uva/uva-11178" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2014/06/24/oj/uva/uva-11178/" class="article-date">
  <time datetime="2014-06-24T09:56:23.000Z" itemprop="datePublished">Jun 24 2014</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/解題區/">解題區</a>►<a class="article-category-link" href="/categories/解題區/解題區-UVa/">解題區 - UVa</a>
  </div>

  </div>
  <div class="article-inner ">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2014/06/24/oj/uva/uva-11178/">UVa 11178 - Morley&#39;s Theorem</a>
    </h1>
  

      </header>
        
    <footer class="article-footer">
      <a data-url="http://morris821028.github.io/2014/06/24/oj/uva/uva-11178/" data-id="2sunlxu90lrqan6o" class="article-share-link">Share</a>
      
        <a href="http://morris821028.github.io/2014/06/24/oj/uva/uva-11178/#disqus_thread" class="article-comment-link">Comments</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/幾何/">幾何</a></li></ul>

    </footer>
    <div class="article-entry article-index" itemprop="articleBody">
      
          
        
          <div class="toggle-content">
            <h2 id="Problem">Problem</h2>
<p>Morley’s theorem states that that the lines trisecting the angles of an arbitrary plane triangle meet at the vertices of an equilateral triangle. For example in the figure below the tri-sectors of angles A, B and C has intersected and created an equilateral triangle DEF. </p>
<p>Of course the theorem has various generalizations, in particular if all of the tri-sectors are intersected one obtains four other equilateral triangles. But in the original theorem only tri-sectors nearest to BC are allowed to intersect to get point D, tri-sectors nearest to CA are allowed to intersect point E and tri-sectors nearest to AB are intersected to get point F. Trisector like BD and CE are not allowed to intersect. So ultimately we get only one equilateral triangle DEF. Now your task is to find the Cartesian coordinates of D, E and F given the coordinates of A, B, and C.</p>
<h2 id="Input">Input</h2>
<p>First line of the input file contains an integer N (0&lt;N&lt;5001) which denotes the number of test cases to follow. Each of the next lines contain six integers . This six integers actually indicates that the Cartesian coordinates of point A, B and C are  respectively. You can assume that the area of triangle ABC is not equal to zero,  and the points A, B and C are in counter clockwise order.</p>
<h2 id="Output">Output</h2>
<p>For each line of input you should produce one line of output. This line contains six floating point numbers  separated by a single space. These six floating-point actually means that the Cartesian coordinates of D, E and F are  respectively. Errors less than   will be accepted.</p>
<h2 id="Sample_Input">Sample Input</h2>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">2</div><div class="line">1 1 2 2 1 2</div><div class="line">0 0 100 0 50 50</div></pre></td></tr></table></figure>

<h2 id="Output_for_Sample_Input">Output for Sample Input</h2>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">1.316987 1.816987 1.183013 1.683013 1.366025 1.633975</div><div class="line">56.698730 25.000000 43.301270 25.000000 50.000000 13.397460</div></pre></td></tr></table></figure>

<h2 id="Solution">Solution</h2>
<p><strong> 題目描述： </strong></p>
<p>給一個三角形，將每一個角三等分後，交三角形內部三個點，求這三個點座標。</p>
<p><strong> 題目解法： </strong></p>
<p>向量旋轉、射線交點。</p>
<p>射線交點的部分採用最簡單的克拉瑪方程求解。</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div></pre></td><td class="code"><pre><div class="line"><span class="preprocessor">#<span class="keyword">include</span> &lt;stdio.h&gt; </span></div><div class="line"><span class="preprocessor">#<span class="keyword">include</span> &lt;stdio.h&gt; </span></div><div class="line"><span class="preprocessor">#<span class="keyword">include</span> &lt;math.h&gt;</span></div><div class="line"><span class="preprocessor">#<span class="keyword">include</span> &lt;string.h&gt;</span></div><div class="line"><span class="preprocessor">#<span class="keyword">include</span> &lt;algorithm&gt;</span></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"><span class="preprocessor">#<span class="keyword">define</span> eps 1e-6</span></div><div class="line"><span class="keyword">struct</span> Pt {</div><div class="line">    <span class="keyword">double</span> x, y;</div><div class="line">    Pt(<span class="keyword">double</span> a = <span class="number">0</span>, <span class="keyword">double</span> b = <span class="number">0</span>):</div><div class="line">    	x(a), y(b) {}</div><div class="line">    <span class="keyword">bool</span> <span class="keyword">operator</span>&lt;(<span class="keyword">const</span> Pt &amp;a) <span class="keyword">const</span> {</div><div class="line">        <span class="keyword">if</span>(<span class="built_in">fabs</span>(x-a.x) &gt; eps)</div><div class="line">            <span class="keyword">return</span> x &lt; a.x;</div><div class="line">        <span class="keyword">return</span> y &lt; a.y;</div><div class="line">    }</div><div class="line">	Pt <span class="keyword">operator</span>-(<span class="keyword">const</span> Pt &amp;a) <span class="keyword">const</span> {</div><div class="line">		Pt ret;</div><div class="line">		ret.x = x - a.x;</div><div class="line">		ret.y = y - a.y;</div><div class="line">        <span class="keyword">return</span> ret;</div><div class="line">    }</div><div class="line">};</div><div class="line"><span class="keyword">double</span> dist(Pt a, Pt b) {</div><div class="line">	<span class="keyword">return</span> hypot(a.x - b.x, a.y - b.y);</div><div class="line">}</div><div class="line"><span class="keyword">double</span> length(Pt a) {</div><div class="line">	<span class="keyword">return</span> hypot(a.x, a.y);</div><div class="line">}</div><div class="line"><span class="keyword">double</span> dot(Pt a, Pt b) {</div><div class="line">	<span class="keyword">return</span> a.x * b.x + a.y * b.y;</div><div class="line">}</div><div class="line"><span class="keyword">double</span> cross2(Pt a, Pt b) {</div><div class="line">	<span class="keyword">return</span> a.x * b.y - a.y * b.x;</div><div class="line">}</div><div class="line"><span class="keyword">double</span> cross(Pt o, Pt a, Pt b) {</div><div class="line">    <span class="keyword">return</span> (a.x-o.x)*(b.y-o.y) - (a.y-o.y)*(b.x-o.x);</div><div class="line">}</div><div class="line"><span class="keyword">double</span> angle(Pt a, Pt b) {</div><div class="line">	<span class="keyword">return</span> <span class="built_in">acos</span>(dot(a, b) / length(a) / length(b));</div><div class="line">}</div><div class="line">Pt rotateRadian(Pt a, <span class="keyword">double</span> radian) {</div><div class="line">	<span class="keyword">double</span> x, y;</div><div class="line">	x = a.x * <span class="built_in">cos</span>(radian) - a.y * <span class="built_in">sin</span>(radian);</div><div class="line">	y = a.x * <span class="built_in">sin</span>(radian) + a.y * <span class="built_in">cos</span>(radian);</div><div class="line">	<span class="keyword">return</span> Pt(x, y);</div><div class="line">}</div><div class="line">Pt getIntersection(Pt p, Pt l1, Pt q, Pt l2) {</div><div class="line">	<span class="keyword">double</span> a1, a2, b1, b2, c1, c2;</div><div class="line">	<span class="keyword">double</span> dx, dy, d;</div><div class="line">	a1 = l1.y, b1 = -l1.x, c1 = a1 * p.x + b1 * p.y;</div><div class="line">	a2 = l2.y, b2 = -l2.x, c2 = a2 * q.x + b2 * q.y;</div><div class="line">	d = a1 * b2 - a2 * b1;</div><div class="line">	dx = b2 * c1 - b1 * c2;</div><div class="line">	dy = a1 * c2 - a2 * c1;</div><div class="line">	<span class="keyword">return</span> Pt(dx / d, dy / d);</div><div class="line">}</div><div class="line">Pt solve(Pt A, Pt B, Pt C) {</div><div class="line">	<span class="keyword">double</span> radABC = angle(A - B, C - B);</div><div class="line">	<span class="keyword">double</span> radACB = angle(A - C, B - C);</div><div class="line">	</div><div class="line">	Pt vB = rotateRadian(C - B, radABC /<span class="number">3</span>);</div><div class="line">	Pt vC = rotateRadian(B - C, - radACB /<span class="number">3</span>);</div><div class="line">	</div><div class="line">	<span class="keyword">return</span> getIntersection(B, vB, C, vC);</div><div class="line">}</div><div class="line"><span class="keyword">int</span> main() {</div><div class="line">	<span class="keyword">int</span> testcase;</div><div class="line">	<span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;testcase);</div><div class="line">	<span class="keyword">while</span>(testcase--) {</div><div class="line">		Pt A, B, C, D, E, F;</div><div class="line">		<span class="built_in">scanf</span>(<span class="string">"%lf %lf"</span>, &amp;A.x, &amp;A.y);</div><div class="line">		<span class="built_in">scanf</span>(<span class="string">"%lf %lf"</span>, &amp;B.x, &amp;B.y);</div><div class="line">		<span class="built_in">scanf</span>(<span class="string">"%lf %lf"</span>, &amp;C.x, &amp;C.y);</div><div class="line">		D = solve(A, B, C);</div><div class="line">		E = solve(B, C, A);</div><div class="line">		F = solve(C, A, B);</div><div class="line">		<span class="built_in">printf</span>(<span class="string">"%lf %lf %lf %lf %lf %lf\n"</span>, D.x, D.y, E.x, E.y, F.x, F.y);</div><div class="line">	}</div><div class="line">	<span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">}</div></pre></td></tr></table></figure>


          </div>
          <div class="toggle-input article-more-link"><a>Read More +</a></div>
        
      
    </div>

  </div>
  
</article>


  
    <article id="post-oj/uva/uva-427" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2014/06/24/oj/uva/uva-427/" class="article-date">
  <time datetime="2014-06-24T09:33:19.000Z" itemprop="datePublished">Jun 24 2014</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/解題區/">解題區</a>►<a class="article-category-link" href="/categories/解題區/解題區-UVa/">解題區 - UVa</a>
  </div>

  </div>
  <div class="article-inner ">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2014/06/24/oj/uva/uva-427/">UVa 427 - FlatLand Piano Movers</a>
    </h1>
  

      </header>
        
    <footer class="article-footer">
      <a data-url="http://morris821028.github.io/2014/06/24/oj/uva/uva-427/" data-id="22go00y9y6mp2t02" class="article-share-link">Share</a>
      
        <a href="http://morris821028.github.io/2014/06/24/oj/uva/uva-427/#disqus_thread" class="article-comment-link">Comments</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/三分/">三分</a></li></ul>

    </footer>
    <div class="article-entry article-index" itemprop="articleBody">
      
          
        
          <div class="toggle-content">
            <h2 id="Problem">Problem</h2>
<p>FlatLand Piano Movers, as part of their Total Quality Management project, has decided to focus on the job estimation process. Part of this process involves walking the proposed paths that are to be used to move a piano to see if it will fit through corridors and around corners. Now this is harder than it might seem, since FlatLand is a 2-dimensional world.</p>
<p>FlatLand pianos are rectangles of various sizes. FlatLand building codes require all turns in corridors to be right angle turns and prohibit <code>T</code> intersections. All dimensions are in furlongs. You can assume that each portion of a corridor is long enough so that other corners or doors into rooms don’t have any effect on getting around a turn. You can also assume that the piano is narrower than the width of any corridor. Note that the piano actually has to turn in the corner, since it can only be pushed or pulled on one of its shorter sides (there are no square pianos).</p>
<p>Your team’s job is to write a program for a palmtop computer that will determine if a given piano will fit around a corner in a corridor.</p>
<h2 id="Input">Input</h2>
<p>The input consists of a series of lines up to 80 columns in width followed by the end-of-file. Each line consists of a series of number pairs. The numbers of a pair are separated by a comma and the pairs are separated by at least one space. The first pair is the size of a piano, and the remaining pairs are the widths of corridors on each side of the turns. Consider the example:</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">600,200 300,500 837,500 350,350</div></pre></td></tr></table></figure>

<p>This is a 600 by 200 piano. The first turn is from a 300 furlong wide corridor through a right angle turn into a 500 furlong wide corridor. The next turn is from an 837 furlong wide corridor into one 500 furlongs wide. The last turn is from a 350 furlong wide corridor into another 350 furlong wide corridor.</p>
<h2 id="Output">Output</h2>
<p>For each piano, your program is to produce a yes-or-no answer for each turn. If the piano will fit around the turn, print <code>Y&#39;&#39;; if not, print</code>N’’. The results for each piano should be printed on a separate line.</p>
<h2 id="Sample_Input">Sample Input</h2>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">600,200   300,500   837,500  350,350 </div><div class="line">137,1200 600,500 600,400</div></pre></td></tr></table></figure>

<h2 id="Sample_Output">Sample Output</h2>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="title">YYN</span></div><div class="line">YN</div></pre></td></tr></table></figure>

<h2 id="Solution">Solution</h2>
<p><strong> 題目描述： </strong></p>
<p>一台鋼琴長寬 W, H，接著要經過一個 T 字路口，進去之後向右轉，一開始進去的寬度為 X，右轉之後的寬度為 Y，問能不能順利轉彎。</p>
<p>每組輸入給定一台鋼琴長寬，接著給定多組路口寬組合。</p>
<p><strong> 題目解法： </strong></p>
<blockquote>

<p><img class="lazy" data-original="/img/2011082521262354.jpg" alt="三分"></p>
<p>汽车拐弯问题，给定 X, Y, l, d 判断是否能够拐弯。首先当 X 或者 Y 小于 d，那么一定不能。<br>其次我们发现随着角度 θ 的增大，最大高度 h 先增长后减小，即为凸性函数，可以用三分法来求解。</p>
<p>这里的 Calc 函数需要比较繁琐的推倒公式：<br>s = l <em> cos(θ) + w </em> sin(θ) - x;<br>h = s <em> tan(θ) + w </em> cos(θ);<br>其中 s 为汽车最右边的点离拐角的水平距离, h 为里拐点最高的距离, θ 范围从 0 到 90。</p>
<footer><strong>轉貼備份</strong><cite><a href="http://www.cnblogs.com/newpanderking/archive/2011/08/25/2153777.html" target="_blank" rel="external">www.cnblogs.com/newpanderking/&hellip;</a></cite></footer></blockquote>


<p>看著大神給的三分搜索的式子，用簡單的凸性勾勒出來。</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div></pre></td><td class="code"><pre><div class="line"><span class="preprocessor">#<span class="keyword">include</span> &lt;stdio.h&gt; </span></div><div class="line"><span class="preprocessor">#<span class="keyword">include</span> &lt;math.h&gt;</span></div><div class="line"><span class="preprocessor">#<span class="keyword">include</span> &lt;string.h&gt;</span></div><div class="line"><span class="preprocessor">#<span class="keyword">include</span> &lt;iostream&gt;</span></div><div class="line"><span class="preprocessor">#<span class="keyword">include</span> &lt;sstream&gt;</span></div><div class="line"><span class="preprocessor">#<span class="keyword">include</span> &lt;algorithm&gt;</span></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"><span class="comment">// http://www.cnblogs.com/newpanderking/archive/2011/08/25/2153777.html</span></div><div class="line"><span class="keyword">const</span> <span class="keyword">double</span> pi = <span class="built_in">acos</span>(-<span class="number">1</span>);</div><div class="line"><span class="preprocessor">#<span class="keyword">define</span> eps 1e-6 </span></div><div class="line"><span class="keyword">double</span> ternary_search(<span class="keyword">double</span> H, <span class="keyword">double</span> W, <span class="keyword">double</span> X, <span class="keyword">double</span> Y) {</div><div class="line">	<span class="keyword">double</span> l = <span class="number">0</span>, r = pi /<span class="number">2</span>, mid, midmid;</div><div class="line">	<span class="keyword">double</span> s1, h1, s2, h2;</div><div class="line">	<span class="keyword">while</span>(<span class="built_in">fabs</span>(l - r) &gt; eps) {</div><div class="line">		mid = (l + r) /<span class="number">2</span>;</div><div class="line">		midmid = (mid + r) /<span class="number">2</span>;</div><div class="line">		s1 = H * <span class="built_in">cos</span>(mid) + W * <span class="built_in">sin</span>(mid) - X;</div><div class="line">		h1 = s1 * <span class="built_in">tan</span>(mid) + W * <span class="built_in">cos</span>(mid);</div><div class="line">		s2 = H * <span class="built_in">cos</span>(midmid) + W * <span class="built_in">sin</span>(midmid) - X;</div><div class="line">		h2 = s2 * <span class="built_in">tan</span>(midmid) + W * <span class="built_in">cos</span>(midmid);</div><div class="line">		<span class="keyword">if</span>(h1 &lt; h2)</div><div class="line">			l = mid;</div><div class="line">		<span class="keyword">else</span></div><div class="line">			r = mid;</div><div class="line">	}</div><div class="line">	<span class="keyword">return</span> h1;</div><div class="line">}</div><div class="line"><span class="keyword">int</span> main() {</div><div class="line">	<span class="keyword">char</span> line[<span class="number">1024</span>];</div><div class="line">	<span class="keyword">while</span>(gets(line)) {</div><div class="line">		<span class="built_in">stringstream</span> <span class="built_in">sin</span>(line);</div><div class="line">		<span class="built_in">string</span> token;</div><div class="line">		<span class="built_in">sin</span> &gt;&gt; token;</div><div class="line">		<span class="keyword">double</span> H, W, X, Y;</div><div class="line">		<span class="built_in">sscanf</span>(token.c_str(), <span class="string">"%lf,%lf"</span>, &amp;H, &amp;W);</div><div class="line">		<span class="keyword">if</span>(H &lt; W)</div><div class="line">			swap(H, W);</div><div class="line">		<span class="keyword">while</span>(<span class="built_in">sin</span> &gt;&gt; token) {</div><div class="line">			<span class="built_in">sscanf</span>(token.c_str(), <span class="string">"%lf,%lf"</span>, &amp;X, &amp;Y);</div><div class="line">			<span class="keyword">double</span> h = ternary_search(H, W, X, Y);</div><div class="line">			<span class="built_in">printf</span>(<span class="string">"%c"</span>, h &lt;= Y ? <span class="string">'Y'</span> : <span class="string">'N'</span>);</div><div class="line">		}</div><div class="line">		<span class="built_in">puts</span>(<span class="string">""</span>);</div><div class="line">	}</div><div class="line">	<span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">}</div></pre></td></tr></table></figure>
          </div>
          <div class="toggle-input article-more-link"><a>Read More +</a></div>
        
      
    </div>

  </div>
  
</article>


  
    <article id="post-oj/uva/uva-174" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2014/06/24/oj/uva/uva-174/" class="article-date">
  <time datetime="2014-06-24T09:17:39.000Z" itemprop="datePublished">Jun 24 2014</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/解題區/">解題區</a>►<a class="article-category-link" href="/categories/解題區/解題區-UVa/">解題區 - UVa</a>
  </div>

  </div>
  <div class="article-inner ">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2014/06/24/oj/uva/uva-174/">UVa 174 - Strategy</a>
    </h1>
  

      </header>
        
    <footer class="article-footer">
      <a data-url="http://morris821028.github.io/2014/06/24/oj/uva/uva-174/" data-id="55skeyay9sd3kute" class="article-share-link">Share</a>
      
        <a href="http://morris821028.github.io/2014/06/24/oj/uva/uva-174/#disqus_thread" class="article-comment-link">Comments</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/遞迴分析/">遞迴分析</a></li></ul>

    </footer>
    <div class="article-entry article-index" itemprop="articleBody">
      
          
        
          <div class="toggle-content">
            <h2 id="Problem">Problem</h2>
<p>A well known psychology experiment involves people playing a game in which they can either trade with each other or attempt to cheat the other player. If both players TRADE then each gains one point. If one TRADEs and the other CHEATs then the TRADEr loses 2 points and the CHEATer wins 2. If both CHEAT then each loses 1 point.</p>
<p>There are a variety of different strategies for playing this game, although most people are either unable to find a winning strategy, or, having decided on a strategy, do not stick to it. Thus it is fairer to attempt to evaluate these strategies by simulation on a computer. Each strategy is simulated by an automaton. An automaton is characterised by a program incorporating the strategy, a memory for previous encounters and a count reflecting the score of that automaton. The count starts at zero and is altered according to the above rules after each encounter. The memory is able to determine what happened on up to the last two encounters with each other contender.</p>
<p>Write a program that will read in details of up to 10 different strategies, play each strategy against each other strategy 10 times and then print out the final scores. Strategies will be in the form of simple programs obeying the following grammar:</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="title">program</span>&gt;</span> ::= <span class="tag">&lt;<span class="title">statement</span>&gt;</span>.</div><div class="line"><span class="tag">&lt;<span class="title">statement</span>&gt;</span> ::= <span class="tag">&lt;<span class="title">command</span>&gt;</span> tex2html_wrap_inline45 <span class="tag">&lt;<span class="title">ifstat</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="title">ifstat</span>&gt;</span> ::= IF <span class="tag">&lt;<span class="title">condition</span>&gt;</span> THEN <span class="tag">&lt;<span class="title">statement</span>&gt;</span> ELSE <span class="tag">&lt;<span class="title">statement</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="title">condition</span>&gt;</span> ::= <span class="tag">&lt;<span class="title">cond</span>&gt;</span> tex2html_wrap_inline45 <span class="tag">&lt;<span class="title">cond</span>&gt;</span> <span class="tag">&lt;<span class="title">op</span>&gt;</span> <span class="tag">&lt;<span class="title">condition</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="title">op</span>&gt;</span> ::= AND tex2html_wrap_inline45 OR</div><div class="line"><span class="tag">&lt;<span class="title">cond</span>&gt;</span> ::= <span class="tag">&lt;<span class="title">memory</span>&gt;</span> {= tex2html_wrap_inline45 #} {<span class="tag">&lt;<span class="title">command</span>&gt;</span> tex2html_wrap_inline45 NULL}</div><div class="line"><span class="tag">&lt;<span class="title">memory</span>&gt;</span> ::= {MY tex2html_wrap_inline45 YOUR} LAST {1 tex2html_wrap_inline45 2}</div><div class="line"><span class="tag">&lt;<span class="title">command</span>&gt;</span> ::= TRADE tex2html_wrap_inline45 CHEAT</div></pre></td></tr></table></figure>

<p>Note that LAST1 refers to the previous encounter between these two automata, LAST2 to the encounter before that and that <code>MY&#39; and</code>YOUR’ have the obvious meanings. Spaces and line breaks may appear anywhere in the program and are for legibility only. The symbol <code>#&#39; means</code>is not equal to’. NULL indicates that an encounter has not ocurred. The following are valid programs:</p>
<p>CHEAT.<br>IF MY LAST1 = CHEAT THEN TRADE ELSE CHEAT.<br>IFYOURLAST2=NULLTHENTRADEELSEIFYOURLAST1=TRADETHENTRADE<br>ELSECHEAT.</p>
<h2 id="Input">Input</h2>
<p>Input will consist of a series of programs. Each program will be no longer than 255 characters and may be split over several lines for convenience. There will be no more than 10 programs. The file will be terminated by a line containing only a single `#’.</p>
<h2 id="Output">Output</h2>
<p>Output will consist of one line for each line of input. Each line will consist of the final score of the relevant program right justified in a field of width 3.</p>
<h2 id="Sample_input">Sample input</h2>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">CHEAT.</div><div class="line">IF MY <span class="variable">LAST1 =</span> CHEAT THEN TRADE ELSE CHEAT.</div><div class="line"><span class="variable">IFYOURLAST2=</span><span class="variable">NULLTHENTRADEELSEIFYOURLAST1=</span>TRADETHENTRADE</div><div class="line">ELSECHEAT.</div><div class="line"><span class="comment">#</span></div></pre></td></tr></table></figure>

<h2 id="Sample_output">Sample output</h2>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">  1</div><div class="line">-<span class="ruby"><span class="number">12</span></span></div><div class="line">-<span class="ruby"><span class="number">13</span></span></div></pre></td></tr></table></figure>

<h2 id="Solution">Solution</h2>
<p><strong> 題目描述： </strong></p>
<p>現在這邊有兩台機器人，玩類似 “吹牛” 的紙牌遊戲，欺騙成功者將獲得點數。</p>
<p>而每一台機器的策略也有所不同，並且能根據對方前幾次和自己前幾次的策略進行判斷，給予每一台機器的策略模式，請兩兩互打 10 回合，最後輸出每一台機器的得分概況。</p>
<p><strong> 題目解法： </strong></p>
<p>這題不只有語法分析，還有語意分析。總之，遞迴分析是最主要的技巧。<br>對於 AND 和 OR 運算，測資中似乎沒有優先順序的情況，所以直接由左而右進行即可。</p>
<p>而在分析的時候，嘗試將指針一直往後移動，並且解析出第一個符合條件的 token。</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div><div class="line">132</div><div class="line">133</div><div class="line">134</div><div class="line">135</div><div class="line">136</div><div class="line">137</div><div class="line">138</div><div class="line">139</div><div class="line">140</div><div class="line">141</div><div class="line">142</div><div class="line">143</div><div class="line">144</div><div class="line">145</div><div class="line">146</div><div class="line">147</div><div class="line">148</div><div class="line">149</div><div class="line">150</div><div class="line">151</div><div class="line">152</div><div class="line">153</div><div class="line">154</div><div class="line">155</div><div class="line">156</div><div class="line">157</div><div class="line">158</div><div class="line">159</div><div class="line">160</div><div class="line">161</div><div class="line">162</div><div class="line">163</div><div class="line">164</div><div class="line">165</div><div class="line">166</div><div class="line">167</div><div class="line">168</div><div class="line">169</div><div class="line">170</div><div class="line">171</div><div class="line">172</div><div class="line">173</div><div class="line">174</div><div class="line">175</div><div class="line">176</div><div class="line">177</div><div class="line">178</div><div class="line">179</div><div class="line">180</div><div class="line">181</div></pre></td><td class="code"><pre><div class="line"><span class="preprocessor">#<span class="keyword">include</span> &lt;stdio.h&gt;</span></div><div class="line"><span class="preprocessor">#<span class="keyword">include</span> &lt;algorithm&gt;</span></div><div class="line"><span class="preprocessor">#<span class="keyword">include</span> &lt;vector&gt;</span></div><div class="line"><span class="preprocessor">#<span class="keyword">include</span> &lt;math.h&gt;</span></div><div class="line"><span class="preprocessor">#<span class="keyword">include</span> &lt;iostream&gt;</span></div><div class="line"><span class="preprocessor">#<span class="keyword">include</span> &lt;map&gt;</span></div><div class="line"><span class="preprocessor">#<span class="keyword">include</span> &lt;assert.h&gt;</span></div><div class="line"><span class="preprocessor">#<span class="keyword">include</span> &lt;string.h&gt;</span></div><div class="line"><span class="preprocessor">#<span class="keyword">include</span> &lt;ctype.h&gt;</span></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"><span class="keyword">enum</span> ACTION {TRADE, CHEAT, EMPTY};</div><div class="line"><span class="keyword">enum</span> RECORD {LAST1, LAST2};</div><div class="line"><span class="keyword">class</span> Memory {</div><div class="line"><span class="keyword">public</span>:</div><div class="line">    <span class="stl_container"><span class="built_in">map</span>&lt;RECORD, ACTION&gt;</span> R;</div><div class="line">    Memory() {</div><div class="line">        R[LAST1] = EMPTY;</div><div class="line">        R[LAST2] = EMPTY;</div><div class="line">    }</div><div class="line">    <span class="keyword">static</span> ACTION getAction(<span class="built_in">string</span> s) {</div><div class="line">        <span class="keyword">if</span>(s == <span class="string">"TRADE"</span>)    <span class="keyword">return</span> TRADE;</div><div class="line">        <span class="keyword">if</span>(s == <span class="string">"CHEAT"</span>)    <span class="keyword">return</span> CHEAT;</div><div class="line">        <span class="keyword">if</span>(s == <span class="string">"EMPTY"</span>)    <span class="keyword">return</span> EMPTY;</div><div class="line">        assert(<span class="keyword">false</span>);</div><div class="line">    }</div><div class="line">    ACTION getMemory(<span class="built_in">string</span> addr) {</div><div class="line">        <span class="keyword">if</span> (addr == <span class="string">"LAST1"</span>)</div><div class="line">            <span class="keyword">return</span> R[LAST1];</div><div class="line">        <span class="keyword">if</span> (addr == <span class="string">"LAST2"</span>)</div><div class="line">            <span class="keyword">return</span> R[LAST2];</div><div class="line">        assert(<span class="keyword">false</span>);</div><div class="line">    }</div><div class="line">    <span class="keyword">void</span> record(ACTION a) {</div><div class="line">        ACTION last1 = R[LAST1], last2 = R[LAST2];</div><div class="line">        R[LAST1] = a;</div><div class="line">        R[LAST2] = last1;</div><div class="line">    }</div><div class="line">};</div><div class="line"><span class="keyword">class</span> Strategy {</div><div class="line"><span class="keyword">public</span>:</div><div class="line">    <span class="keyword">char</span> prog[<span class="number">1024</span>];</div><div class="line">    Strategy(<span class="built_in">string</span> s) {</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; s.length(); i++) {</div><div class="line">            prog[i] = s[i];</div><div class="line">        }</div><div class="line">        prog[s.length()] = <span class="string">'\0'</span>;</div><div class="line">    }</div><div class="line">    <span class="keyword">char</span>* match(<span class="keyword">char</span> *str, <span class="keyword">const</span> <span class="keyword">char</span> *p) {</div><div class="line">        <span class="keyword">if</span> (str == NULL)</div><div class="line">            <span class="keyword">return</span>  NULL;</div><div class="line">        <span class="keyword">if</span> (<span class="built_in">memcmp</span>(str, p, <span class="built_in">strlen</span>(p)) == <span class="number">0</span>)</div><div class="line">            <span class="keyword">return</span> str + <span class="built_in">strlen</span>(p);</div><div class="line">        <span class="keyword">return</span> NULL;</div><div class="line">    }</div><div class="line"><span class="comment">/*</span></div><div class="line"> &lt;condition&gt; ::= &lt;cond&gt; | &lt;cond&gt; &lt;op&gt; &lt;condition&gt;</div><div class="line"> &lt;op&gt; ::= AND | OR</div><div class="line"> &lt;cond&gt; ::= &lt;memory&gt; {= | #} {&lt;command&gt; | NULL}</div><div class="line"> &lt;memory&gt; ::= {MY | YOUR} LAST {1 | 2}</div><div class="line"> &lt;command&gt; ::= TRADE | CHEAT</div><div class="line"> */</div><div class="line">    <span class="keyword">bool</span> cond(<span class="keyword">char</span>* &amp;p, Memory MY, Memory YOUR) {</div><div class="line">        <span class="comment">// printf("condition %s\n", p);</span></div><div class="line">        <span class="keyword">char</span>        *q;</div><div class="line">        Memory      *addr = NULL;</div><div class="line">        <span class="built_in">string</span>      read, equal, kind;</div><div class="line">        <span class="comment">/* &lt;memory&gt; */</span></div><div class="line">        q = match(p, <span class="string">"MY"</span>);</div><div class="line">        <span class="keyword">if</span>(q != NULL)   p = q, addr = &amp;MY;</div><div class="line">        q = match(p, <span class="string">"YOUR"</span>);</div><div class="line">        <span class="keyword">if</span>(q != NULL)   p = q, addr = &amp;YOUR;</div><div class="line">        q = match(p, <span class="string">"LAST1"</span>);</div><div class="line">        <span class="keyword">if</span>(q != NULL)   p = q, read = <span class="string">"LAST1"</span>;</div><div class="line">        q = match(p, <span class="string">"LAST2"</span>);</div><div class="line">        <span class="keyword">if</span>(q != NULL)   p = q, read = <span class="string">"LAST2"</span>;</div><div class="line">        <span class="comment">/* {= | #} */</span></div><div class="line">        q = match(p, <span class="string">"="</span>);</div><div class="line">        <span class="keyword">if</span>(q != NULL)   p = q, equal = <span class="string">"="</span>;</div><div class="line">        q = match(p, <span class="string">"#"</span>);</div><div class="line">        <span class="keyword">if</span>(q != NULL)   p = q, equal = <span class="string">"#"</span>;</div><div class="line">        <span class="comment">/* {&lt;command&gt; | NULL} */</span></div><div class="line">        q = match(p, <span class="string">"TRADE"</span>);</div><div class="line">        <span class="keyword">if</span>(q != NULL)  p = q, kind = <span class="string">"TRADE"</span>;</div><div class="line">        q = match(p, <span class="string">"CHEAT"</span>);</div><div class="line">        <span class="keyword">if</span>(q != NULL)  p = q, kind = <span class="string">"CHEAT"</span>;</div><div class="line">        q = match(p, <span class="string">"NULL"</span>);</div><div class="line">        <span class="keyword">if</span>(q != NULL)  p = q, kind = <span class="string">"EMPTY"</span>;</div><div class="line">        <span class="keyword">bool</span> ret = equal == <span class="string">"="</span> ? addr-&gt;getMemory(read) == Memory::getAction(kind) :</div><div class="line">									addr-&gt;getMemory(read) != Memory::getAction(kind);</div><div class="line">        <span class="comment">// cout &lt;&lt; "ADDR: " &lt;&lt; addr-&gt;getMemory(read) &lt;&lt; ", ACTION: " &lt;&lt; Memory::getAction(kind) &lt;&lt; endl;</span></div><div class="line">        <span class="comment">// cout &lt;&lt; read &lt;&lt; ", " &lt;&lt; kind &lt;&lt; endl; </span></div><div class="line">        <span class="comment">/* &lt;op&gt; &lt;condition&gt; */</span></div><div class="line">        q = match(p, <span class="string">"AND"</span>);</div><div class="line">        <span class="keyword">if</span>(q != NULL)  p = q, ret = ret&amp;cond(p, MY, YOUR);</div><div class="line">        q = match(p, <span class="string">"OR"</span>);</div><div class="line">        <span class="keyword">if</span>(q != NULL)  p = q, ret = ret|cond(p, MY, YOUR);</div><div class="line">        <span class="comment">// cout &lt;&lt; "return " &lt;&lt; ret &lt;&lt; endl;</span></div><div class="line">        <span class="keyword">return</span> ret;</div><div class="line">    }</div><div class="line">    ACTION ifstat(<span class="keyword">char</span>* &amp;p, Memory a, Memory b) {</div><div class="line">        <span class="keyword">char</span> *q;</div><div class="line">        q = match(p, <span class="string">"IF"</span>);</div><div class="line">        <span class="keyword">if</span> (q != NULL) {</div><div class="line">            p = q;</div><div class="line">            <span class="keyword">bool</span> f = cond(p, a, b);</div><div class="line">            ACTION a1, a2;</div><div class="line">            q = match(p, <span class="string">"THEN"</span>);</div><div class="line">            p = q;</div><div class="line">            a1 = statement(p, a, b);</div><div class="line">            q = match(p, <span class="string">"ELSE"</span>);</div><div class="line">        	p = q;</div><div class="line">        	a2 = statement(p, a, b);</div><div class="line">        	<span class="keyword">return</span> f ? a1 : a2;</div><div class="line">        }</div><div class="line">        assert(<span class="keyword">false</span>);</div><div class="line">    }</div><div class="line">    ACTION statement(<span class="keyword">char</span>* &amp;p, Memory a, Memory b) {</div><div class="line">        <span class="comment">// printf("%s\n", p);</span></div><div class="line">        <span class="keyword">char</span> *q;</div><div class="line">        q = match(p, <span class="string">"TRADE"</span>);</div><div class="line">        <span class="keyword">if</span> (q != NULL)  {</div><div class="line">            p = q;</div><div class="line">            <span class="keyword">return</span> TRADE;</div><div class="line">        }</div><div class="line">        q = match(p, <span class="string">"CHEAT"</span>);</div><div class="line">        <span class="keyword">if</span> (q != NULL) {</div><div class="line">            p = q;</div><div class="line">            <span class="keyword">return</span> CHEAT;</div><div class="line">        }</div><div class="line">        <span class="keyword">return</span> ifstat(p, a, b);</div><div class="line">    }</div><div class="line">    ACTION eval(<span class="keyword">char</span>* &amp;p, Memory a, Memory b) { <span class="comment">// read only</span></div><div class="line">        <span class="comment">// printf("eval %s\n", p);</span></div><div class="line">        <span class="keyword">return</span> statement(p, a, b);</div><div class="line">    }</div><div class="line">};</div><div class="line"><span class="keyword">int</span> main() {</div><div class="line">    <span class="keyword">char</span> c, s[<span class="number">1024</span>];</div><div class="line">    <span class="stl_container"><span class="built_in">vector</span>&lt;Strategy&gt;</span> machine;</div><div class="line">    <span class="keyword">while</span> (<span class="keyword">true</span>) {</div><div class="line">        <span class="keyword">int</span> n = <span class="number">0</span>;</div><div class="line">        <span class="keyword">while</span> ((c = getchar()) != EOF) {</div><div class="line">            <span class="keyword">if</span>(c == <span class="string">'.'</span> || (c == <span class="string">'#'</span> &amp;&amp; n == <span class="number">0</span>) )</div><div class="line">                <span class="keyword">break</span>;</div><div class="line">            <span class="keyword">if</span>(<span class="built_in">isspace</span>(c))</div><div class="line">                <span class="keyword">continue</span>;</div><div class="line">            s[n++] = c;</div><div class="line">        }</div><div class="line">        <span class="keyword">if</span> (n == <span class="number">0</span>)</div><div class="line">            <span class="keyword">break</span>;</div><div class="line">        s[n++] = <span class="string">'\0'</span>;</div><div class="line">        machine.push_back(Strategy(s));</div><div class="line">    }</div><div class="line"><span class="preprocessor">#<span class="keyword">define</span> MAXN 20</span></div><div class="line">    <span class="keyword">int</span> SCORE[MAXN] = {};</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; machine.size(); i++) {</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = i + <span class="number">1</span>; j &lt; machine.size(); j++) {</div><div class="line">            Memory      ma, mb;</div><div class="line">            Strategy    &amp;A = machine[i];</div><div class="line">            Strategy    &amp;B = machine[j];</div><div class="line">            <span class="keyword">char</span>        *p;</div><div class="line">            </div><div class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> k = <span class="number">0</span>; k &lt; <span class="number">10</span>; k++) {</div><div class="line">                ACTION ia = A.eval(p = A.prog, ma, mb);</div><div class="line">                ACTION ib = B.eval(p = B.prog, mb, ma);</div><div class="line">                <span class="keyword">if</span>(ia == TRADE &amp;&amp; ib == TRADE)</div><div class="line">                	SCORE[i]++, SCORE[j]++;</div><div class="line">                <span class="keyword">else</span> <span class="keyword">if</span>(ia == TRADE &amp;&amp; ib == CHEAT)</div><div class="line">                	SCORE[i] -= <span class="number">2</span>, SCORE[j] += <span class="number">2</span>;</div><div class="line">                <span class="keyword">else</span> <span class="keyword">if</span>(ia == CHEAT &amp;&amp; ib == TRADE)</div><div class="line">                	SCORE[i] += <span class="number">2</span>, SCORE[j] -= <span class="number">2</span>;</div><div class="line">                <span class="keyword">else</span></div><div class="line">                	SCORE[i]--, SCORE[j]--;</div><div class="line">                ma.record(ia), mb.record(ib);</div><div class="line">            }</div><div class="line">        }</div><div class="line">    }</div><div class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; machine.size(); i++)</div><div class="line">    	<span class="built_in">printf</span>(<span class="string">"%3d\n"</span>, SCORE[i]);</div><div class="line">    <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">}</div></pre></td></tr></table></figure>
          </div>
          <div class="toggle-input article-more-link"><a>Read More +</a></div>
        
      
    </div>

  </div>
  
</article>


  
    <article id="post-oj/uva/uva-171" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2014/06/24/oj/uva/uva-171/" class="article-date">
  <time datetime="2014-06-24T09:08:12.000Z" itemprop="datePublished">Jun 24 2014</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/解題區/">解題區</a>►<a class="article-category-link" href="/categories/解題區/解題區-UVa/">解題區 - UVa</a>
  </div>

  </div>
  <div class="article-inner ">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2014/06/24/oj/uva/uva-171/">UVa 171 - Car Trialling</a>
    </h1>
  

      </header>
        
    <footer class="article-footer">
      <a data-url="http://morris821028.github.io/2014/06/24/oj/uva/uva-171/" data-id="90c8trj6ub5ivqdy" class="article-share-link">Share</a>
      
        <a href="http://morris821028.github.io/2014/06/24/oj/uva/uva-171/#disqus_thread" class="article-comment-link">Comments</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/SLR/">SLR</a></li></ul>

    </footer>
    <div class="article-entry article-index" itemprop="articleBody">
      
          
        
          <div class="toggle-content">
            <h2 id="Problem">Problem</h2>
<p>Car trialling requires the following of carefully worded instructions. When setting a trial, the organiser places traps in the instructions to catch out the unwary.</p>
<p>Write a program to determine whether an instruction obeys the following rules, which are loosely based on real car trialling instructions. <strong> BOLD-TEXT </strong> indicates text as it appears in the instruction (case sensitive), <code>|</code> separates options of which exactly one must be chosen, and .. expands, so A..D is equivalent to A | B | C | D .</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div></pre></td><td class="code"><pre><div class="line"><span class="variable">instruction =</span> navigational | time-keeping | navigational AND time-keeping</div><div class="line"></div><div class="line"><span class="variable">navigational =</span> directional | navigational AND THEN directional</div><div class="line"></div><div class="line"><span class="variable">directional =</span> how direction | how direction where</div><div class="line"></div><div class="line"><span class="variable">how =</span> GO | GO when | KEEP</div><div class="line"></div><div class="line"><span class="variable">direction =</span> RIGHT | LEFT</div><div class="line"></div><div class="line"><span class="variable">when =</span> FIRST | SECOND | THIRD</div><div class="line"></div><div class="line"><span class="variable">where =</span> AT sign</div><div class="line"></div><div class="line"><span class="variable">sign =</span> <span class="string">"signwords"</span></div><div class="line"></div><div class="line"><span class="variable">signwords =</span> s-word | signwords s-word</div><div class="line"></div><div class="line"><span class="variable">s-word =</span> letter | s-word letter</div><div class="line"></div><div class="line"><span class="variable">letter =</span> A..Z | .</div><div class="line"></div><div class="line"><span class="variable">time-keeping =</span> record tex2html_wrap_inline61 change</div><div class="line"></div><div class="line"><span class="variable">record =</span> RECORD TIME</div><div class="line"></div><div class="line"><span class="variable">change =</span> cas TO nnn KMH</div><div class="line"></div><div class="line"><span class="variable">cas =</span> CHANGE AVERAGE SPEED | CAS</div><div class="line"></div><div class="line"><span class="variable">nnn =</span> digit | nnn digit</div></pre></td></tr></table></figure>

<p>digit = 0..9 Note that s-word and nnn are sequences of letters and digits respectively, with no intervening spaces. There will be one or more spaces between items except before a period (.), after the opening speech marks or before the closing speech marks.</p>
<h2 id="Input">Input</h2>
<p>Each input line will consist of not more than 75 characters. The input will be terminated by a line consisting of a single #.</p>
<h2 id="Output">Output</h2>
<p>The output will consist of a series of sequentially numbered lines, either containing the valid instruction, or the text Trap! if the line did not obey the rules. The line number will be right justified in a field of 3 characters, followed by a full-stop, a single space, and the instruction, with sequences of more than one space reduced to single spaces.</p>
<h2 id="Sample_input">Sample input</h2>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">KEEP <span class="attribute">LEFT</span> AND THEN GO <span class="attribute">RIGHT</span></div><div class="line">CAS TO 20 KMH</div><div class="line">GO FIRST       <span class="attribute">RIGHT</span> AT "SMITH ST."  AND   CAS TO 20 KMH</div><div class="line">GO 2nd <span class="attribute">RIGHT</span></div><div class="line">GO <span class="attribute">LEFT</span> AT "SMITH STREET AND RECORD <span class="tag">TIME</span></div><div class="line">KEEP <span class="attribute">RIGHT</span> AND THEN RECORD <span class="tag">TIME</span></div><div class="line">#</div></pre></td></tr></table></figure>

<h2 id="Sample_output">Sample output</h2>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="number">1.</span> KEEP <span class="keyword">LEFT</span> <span class="keyword">AND</span> <span class="keyword">THEN</span> GO <span class="keyword">RIGHT</span></div><div class="line"><span class="number">2.</span> CAS <span class="keyword">TO</span> <span class="number">20</span> KMH</div><div class="line"><span class="number">3.</span> GO FIRST <span class="keyword">RIGHT</span> AT <span class="string">"SMITH ST."</span> <span class="keyword">AND</span> CAS <span class="keyword">TO</span> <span class="number">20</span> KMH</div><div class="line"><span class="number">4.</span> Trap!</div><div class="line"><span class="number">5.</span> Trap!</div><div class="line"><span class="number">6.</span> Trap!</div></pre></td></tr></table></figure>

<h2 id="Solution">Solution</h2>
<p><strong> 題目描述： </strong></p>
<p>根據題目給定的規則，將汽車引領的命令句子做合法語句判斷。</p>
<p><strong> 題目解法： </strong></p>
<p>根據編譯器的方式，採用 LL(1) 修改題目給定的規則後，要進行建表，但是發現有幾處無法排除的語法規則，之後採用 SLR(1) 來完成。</p>
<p>SLR(1) 是由 LR(0) 加上 follow set 完成。</p>
<p>詳細的運作過程請詳見 wiki 說明，或者是修編譯器。</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">There will be <span class="constant">one</span> <span class="operator">or</span> more spaces between <span class="keyword">items</span> except <span class="keyword">before</span> <span class="operator">a</span> period (.), <span class="keyword">after</span> <span class="operator">the</span> opening speech marks <span class="operator">or</span> <span class="keyword">before</span> <span class="operator">the</span> closing speech marks.</div></pre></td></tr></table></figure>

<p>本題最邪惡的地方在這裡，句號（.）前不可以用空白，前雙引號後不可有空白、後雙引號前不可以有空白。</p>
<p>雖然題目有包含這些 token 的語法產生，但還是用最暴力的方式將句子做基礎的 token 切割。</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div><div class="line">132</div><div class="line">133</div><div class="line">134</div><div class="line">135</div><div class="line">136</div><div class="line">137</div><div class="line">138</div><div class="line">139</div><div class="line">140</div><div class="line">141</div><div class="line">142</div><div class="line">143</div><div class="line">144</div><div class="line">145</div><div class="line">146</div><div class="line">147</div><div class="line">148</div><div class="line">149</div><div class="line">150</div><div class="line">151</div><div class="line">152</div><div class="line">153</div><div class="line">154</div><div class="line">155</div><div class="line">156</div><div class="line">157</div><div class="line">158</div><div class="line">159</div><div class="line">160</div><div class="line">161</div><div class="line">162</div><div class="line">163</div><div class="line">164</div><div class="line">165</div><div class="line">166</div><div class="line">167</div><div class="line">168</div><div class="line">169</div><div class="line">170</div><div class="line">171</div><div class="line">172</div><div class="line">173</div><div class="line">174</div><div class="line">175</div><div class="line">176</div><div class="line">177</div><div class="line">178</div><div class="line">179</div><div class="line">180</div><div class="line">181</div><div class="line">182</div><div class="line">183</div><div class="line">184</div><div class="line">185</div><div class="line">186</div><div class="line">187</div><div class="line">188</div><div class="line">189</div><div class="line">190</div><div class="line">191</div><div class="line">192</div><div class="line">193</div><div class="line">194</div><div class="line">195</div><div class="line">196</div><div class="line">197</div><div class="line">198</div><div class="line">199</div><div class="line">200</div><div class="line">201</div><div class="line">202</div><div class="line">203</div><div class="line">204</div><div class="line">205</div><div class="line">206</div><div class="line">207</div><div class="line">208</div><div class="line">209</div><div class="line">210</div><div class="line">211</div><div class="line">212</div><div class="line">213</div><div class="line">214</div><div class="line">215</div><div class="line">216</div><div class="line">217</div><div class="line">218</div><div class="line">219</div><div class="line">220</div><div class="line">221</div><div class="line">222</div><div class="line">223</div><div class="line">224</div><div class="line">225</div><div class="line">226</div><div class="line">227</div><div class="line">228</div><div class="line">229</div><div class="line">230</div><div class="line">231</div><div class="line">232</div><div class="line">233</div><div class="line">234</div><div class="line">235</div><div class="line">236</div><div class="line">237</div><div class="line">238</div><div class="line">239</div><div class="line">240</div><div class="line">241</div><div class="line">242</div><div class="line">243</div><div class="line">244</div><div class="line">245</div><div class="line">246</div><div class="line">247</div><div class="line">248</div><div class="line">249</div><div class="line">250</div><div class="line">251</div><div class="line">252</div><div class="line">253</div><div class="line">254</div><div class="line">255</div><div class="line">256</div><div class="line">257</div><div class="line">258</div><div class="line">259</div><div class="line">260</div><div class="line">261</div><div class="line">262</div><div class="line">263</div><div class="line">264</div><div class="line">265</div><div class="line">266</div><div class="line">267</div><div class="line">268</div><div class="line">269</div><div class="line">270</div><div class="line">271</div><div class="line">272</div><div class="line">273</div><div class="line">274</div><div class="line">275</div><div class="line">276</div><div class="line">277</div><div class="line">278</div><div class="line">279</div><div class="line">280</div><div class="line">281</div><div class="line">282</div><div class="line">283</div><div class="line">284</div><div class="line">285</div><div class="line">286</div><div class="line">287</div><div class="line">288</div><div class="line">289</div><div class="line">290</div><div class="line">291</div><div class="line">292</div><div class="line">293</div><div class="line">294</div><div class="line">295</div><div class="line">296</div><div class="line">297</div><div class="line">298</div><div class="line">299</div><div class="line">300</div><div class="line">301</div><div class="line">302</div><div class="line">303</div><div class="line">304</div><div class="line">305</div><div class="line">306</div><div class="line">307</div><div class="line">308</div><div class="line">309</div><div class="line">310</div><div class="line">311</div><div class="line">312</div><div class="line">313</div><div class="line">314</div><div class="line">315</div><div class="line">316</div><div class="line">317</div><div class="line">318</div><div class="line">319</div><div class="line">320</div><div class="line">321</div><div class="line">322</div><div class="line">323</div><div class="line">324</div><div class="line">325</div><div class="line">326</div><div class="line">327</div><div class="line">328</div><div class="line">329</div><div class="line">330</div><div class="line">331</div><div class="line">332</div><div class="line">333</div><div class="line">334</div><div class="line">335</div><div class="line">336</div><div class="line">337</div><div class="line">338</div><div class="line">339</div><div class="line">340</div><div class="line">341</div><div class="line">342</div><div class="line">343</div><div class="line">344</div><div class="line">345</div><div class="line">346</div><div class="line">347</div><div class="line">348</div><div class="line">349</div><div class="line">350</div><div class="line">351</div><div class="line">352</div><div class="line">353</div><div class="line">354</div><div class="line">355</div><div class="line">356</div><div class="line">357</div><div class="line">358</div><div class="line">359</div><div class="line">360</div><div class="line">361</div><div class="line">362</div><div class="line">363</div><div class="line">364</div><div class="line">365</div><div class="line">366</div><div class="line">367</div><div class="line">368</div><div class="line">369</div><div class="line">370</div><div class="line">371</div><div class="line">372</div><div class="line">373</div><div class="line">374</div><div class="line">375</div><div class="line">376</div><div class="line">377</div><div class="line">378</div><div class="line">379</div><div class="line">380</div><div class="line">381</div><div class="line">382</div><div class="line">383</div><div class="line">384</div><div class="line">385</div><div class="line">386</div><div class="line">387</div><div class="line">388</div><div class="line">389</div><div class="line">390</div><div class="line">391</div><div class="line">392</div><div class="line">393</div><div class="line">394</div><div class="line">395</div><div class="line">396</div><div class="line">397</div><div class="line">398</div><div class="line">399</div><div class="line">400</div><div class="line">401</div><div class="line">402</div><div class="line">403</div><div class="line">404</div><div class="line">405</div><div class="line">406</div><div class="line">407</div><div class="line">408</div><div class="line">409</div><div class="line">410</div><div class="line">411</div><div class="line">412</div><div class="line">413</div><div class="line">414</div><div class="line">415</div><div class="line">416</div><div class="line">417</div><div class="line">418</div><div class="line">419</div><div class="line">420</div><div class="line">421</div><div class="line">422</div><div class="line">423</div><div class="line">424</div><div class="line">425</div><div class="line">426</div><div class="line">427</div><div class="line">428</div><div class="line">429</div><div class="line">430</div><div class="line">431</div><div class="line">432</div><div class="line">433</div><div class="line">434</div><div class="line">435</div><div class="line">436</div><div class="line">437</div><div class="line">438</div><div class="line">439</div><div class="line">440</div><div class="line">441</div><div class="line">442</div><div class="line">443</div><div class="line">444</div><div class="line">445</div><div class="line">446</div><div class="line">447</div><div class="line">448</div><div class="line">449</div><div class="line">450</div><div class="line">451</div><div class="line">452</div><div class="line">453</div><div class="line">454</div><div class="line">455</div><div class="line">456</div><div class="line">457</div><div class="line">458</div><div class="line">459</div><div class="line">460</div><div class="line">461</div><div class="line">462</div><div class="line">463</div><div class="line">464</div><div class="line">465</div><div class="line">466</div><div class="line">467</div><div class="line">468</div><div class="line">469</div><div class="line">470</div><div class="line">471</div><div class="line">472</div><div class="line">473</div><div class="line">474</div><div class="line">475</div><div class="line">476</div><div class="line">477</div><div class="line">478</div><div class="line">479</div><div class="line">480</div><div class="line">481</div><div class="line">482</div><div class="line">483</div><div class="line">484</div><div class="line">485</div><div class="line">486</div><div class="line">487</div><div class="line">488</div><div class="line">489</div><div class="line">490</div><div class="line">491</div><div class="line">492</div><div class="line">493</div><div class="line">494</div><div class="line">495</div><div class="line">496</div><div class="line">497</div><div class="line">498</div><div class="line">499</div><div class="line">500</div><div class="line">501</div><div class="line">502</div><div class="line">503</div><div class="line">504</div><div class="line">505</div><div class="line">506</div><div class="line">507</div><div class="line">508</div><div class="line">509</div><div class="line">510</div><div class="line">511</div><div class="line">512</div><div class="line">513</div><div class="line">514</div><div class="line">515</div><div class="line">516</div><div class="line">517</div><div class="line">518</div><div class="line">519</div><div class="line">520</div><div class="line">521</div><div class="line">522</div><div class="line">523</div><div class="line">524</div><div class="line">525</div><div class="line">526</div><div class="line">527</div><div class="line">528</div><div class="line">529</div><div class="line">530</div><div class="line">531</div><div class="line">532</div><div class="line">533</div><div class="line">534</div><div class="line">535</div><div class="line">536</div><div class="line">537</div><div class="line">538</div><div class="line">539</div><div class="line">540</div><div class="line">541</div><div class="line">542</div><div class="line">543</div><div class="line">544</div><div class="line">545</div><div class="line">546</div><div class="line">547</div><div class="line">548</div><div class="line">549</div><div class="line">550</div><div class="line">551</div><div class="line">552</div><div class="line">553</div><div class="line">554</div><div class="line">555</div><div class="line">556</div><div class="line">557</div><div class="line">558</div><div class="line">559</div><div class="line">560</div><div class="line">561</div><div class="line">562</div><div class="line">563</div><div class="line">564</div><div class="line">565</div><div class="line">566</div><div class="line">567</div><div class="line">568</div><div class="line">569</div><div class="line">570</div><div class="line">571</div><div class="line">572</div><div class="line">573</div><div class="line">574</div><div class="line">575</div><div class="line">576</div><div class="line">577</div><div class="line">578</div><div class="line">579</div><div class="line">580</div><div class="line">581</div><div class="line">582</div><div class="line">583</div><div class="line">584</div><div class="line">585</div><div class="line">586</div><div class="line">587</div><div class="line">588</div><div class="line">589</div><div class="line">590</div><div class="line">591</div><div class="line">592</div><div class="line">593</div><div class="line">594</div><div class="line">595</div><div class="line">596</div><div class="line">597</div><div class="line">598</div><div class="line">599</div><div class="line">600</div><div class="line">601</div><div class="line">602</div><div class="line">603</div><div class="line">604</div><div class="line">605</div><div class="line">606</div><div class="line">607</div><div class="line">608</div><div class="line">609</div><div class="line">610</div><div class="line">611</div><div class="line">612</div><div class="line">613</div><div class="line">614</div><div class="line">615</div><div class="line">616</div><div class="line">617</div><div class="line">618</div><div class="line">619</div><div class="line">620</div><div class="line">621</div><div class="line">622</div><div class="line">623</div><div class="line">624</div><div class="line">625</div><div class="line">626</div><div class="line">627</div><div class="line">628</div><div class="line">629</div><div class="line">630</div><div class="line">631</div><div class="line">632</div><div class="line">633</div><div class="line">634</div><div class="line">635</div><div class="line">636</div><div class="line">637</div><div class="line">638</div><div class="line">639</div><div class="line">640</div><div class="line">641</div><div class="line">642</div><div class="line">643</div><div class="line">644</div><div class="line">645</div><div class="line">646</div><div class="line">647</div><div class="line">648</div><div class="line">649</div><div class="line">650</div><div class="line">651</div><div class="line">652</div><div class="line">653</div><div class="line">654</div><div class="line">655</div><div class="line">656</div><div class="line">657</div><div class="line">658</div><div class="line">659</div><div class="line">660</div><div class="line">661</div><div class="line">662</div><div class="line">663</div><div class="line">664</div><div class="line">665</div><div class="line">666</div><div class="line">667</div><div class="line">668</div><div class="line">669</div><div class="line">670</div><div class="line">671</div><div class="line">672</div><div class="line">673</div><div class="line">674</div><div class="line">675</div><div class="line">676</div><div class="line">677</div><div class="line">678</div><div class="line">679</div><div class="line">680</div><div class="line">681</div><div class="line">682</div><div class="line">683</div><div class="line">684</div><div class="line">685</div><div class="line">686</div><div class="line">687</div><div class="line">688</div><div class="line">689</div><div class="line">690</div><div class="line">691</div><div class="line">692</div><div class="line">693</div><div class="line">694</div><div class="line">695</div><div class="line">696</div><div class="line">697</div><div class="line">698</div><div class="line">699</div><div class="line">700</div><div class="line">701</div><div class="line">702</div><div class="line">703</div><div class="line">704</div><div class="line">705</div><div class="line">706</div><div class="line">707</div><div class="line">708</div><div class="line">709</div><div class="line">710</div><div class="line">711</div><div class="line">712</div><div class="line">713</div><div class="line">714</div><div class="line">715</div><div class="line">716</div><div class="line">717</div><div class="line">718</div><div class="line">719</div><div class="line">720</div><div class="line">721</div><div class="line">722</div><div class="line">723</div><div class="line">724</div><div class="line">725</div><div class="line">726</div><div class="line">727</div><div class="line">728</div><div class="line">729</div><div class="line">730</div><div class="line">731</div><div class="line">732</div><div class="line">733</div><div class="line">734</div><div class="line">735</div><div class="line">736</div><div class="line">737</div><div class="line">738</div><div class="line">739</div><div class="line">740</div><div class="line">741</div><div class="line">742</div><div class="line">743</div><div class="line">744</div><div class="line">745</div><div class="line">746</div><div class="line">747</div><div class="line">748</div><div class="line">749</div><div class="line">750</div><div class="line">751</div><div class="line">752</div><div class="line">753</div><div class="line">754</div><div class="line">755</div><div class="line">756</div><div class="line">757</div><div class="line">758</div><div class="line">759</div><div class="line">760</div><div class="line">761</div><div class="line">762</div><div class="line">763</div><div class="line">764</div><div class="line">765</div><div class="line">766</div><div class="line">767</div><div class="line">768</div><div class="line">769</div><div class="line">770</div><div class="line">771</div><div class="line">772</div><div class="line">773</div><div class="line">774</div><div class="line">775</div><div class="line">776</div><div class="line">777</div><div class="line">778</div><div class="line">779</div><div class="line">780</div><div class="line">781</div><div class="line">782</div><div class="line">783</div><div class="line">784</div><div class="line">785</div><div class="line">786</div><div class="line">787</div><div class="line">788</div><div class="line">789</div><div class="line">790</div><div class="line">791</div><div class="line">792</div><div class="line">793</div><div class="line">794</div><div class="line">795</div><div class="line">796</div><div class="line">797</div><div class="line">798</div><div class="line">799</div><div class="line">800</div><div class="line">801</div><div class="line">802</div><div class="line">803</div><div class="line">804</div><div class="line">805</div><div class="line">806</div><div class="line">807</div><div class="line">808</div><div class="line">809</div><div class="line">810</div><div class="line">811</div><div class="line">812</div><div class="line">813</div><div class="line">814</div></pre></td><td class="code"><pre><div class="line"><span class="preprocessor">#<span class="keyword">include</span> &lt;stdio.h&gt; </span></div><div class="line"><span class="preprocessor">#<span class="keyword">include</span> &lt;vector&gt;</span></div><div class="line"><span class="preprocessor">#<span class="keyword">include</span> &lt;iostream&gt;</span></div><div class="line"><span class="preprocessor">#<span class="keyword">include</span> &lt;sstream&gt;</span></div><div class="line"><span class="preprocessor">#<span class="keyword">include</span> &lt;string&gt;</span></div><div class="line"><span class="preprocessor">#<span class="keyword">include</span> &lt;map&gt;</span></div><div class="line"><span class="preprocessor">#<span class="keyword">include</span> &lt;set&gt;</span></div><div class="line"><span class="preprocessor">#<span class="keyword">include</span> &lt;queue&gt;</span></div><div class="line"><span class="preprocessor">#<span class="keyword">include</span> &lt;stack&gt;</span></div><div class="line"><span class="preprocessor">#<span class="keyword">include</span> &lt;string.h&gt;</span></div><div class="line"><span class="preprocessor">#<span class="keyword">include</span> &lt;ctype.h&gt;</span></div><div class="line"><span class="preprocessor">#<span class="keyword">include</span> &lt;assert.h&gt;</span></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"></div><div class="line"><span class="preprocessor">#<span class="keyword">define</span> HTMLProduction</span></div><div class="line"><span class="comment">// #define DEBUG</span></div><div class="line"></div><div class="line"><span class="keyword">class</span> Production {</div><div class="line">	<span class="keyword">public</span>:</div><div class="line">		<span class="keyword">int</span> 			label;</div><div class="line">		<span class="built_in">string</span> 			LHS;</div><div class="line">		<span class="stl_container"><span class="built_in">vector</span>&lt;<span class="built_in">string</span>&gt;</span> 	RHS;</div><div class="line">		</div><div class="line">		Production(<span class="built_in">string</span> L = <span class="string">""</span>, <span class="stl_container"><span class="built_in">vector</span>&lt;<span class="built_in">string</span>&gt;</span> R = <span class="stl_container"><span class="built_in">vector</span>&lt;<span class="built_in">string</span>&gt;</span>(), <span class="keyword">int</span> l=<span class="number">0</span>) {</div><div class="line">			LHS = L;</div><div class="line">			RHS = R;</div><div class="line">			label = l;</div><div class="line">		}</div><div class="line"></div><div class="line">		<span class="keyword">bool</span> <span class="keyword">operator</span>&lt;(<span class="keyword">const</span> Production &p) <span class="keyword">const</span> {</div><div class="line">			<span class="keyword">if</span>(LHS != p.LHS)</div><div class="line">				<span class="keyword">return</span> LHS &lt; p.LHS;</div><div class="line">			<span class="keyword">for</span>(size_t i = <span class="number">0</span>, j = <span class="number">0</span>; i &lt; RHS.size() && j &lt; p.RHS.size(); i++, j++) {</div><div class="line">				<span class="keyword">if</span>(RHS[i] != p.RHS[i])</div><div class="line">					<span class="keyword">return</span> RHS[i] &lt; p.RHS[i];</div><div class="line">			}</div><div class="line">			<span class="keyword">return</span> RHS.size() &lt; p.RHS.size();</div><div class="line">		}</div><div class="line">		</div><div class="line">		<span class="keyword">bool</span> <span class="keyword">operator</span>==(<span class="keyword">const</span> Production &p) <span class="keyword">const</span> {</div><div class="line">			<span class="keyword">if</span>(LHS != p.LHS || RHS.size() != p.RHS.size())</div><div class="line">				<span class="keyword">return</span> <span class="keyword">false</span>;</div><div class="line">			<span class="keyword">for</span>(size_t i = <span class="number">0</span>, j = <span class="number">0</span>; i &lt; RHS.size(); i++, j++) {</div><div class="line">				<span class="keyword">if</span>(RHS[i] != p.RHS[i])</div><div class="line">					<span class="keyword">return</span> <span class="keyword">false</span>;</div><div class="line">			}</div><div class="line">			<span class="keyword">return</span> <span class="keyword">true</span>;</div><div class="line">		}</div><div class="line">		</div><div class="line">		<span class="keyword">bool</span> <span class="keyword">operator</span>!=(<span class="keyword">const</span> Production &p) <span class="keyword">const</span> {</div><div class="line">			<span class="keyword">return</span> !(*<span class="keyword">this</span> == p);</div><div class="line">		}</div><div class="line">		</div><div class="line">		<span class="keyword">void</span> print() {</div><div class="line">			<span class="built_in">printf</span>(<span class="string">"%s -&gt; "</span>, LHS.c_str());</div><div class="line">			<span class="keyword">for</span>(size_t i = <span class="number">0</span>; i &lt; RHS.size(); i++)</div><div class="line">				<span class="built_in">printf</span>(<span class="string">"%s"</span>, RHS[i].c_str());</div><div class="line">		}</div><div class="line">};</div><div class="line"></div><div class="line"><span class="keyword">class</span> Grammar {</div><div class="line">	<span class="keyword">public</span>:</div><div class="line">		<span class="comment">/* LR parsing */</span></div><div class="line">		<span class="keyword">class</span> ConfigurationSet {</div><div class="line">			<span class="keyword">public</span>:</div><div class="line">				<span class="keyword">class</span> State {</div><div class="line">					<span class="keyword">public</span>:</div><div class="line">						<span class="keyword">int</span> dot;</div><div class="line">						<span class="stl_container"><span class="built_in">vector</span>&lt;<span class="built_in">string</span>&gt;</span> lookahead;</div><div class="line">						</div><div class="line">						State(<span class="keyword">int</span> d=<span class="number">0</span>, <span class="stl_container"><span class="built_in">vector</span>&lt;<span class="built_in">string</span>&gt;</span> l=<span class="stl_container"><span class="built_in">vector</span>&lt;<span class="built_in">string</span>&gt;</span>()):</div><div class="line">							dot(d), lookahead(l) {}</div><div class="line">						<span class="keyword">bool</span> <span class="keyword">operator</span>&lt;(<span class="keyword">const</span> State &x) <span class="keyword">const</span> {</div><div class="line">							<span class="keyword">return</span> dot &lt; x.dot;</div><div class="line">						}</div><div class="line">						<span class="keyword">bool</span> <span class="keyword">operator</span>!=(<span class="keyword">const</span> State &x) <span class="keyword">const</span> {</div><div class="line">							<span class="keyword">return</span> dot != x.dot;</div><div class="line">						}</div><div class="line">				};</div><div class="line">				</div><div class="line">				<span class="stl_container"><span class="built_in">set</span>&lt; pair&lt;Production, State&gt;</span> &gt; 	configs;</div><div class="line">				<span class="keyword">int</span> 							label;</div><div class="line">				ConfigurationSet() {</div><div class="line">					label = <span class="number">0</span>;</div><div class="line">				}</div><div class="line">				<span class="comment">/* method */</span></div><div class="line">				<span class="keyword">static</span> ConfigurationSet closure0(ConfigurationSet& s, Grammar& g);</div><div class="line">				<span class="keyword">static</span> ConfigurationSet go_to0(ConfigurationSet& s, <span class="built_in">string</span> X, Grammar& g);</div><div class="line">				<span class="keyword">void</span> print(Grammar &g) {</div><div class="line">					<span class="stl_container"><span class="built_in">set</span>&lt; pair&lt;Production, State&gt;</span> &gt;::iterator it;</div><div class="line">					Production p;</div><div class="line">					</div><div class="line">					<span class="keyword">for</span>(it = configs.begin(); it != configs.end(); it++) {</div><div class="line">						p = it-&gt;first;</div><div class="line">						<span class="built_in">printf</span>(<span class="string">"%s -&gt;"</span>, p.LHS.c_str());</div><div class="line">						<span class="keyword">for</span>(size_t i = <span class="number">0</span>; i &lt; p.RHS.size(); i++) {</div><div class="line">							<span class="keyword">if</span>(i == it-&gt;second.dot)</div><div class="line">								<span class="built_in">printf</span>(<span class="string">"¡E"</span>);</div><div class="line">							<span class="built_in">printf</span>(<span class="string">" %s "</span>, p.RHS[i].c_str());</div><div class="line">						}</div><div class="line">						<span class="keyword">if</span>(it-&gt;second.dot == p.RHS.size())</div><div class="line">							<span class="built_in">printf</span>(<span class="string">"¡E"</span>);</div><div class="line">						<span class="built_in">printf</span>(<span class="string">" ,{"</span>);</div><div class="line">						<span class="stl_container"><span class="built_in">set</span>&lt;<span class="built_in">string</span>&gt;</span> fset = g.follow_set[p.LHS];</div><div class="line">						<span class="keyword">for</span>(<span class="stl_container"><span class="built_in">set</span>&lt;<span class="built_in">string</span>&gt;</span>::iterator jt = fset.begin();</div><div class="line">							jt != fset.end(); jt++) {</div><div class="line">							<span class="keyword">if</span>(jt != fset.begin())</div><div class="line">								<span class="built_in">cout</span> &lt;&lt; <span class="string">", "</span>;</div><div class="line">							<span class="built_in">cout</span> &lt;&lt; *jt;</div><div class="line">						}</div><div class="line">						<span class="built_in">printf</span>(<span class="string">"}"</span>);</div><div class="line">						<span class="built_in">puts</span>(<span class="string">""</span>);</div><div class="line">					}</div><div class="line">				}</div><div class="line">				<span class="keyword">bool</span> <span class="keyword">operator</span>&lt;(<span class="keyword">const</span> ConfigurationSet &x) <span class="keyword">const</span> {</div><div class="line">					<span class="keyword">if</span>(configs.size() != x.configs.size())</div><div class="line">						<span class="keyword">return</span> configs.size() &lt; x.configs.size();</div><div class="line">					<span class="keyword">for</span>(<span class="stl_container"><span class="built_in">set</span>&lt; pair&lt;Production, State&gt;</span> &gt;::iterator it = configs.begin(), jt = x.configs.begin();</div><div class="line">						it != configs.end(); it++, jt++) {</div><div class="line">						<span class="keyword">if</span>(it-&gt;first != jt-&gt;first)</div><div class="line">							<span class="keyword">return</span> it-&gt;first &lt; jt-&gt;first;</div><div class="line">						<span class="keyword">if</span>(it-&gt;second != jt-&gt;second)</div><div class="line">							<span class="keyword">return</span> it-&gt;second &lt; jt-&gt;second;</div><div class="line">					}</div><div class="line">					<span class="keyword">return</span> <span class="keyword">false</span>;</div><div class="line">					<span class="comment">// return label &lt; x.label;</span></div><div class="line">				}</div><div class="line">		};		</div><div class="line">		</div><div class="line">		<span class="keyword">static</span> <span class="keyword">const</span> <span class="built_in">string</span> 		lambda;</div><div class="line">		<span class="stl_container"><span class="built_in">set</span>&lt;<span class="built_in">string</span>&gt;</span>					symbols;</div><div class="line">		<span class="built_in">string</span> 						start_symbol;</div><div class="line">		<span class="stl_container"><span class="built_in">vector</span>&lt;Production&gt;</span> 			rules;</div><div class="line">		<span class="comment">/* LL(1) attribute */</span></div><div class="line">		<span class="stl_container"><span class="built_in">map</span>&lt;<span class="built_in">string</span>, <span class="stl_container"><span class="built_in">set</span>&lt;<span class="built_in">string</span>&gt;</span> &gt;</span> 	first_set;</div><div class="line">		<span class="stl_container"><span class="built_in">map</span>&lt;<span class="built_in">string</span>, <span class="stl_container"><span class="built_in">set</span>&lt;<span class="built_in">string</span>&gt;</span> &gt;</span> 	follow_set;</div><div class="line">		<span class="stl_container"><span class="built_in">map</span>&lt;<span class="built_in">string</span>, <span class="keyword">bool</span>&gt;</span> 			derives_lambda;</div><div class="line">		<span class="stl_container"><span class="built_in">map</span>&lt;<span class="built_in">string</span>, <span class="stl_container"><span class="built_in">map</span>&lt;<span class="built_in">string</span>, Production&gt;</span> &gt;</span>	lltable;</div><div class="line">		<span class="comment">/* LR attribute */</span></div><div class="line">		<span class="stl_container"><span class="built_in">vector</span>&lt;ConfigurationSet&gt;</span>	LRstates;</div><div class="line">		<span class="stl_container"><span class="built_in">map</span>&lt;<span class="keyword">int</span>, <span class="stl_container"><span class="built_in">map</span>&lt;<span class="built_in">string</span>, <span class="keyword">int</span>&gt;</span> &gt;</span>	go_to_table;</div><div class="line">		<span class="stl_container"><span class="built_in">map</span>&lt;<span class="keyword">int</span>, <span class="keyword">int</span>&gt;</span>				action_table;</div><div class="line">		</div><div class="line">		<span class="comment">/* common method */</span></div><div class="line">		<span class="keyword">static</span> <span class="keyword">bool</span> isNonterminal(<span class="built_in">string</span> token);</div><div class="line">		<span class="keyword">void</span> buildSymbols();</div><div class="line">		<span class="comment">/* LL(1) method */</span></div><div class="line">		<span class="stl_container"><span class="built_in">map</span>&lt;<span class="built_in">string</span>, <span class="keyword">bool</span>&gt;</span> mark_lambda();</div><div class="line">		<span class="keyword">void</span> fill_first_set();</div><div class="line">		<span class="keyword">void</span> fill_follow_set();</div><div class="line">		<span class="stl_container"><span class="built_in">set</span>&lt;<span class="built_in">string</span>&gt;</span> compute_first(<span class="stl_container"><span class="built_in">vector</span>&lt;<span class="built_in">string</span>&gt;</span> rhs);</div><div class="line">		<span class="stl_container"><span class="built_in">set</span>&lt;<span class="built_in">string</span>&gt;</span> get_predict_set(Production p);</div><div class="line">		<span class="keyword">void</span> fill_lltable();</div><div class="line">		<span class="keyword">void</span> lldriver(<span class="stl_container"><span class="built_in">queue</span>&lt;<span class="built_in">string</span>&gt;</span> tokens);</div><div class="line">		<span class="comment">/* LR method*/</span></div><div class="line">		<span class="keyword">void</span> build_CFSM();</div><div class="line">		<span class="keyword">void</span> build_action();</div><div class="line">		<span class="keyword">void</span> lr0driver(<span class="stl_container"><span class="built_in">queue</span>&lt;<span class="built_in">string</span>&gt;</span> tokens);</div><div class="line">		<span class="keyword">int</span> slr1driver(<span class="stl_container"><span class="built_in">queue</span>&lt;<span class="built_in">string</span>&gt;</span> tokens);</div><div class="line">		<span class="keyword">void</span> lalr1driver(<span class="stl_container"><span class="built_in">queue</span>&lt;<span class="built_in">string</span>&gt;</span> tokens);</div><div class="line">		<span class="comment">/* homework */</span></div><div class="line">		<span class="keyword">void</span> hw_build_CFSM();</div><div class="line">};</div><div class="line"><span class="comment">/* ------------------------</span></div><div class="line">ConfigurationSet method</div><div class="line">-------------------------- */</div><div class="line">Grammar::ConfigurationSet Grammar::ConfigurationSet::closure0(ConfigurationSet& s, Grammar& g) {</div><div class="line">	ConfigurationSet 	r = s;</div><div class="line">	<span class="keyword">bool</span>				changes;</div><div class="line">	<span class="built_in">string</span>				A;</div><div class="line">	Production			P;</div><div class="line">	<span class="keyword">int</span> 				dotPos;</div><div class="line">	</div><div class="line">	<span class="stl_container"><span class="built_in">set</span>&lt; pair&lt;Production, State&gt;</span> &gt;::iterator it;</div><div class="line">	<span class="keyword">do</span> {</div><div class="line">		changes = <span class="keyword">false</span>;</div><div class="line">		<span class="keyword">for</span>(it = r.configs.begin(); it != r.configs.end(); it++) {</div><div class="line">			P = it-&gt;first;</div><div class="line">			dotPos = it-&gt;second.dot;</div><div class="line">			<span class="keyword">if</span>(dotPos &gt;= P.RHS.size() || P.RHS[dotPos] == Grammar::lambda)</div><div class="line">				<span class="keyword">continue</span>;</div><div class="line">			A = P.RHS[dotPos];</div><div class="line">			<span class="keyword">if</span>(Grammar::isNonterminal(A)) {</div><div class="line">				<span class="comment">/* B -&gt; x.Ay */</span></div><div class="line">				<span class="comment">/* Predict productions with A as the left-hand side */</span></div><div class="line">				<span class="keyword">for</span>(size_t i = <span class="number">0</span>; i &lt; g.rules.size(); i++) {</div><div class="line">					<span class="keyword">if</span>(g.rules[i].LHS == A) {</div><div class="line">						<span class="keyword">if</span>(r.configs.find(make_pair(g.rules[i], State(<span class="number">0</span>))) == r.configs.end()) {</div><div class="line">							r.configs.insert(make_pair(g.rules[i], State(<span class="number">0</span>)));</div><div class="line">							changes = <span class="keyword">true</span>;</div><div class="line">						}</div><div class="line">					}</div><div class="line">				}</div><div class="line">			}</div><div class="line">		}</div><div class="line">	} <span class="keyword">while</span>(changes);</div><div class="line">	<span class="keyword">return</span> r;</div><div class="line">}</div><div class="line">Grammar::ConfigurationSet Grammar::ConfigurationSet::go_to0(ConfigurationSet& s, <span class="built_in">string</span> X, Grammar& g) {</div><div class="line">	ConfigurationSet sb;</div><div class="line">	<span class="stl_container"><span class="built_in">set</span>&lt; pair&lt;Production, State&gt;</span> &gt;::iterator it;</div><div class="line">	Production 	P;</div><div class="line">	<span class="keyword">int</span> 		dotPos;</div><div class="line">	</div><div class="line">	<span class="keyword">for</span>(it = s.configs.begin(); it != s.configs.end(); it++) {</div><div class="line">		P = it-&gt;first;</div><div class="line">		dotPos = it-&gt;second.dot;</div><div class="line">		<span class="keyword">if</span>(dotPos &gt;= P.RHS.size() || P.RHS[dotPos] == Grammar::lambda)</div><div class="line">			<span class="keyword">continue</span>;</div><div class="line">		<span class="keyword">if</span>(P.RHS[dotPos] == X) {</div><div class="line">			State state(dotPos + <span class="number">1</span>, it-&gt;second.lookahead);</div><div class="line">			sb.configs.insert(make_pair(P, state));</div><div class="line">		}</div><div class="line">	}</div><div class="line">	<span class="keyword">return</span> closure0(sb, g);</div><div class="line">}</div><div class="line"><span class="comment">/* ------------------------</span></div><div class="line">Grammar method</div><div class="line">-------------------------- */</div><div class="line"><span class="keyword">const</span> <span class="built_in">string</span> Grammar::lambda(<span class="string">"l"</span>);</div><div class="line"></div><div class="line"><span class="stl_container"><span class="built_in">set</span>&lt;<span class="built_in">string</span>&gt;</span> Grammar::compute_first(<span class="stl_container"><span class="built_in">vector</span>&lt;<span class="built_in">string</span>&gt;</span> rhs) {</div><div class="line">	<span class="stl_container"><span class="built_in">set</span>&lt;<span class="built_in">string</span>&gt;</span> result;</div><div class="line">	size_t 		i;</div><div class="line">	</div><div class="line">	<span class="keyword">if</span>(rhs.size() == <span class="number">0</span> || rhs[<span class="number">0</span>] == Grammar::lambda) {</div><div class="line">		result.insert(Grammar::lambda);</div><div class="line">	} <span class="keyword">else</span> {</div><div class="line">		result = first_set[rhs[<span class="number">0</span>]];</div><div class="line">		<span class="keyword">for</span>(i = <span class="number">1</span>; i &lt; rhs.size() && </div><div class="line">			first_set[rhs[i-<span class="number">1</span>]].find(Grammar::lambda) != first_set[rhs[i-<span class="number">1</span>]].end(); i++) {</div><div class="line">			<span class="stl_container"><span class="built_in">set</span>&lt;<span class="built_in">string</span>&gt;</span> f = first_set[rhs[i]];</div><div class="line">			f.erase(Grammar::lambda);</div><div class="line">			result.insert(f.begin(), f.end());	</div><div class="line">		}</div><div class="line">		<span class="keyword">if</span>(i == rhs.size() </div><div class="line">			&& first_set[rhs[i-<span class="number">1</span>]].find(Grammar::lambda) != first_set[rhs[i-<span class="number">1</span>]].end()) {</div><div class="line">			result.insert(Grammar::lambda);</div><div class="line">		} <span class="keyword">else</span> {</div><div class="line">			result.erase(Grammar::lambda);</div><div class="line">		}</div><div class="line">	}</div><div class="line">	</div><div class="line">	<span class="keyword">return</span> result;</div><div class="line">} </div><div class="line"><span class="comment">/*</span></div><div class="line"> * please call get_predict_set() after fill_follow_set() and fill_first_set()</div><div class="line"> */</div><div class="line"><span class="stl_container"><span class="built_in">set</span>&lt;<span class="built_in">string</span>&gt;</span> Grammar::get_predict_set(Production p) {</div><div class="line">	<span class="stl_container"><span class="built_in">set</span>&lt;<span class="built_in">string</span>&gt;</span> result;</div><div class="line">	<span class="stl_container"><span class="built_in">set</span>&lt;<span class="built_in">string</span>&gt;</span> rfirst;</div><div class="line">	</div><div class="line">	rfirst = compute_first(p.RHS);</div><div class="line">	<span class="keyword">if</span>(rfirst.find(Grammar::lambda) != rfirst.end()) {</div><div class="line">		rfirst.erase(Grammar::lambda);</div><div class="line">		result.insert(rfirst.begin(), rfirst.end());</div><div class="line">		rfirst = follow_set[p.LHS];</div><div class="line">		result.insert(rfirst.begin(), rfirst.end());</div><div class="line">	} <span class="keyword">else</span> {</div><div class="line">		result.insert(rfirst.begin(), rfirst.end());</div><div class="line">	}</div><div class="line">	</div><div class="line">	<span class="keyword">return</span> result;</div><div class="line">}</div><div class="line"><span class="comment">/*</span></div><div class="line"> * </div><div class="line"> */</div><div class="line"><span class="keyword">void</span> Grammar::fill_lltable() {</div><div class="line">	<span class="built_in">string</span>		A; <span class="comment">// nonterminal</span></div><div class="line">	Production 	p;</div><div class="line">	</div><div class="line">	<span class="keyword">for</span>(size_t i = <span class="number">0</span>; i &lt; rules.size(); i++) {</div><div class="line">		p = rules[i];</div><div class="line">		A = p.LHS;</div><div class="line">		<span class="stl_container"><span class="built_in">set</span>&lt;<span class="built_in">string</span>&gt;</span> predict_set = get_predict_set(p);</div><div class="line">		</div><div class="line">		<span class="keyword">for</span>(<span class="stl_container"><span class="built_in">set</span>&lt;<span class="built_in">string</span>&gt;</span>::iterator it = predict_set.begin();</div><div class="line">			it != predict_set.end(); it++) {</div><div class="line">			assert(lltable[A].find(*it) == lltable[A].end());</div><div class="line">			lltable[A][*it] = p;</div><div class="line">		}</div><div class="line">	}</div><div class="line">	</div><div class="line">}</div><div class="line"><span class="keyword">void</span> Grammar::buildSymbols() {</div><div class="line">	symbols.clear();</div><div class="line">	<span class="keyword">for</span>(size_t i = <span class="number">0</span>; i &lt; rules.size(); i++) {</div><div class="line">		symbols.insert(rules[i].LHS);</div><div class="line">		<span class="keyword">for</span>(size_t j = <span class="number">0</span>; j &lt; rules[i].RHS.size(); j++) {</div><div class="line">			symbols.insert(rules[i].RHS[j]);</div><div class="line">		}</div><div class="line">	}</div><div class="line">}</div><div class="line"><span class="keyword">bool</span> Grammar::isNonterminal(<span class="built_in">string</span> token) {</div><div class="line"></div><div class="line"><span class="preprocessor">#ifdef HTMLProduction</span></div><div class="line">	<span class="keyword">if</span>(token == Grammar::lambda)</div><div class="line">		<span class="keyword">return</span> <span class="keyword">false</span>;</div><div class="line">	<span class="keyword">if</span>(token[<span class="number">0</span>] == <span class="string">'&lt;'</span> && token[token.length() - <span class="number">1</span>] == <span class="string">'&gt;'</span>)</div><div class="line">		<span class="keyword">return</span> <span class="keyword">true</span>;</div><div class="line">	<span class="keyword">return</span> <span class="keyword">false</span>;</div><div class="line"><span class="preprocessor">#<span class="keyword">else</span></span></div><div class="line">	<span class="keyword">if</span>(token == Grammar::lambda)</div><div class="line">		<span class="keyword">return</span> <span class="keyword">false</span>;</div><div class="line">	<span class="keyword">for</span>(size_t i = <span class="number">0</span>; i &lt; token.length(); i++) {</div><div class="line">		<span class="keyword">if</span>(<span class="built_in">isupper</span>(token[i]))</div><div class="line">			<span class="keyword">return</span> <span class="keyword">true</span>;</div><div class="line">	}</div><div class="line">	<span class="keyword">return</span> <span class="keyword">false</span>;</div><div class="line"><span class="preprocessor">#<span class="keyword">endif</span></span></div><div class="line">}</div><div class="line"><span class="comment">/* ------------------------</span></div><div class="line">Grammar LL method</div><div class="line">-------------------------- */</div><div class="line"><span class="stl_container"><span class="built_in">map</span>&lt;<span class="built_in">string</span>, <span class="keyword">bool</span>&gt;</span> Grammar::mark_lambda() {</div><div class="line">	<span class="keyword">bool</span> 				rhs_derives_lambda;</div><div class="line">	<span class="keyword">bool</span> 				changes;</div><div class="line">	Production 			p;</div><div class="line">	</div><div class="line">	derives_lambda.clear();</div><div class="line">	</div><div class="line">	<span class="comment">/* initially, nothing is marked. */</span></div><div class="line">	<span class="keyword">for</span>(size_t i = <span class="number">0</span>; i &lt; rules.size(); i++) {</div><div class="line">		derives_lambda[rules[i].LHS] = <span class="keyword">false</span>;</div><div class="line">	}</div><div class="line">	<span class="keyword">do</span> {</div><div class="line">		changes = <span class="keyword">false</span>;</div><div class="line">		<span class="keyword">for</span>(size_t i = <span class="number">0</span>; i &lt; rules.size(); i++) {</div><div class="line">			p = rules[i];</div><div class="line">			<span class="keyword">if</span>(!derives_lambda[p.LHS]) {</div><div class="line">				<span class="keyword">if</span>(p.RHS.size() == <span class="number">0</span> || p.RHS[<span class="number">0</span>] == Grammar::lambda) {</div><div class="line">					changes = derives_lambda[p.LHS] = <span class="keyword">true</span>;</div><div class="line">					<span class="keyword">continue</span>;</div><div class="line">				}</div><div class="line">				<span class="comment">/* does each part of RHS derive lambda ? */</span></div><div class="line">				rhs_derives_lambda = derives_lambda[<span class="built_in">string</span>(p.RHS[<span class="number">0</span>])];</div><div class="line">				<span class="keyword">for</span>(size_t j = <span class="number">1</span>; j &lt; p.RHS.size(); j++) {</div><div class="line">					rhs_derives_lambda &= derives_lambda[p.RHS[j]];</div><div class="line">				}</div><div class="line">				<span class="keyword">if</span>(rhs_derives_lambda) {</div><div class="line">					changes = <span class="keyword">true</span>;</div><div class="line">					derives_lambda[p.LHS] = <span class="keyword">true</span>;</div><div class="line">				}</div><div class="line">			}</div><div class="line">		}</div><div class="line">	} <span class="keyword">while</span>(changes);</div><div class="line">	<span class="keyword">return</span> derives_lambda;</div><div class="line">}</div><div class="line"><span class="keyword">void</span> Grammar::fill_first_set() {</div><div class="line">	</div><div class="line">	<span class="built_in">string</span> 		A; <span class="comment">// nonterminal</span></div><div class="line">	<span class="built_in">string</span> 		a; <span class="comment">// terminal</span></div><div class="line">	Production 	p;</div><div class="line">	<span class="keyword">bool</span> 		changes;</div><div class="line">		</div><div class="line">	mark_lambda();</div><div class="line">	first_set.clear();</div><div class="line">	</div><div class="line">	<span class="keyword">for</span>(size_t i = <span class="number">0</span>; i &lt; rules.size(); i++) {</div><div class="line">		A = rules[i].LHS;</div><div class="line">		<span class="keyword">if</span>(derives_lambda[A])</div><div class="line">			first_set[A].insert(Grammar::lambda);</div><div class="line">	}</div><div class="line">	</div><div class="line">	<span class="keyword">for</span>(size_t i = <span class="number">0</span>; i &lt; rules.size(); i++) {</div><div class="line">		<span class="keyword">for</span>(size_t j = <span class="number">0</span>; j &lt; rules[i].RHS.size(); j++) {</div><div class="line">			a = rules[i].RHS[j];</div><div class="line">			<span class="keyword">if</span>(!isNonterminal(a)) {</div><div class="line">				<span class="keyword">if</span>(a != Grammar::lambda)</div><div class="line">					first_set[a].insert(a);</div><div class="line">				<span class="keyword">if</span>(j == <span class="number">0</span>) { <span class="comment">// A -&gt; aXX</span></div><div class="line">					first_set[rules[i].LHS].insert(a);</div><div class="line">				}</div><div class="line">			}</div><div class="line">		}</div><div class="line">	}</div><div class="line">	</div><div class="line">	<span class="keyword">do</span> {</div><div class="line">		changes = <span class="keyword">false</span>;</div><div class="line">		<span class="keyword">for</span>(size_t i = <span class="number">0</span>; i &lt; rules.size(); i++) {</div><div class="line">			p = rules[i];</div><div class="line">			<span class="stl_container"><span class="built_in">set</span>&lt;<span class="built_in">string</span>&gt;</span> rfirst = compute_first(p.RHS);</div><div class="line">			size_t oldsize = first_set[p.LHS].size();</div><div class="line">			first_set[p.LHS].insert(rfirst.begin(), rfirst.end());</div><div class="line">			size_t newsize = first_set[p.LHS].size();</div><div class="line">			<span class="keyword">if</span>(oldsize != newsize)</div><div class="line">				changes = <span class="keyword">true</span>;</div><div class="line">		}</div><div class="line">	} <span class="keyword">while</span>(changes);</div><div class="line">} </div><div class="line"></div><div class="line"><span class="keyword">void</span> Grammar::fill_follow_set() {</div><div class="line">	<span class="built_in">string</span> 	A, B; <span class="comment">// nonterminal</span></div><div class="line">	Production 	p;</div><div class="line">	<span class="keyword">bool</span> 	changes;</div><div class="line">	</div><div class="line">	<span class="keyword">for</span>(size_t i = <span class="number">0</span>; i &lt; rules.size(); i++) {</div><div class="line">		A = rules[i].LHS;</div><div class="line">		follow_set[A].clear();</div><div class="line">	}</div><div class="line">	</div><div class="line">	follow_set[start_symbol].insert(Grammar::lambda);</div><div class="line">		</div><div class="line">	<span class="keyword">do</span> {</div><div class="line">		changes = <span class="keyword">false</span>;</div><div class="line">		<span class="keyword">for</span>(size_t i = <span class="number">0</span>; i &lt; rules.size(); i++) {</div><div class="line">			<span class="comment">/* A -&gt; a B b</span></div><div class="line">			 * I.e. for each production and each occurrence</div><div class="line">			 * of a nonterminal in its right-hand side. </div><div class="line">			 */</div><div class="line">			p = rules[i];</div><div class="line">			A = p.LHS;</div><div class="line">			<span class="keyword">for</span>(size_t j = <span class="number">0</span>; j &lt; p.RHS.size(); j++) {</div><div class="line">				B = p.RHS[j];</div><div class="line">				<span class="keyword">if</span>(isNonterminal(B)) {</div><div class="line">					<span class="stl_container"><span class="built_in">vector</span>&lt;<span class="built_in">string</span>&gt;</span> beta(p.RHS.begin() + j + <span class="number">1</span>, p.RHS.end());</div><div class="line">					<span class="stl_container"><span class="built_in">set</span>&lt;<span class="built_in">string</span>&gt;</span> rfirst = compute_first(beta);</div><div class="line">					size_t oldsize = follow_set[B].size();</div><div class="line">					</div><div class="line">					<span class="keyword">if</span>(rfirst.find(Grammar::lambda) == rfirst.end()) {</div><div class="line">						follow_set[B].insert(rfirst.begin(), rfirst.end());	</div><div class="line">					} <span class="keyword">else</span> {</div><div class="line">						rfirst.erase(Grammar::lambda);</div><div class="line">						follow_set[B].insert(rfirst.begin(), rfirst.end());	</div><div class="line">						rfirst = follow_set[A];</div><div class="line">						follow_set[B].insert(rfirst.begin(), rfirst.end());</div><div class="line">					}</div><div class="line">					size_t newsize = follow_set[B].size();			</div><div class="line">					<span class="keyword">if</span>(oldsize != newsize)</div><div class="line">						changes = <span class="keyword">true</span>;</div><div class="line">				}</div><div class="line">			}</div><div class="line">		}</div><div class="line">	} <span class="keyword">while</span>(changes);</div><div class="line">}</div><div class="line"></div><div class="line"><span class="keyword">void</span> Grammar::lldriver(<span class="stl_container"><span class="built_in">queue</span>&lt;<span class="built_in">string</span>&gt;</span> tokens) {</div><div class="line">	<span class="stl_container"><span class="built_in">stack</span>&lt;<span class="built_in">string</span>&gt;</span> 	stk;</div><div class="line">	<span class="built_in">string</span> 			X;</div><div class="line">	<span class="built_in">string</span>			a;</div><div class="line">	Production		p;</div><div class="line">	<span class="comment">/* Push the Start Symbol onto an empty stack */</span></div><div class="line">	stk.push(start_symbol);</div><div class="line">	</div><div class="line">	<span class="keyword">while</span>(!stk.empty() && !tokens.empty()) {</div><div class="line">		X = stk.top();</div><div class="line">		a = tokens.front();</div><div class="line">		<span class="comment">// cout &lt;&lt; X &lt;&lt; " " &lt;&lt; a &lt;&lt; endl;</span></div><div class="line">		<span class="keyword">if</span>(isNonterminal(X) && lltable[X].find(a) != lltable[X].end()) {</div><div class="line">			p = lltable[X][a];</div><div class="line">			stk.pop();</div><div class="line">			<span class="keyword">for</span>(<span class="keyword">int</span> i = p.RHS.size() - <span class="number">1</span>; i &gt;= <span class="number">0</span>; i--) {</div><div class="line">				<span class="keyword">if</span>(p.RHS[i] == Grammar::lambda)</div><div class="line">					<span class="keyword">continue</span>;</div><div class="line">				stk.push(p.RHS[i]);</div><div class="line">			}</div><div class="line">		} <span class="keyword">else</span> <span class="keyword">if</span>(X == a) {</div><div class="line">			stk.pop();</div><div class="line">			tokens.pop();</div><div class="line">		} <span class="keyword">else</span> <span class="keyword">if</span>(lltable[X].find(Grammar::lambda) != lltable[X].end()) {</div><div class="line">			stk.pop();</div><div class="line">		} <span class="keyword">else</span> {</div><div class="line">			<span class="comment">/* Process syntax error. */</span></div><div class="line">			<span class="built_in">puts</span>(<span class="string">"Bad!"</span>);</div><div class="line">			<span class="keyword">return</span>;</div><div class="line">		}</div><div class="line">	}</div><div class="line">	<span class="keyword">while</span>(!stk.empty()) {</div><div class="line">		X = stk.top();</div><div class="line">		<span class="keyword">if</span>(lltable[X].find(Grammar::lambda) != lltable[X].end())</div><div class="line">			stk.pop();</div><div class="line">		<span class="keyword">else</span></div><div class="line">			<span class="keyword">break</span>;</div><div class="line">	}</div><div class="line">	<span class="keyword">if</span>(tokens.size() == <span class="number">0</span> && stk.size() == <span class="number">0</span>)</div><div class="line">		<span class="built_in">puts</span>(<span class="string">"Good"</span>);</div><div class="line">	<span class="keyword">else</span></div><div class="line">		<span class="built_in">puts</span>(<span class="string">"Bad!"</span>);</div><div class="line">	<span class="keyword">return</span>;</div><div class="line">}</div><div class="line"><span class="comment">/* ------------------------</span></div><div class="line">Grammar LR method</div><div class="line">-------------------------- */</div><div class="line"><span class="keyword">void</span> Grammar::build_action() {</div><div class="line">	ConfigurationSet 	s;</div><div class="line">	Production 			P;</div><div class="line">	<span class="keyword">int</span>					dotPos;</div><div class="line">	<span class="stl_container"><span class="built_in">set</span>&lt; pair&lt;Production, ConfigurationSet::State&gt;</span> &gt;::iterator it;</div><div class="line">	</div><div class="line">	<span class="keyword">for</span>(size_t i = <span class="number">0</span>; i &lt; LRstates.size(); i++) {</div><div class="line">		s = LRstates[i];</div><div class="line">		<span class="keyword">int</span> reduce = <span class="number">0</span>, rule = <span class="number">0</span>, accept = <span class="number">1</span>;</div><div class="line">		<span class="keyword">for</span>(it = s.configs.begin(); it != s.configs.end(); it++) {</div><div class="line">			P = it-&gt;first, dotPos = it-&gt;second.dot;</div><div class="line">			<span class="keyword">if</span>(dotPos == P.RHS.size())</div><div class="line">				reduce++, rule = P.label;</div><div class="line">			accept &= P.LHS == Grammar::start_symbol;</div><div class="line">		}</div><div class="line">		<span class="keyword">if</span>(accept == <span class="number">1</span>)</div><div class="line">			action_table[i] = <span class="number">0</span>;</div><div class="line">		<span class="keyword">else</span> <span class="keyword">if</span>(reduce == <span class="number">1</span>)</div><div class="line">			action_table[i] = -<span class="number">1</span>;</div><div class="line">		<span class="keyword">else</span></div><div class="line">			action_table[i] = <span class="number">1</span>;</div><div class="line">	}</div><div class="line"><span class="preprocessor">#ifdef DEBUG</span></div><div class="line">	<span class="built_in">printf</span>(<span class="string">"State |"</span>);</div><div class="line">	<span class="keyword">for</span>(size_t i = <span class="number">0</span>; i &lt; LRstates.size(); i++)</div><div class="line">		<span class="built_in">printf</span>(<span class="string">"%5d|"</span>, i);</div><div class="line">	<span class="built_in">puts</span>(<span class="string">""</span>);</div><div class="line">	<span class="built_in">printf</span>(<span class="string">"Action|"</span>);</div><div class="line">	<span class="keyword">for</span>(size_t i = <span class="number">0</span>; i &lt; action_table.size(); i++) {</div><div class="line">		<span class="built_in">printf</span>(<span class="string">"%5d|"</span>, action_table[i]);</div><div class="line">	}</div><div class="line">	<span class="built_in">puts</span>(<span class="string">""</span>);</div><div class="line"><span class="preprocessor">#<span class="keyword">endif</span></span></div><div class="line">}</div><div class="line"><span class="keyword">void</span> Grammar::build_CFSM() {</div><div class="line">	<span class="stl_container"><span class="built_in">set</span>&lt;ConfigurationSet&gt;</span> 	S;</div><div class="line">	<span class="stl_container"><span class="built_in">queue</span>&lt;ConfigurationSet&gt;</span>	Q;</div><div class="line">	ConfigurationSet 		s0, sb;</div><div class="line">	<span class="keyword">int</span> 					label = <span class="number">0</span>;</div><div class="line">	ConfigurationSet::State state;</div><div class="line">	</div><div class="line">	state.dot = <span class="number">0</span>;</div><div class="line">	state.lookahead = <span class="stl_container"><span class="built_in">vector</span>&lt;<span class="built_in">string</span>&gt;</span>();</div><div class="line">	state.lookahead.push_back(Grammar::lambda);</div><div class="line">	<span class="keyword">for</span>(size_t i = <span class="number">0</span>; i &lt; rules.size(); i++) {</div><div class="line">		<span class="keyword">if</span>(rules[i].LHS == <span class="keyword">this</span>-&gt;start_symbol) {</div><div class="line">			s0.configs.insert(make_pair(rules[i], state));</div><div class="line">		}</div><div class="line">	}</div><div class="line">	s0 = ConfigurationSet::closure0(s0, *<span class="keyword">this</span>);</div><div class="line">	s0.label = label++;</div><div class="line">	</div><div class="line">	S.insert(s0);</div><div class="line">	Q.push(s0);</div><div class="line">	</div><div class="line">	buildSymbols();</div><div class="line">	<span class="comment">/* hw need */</span></div><div class="line">	<span class="stl_container"><span class="built_in">map</span>&lt;<span class="keyword">int</span>, <span class="stl_container"><span class="built_in">vector</span>&lt; pair&lt;<span class="keyword">int</span>, <span class="built_in">string</span>&gt;</span> &gt;</span> &gt; hwPrint;</div><div class="line">	<span class="comment">/* hw need */</span></div><div class="line">	<span class="keyword">while</span>(!Q.empty()) {</div><div class="line">		s0 = Q.front(), Q.pop();</div><div class="line">		LRstates.push_back(s0);</div><div class="line">		<span class="keyword">for</span>(<span class="stl_container"><span class="built_in">set</span>&lt;<span class="built_in">string</span>&gt;</span>::iterator it = symbols.begin();</div><div class="line">			it != symbols.end(); it++) {</div><div class="line">			sb = ConfigurationSet::go_to0(s0, *it, *<span class="keyword">this</span>);</div><div class="line">			<span class="keyword">if</span>(sb.configs.size() &gt; <span class="number">0</span>) {</div><div class="line">				<span class="keyword">if</span>(S.find(sb) == S.end()) {</div><div class="line">					sb.label = label++;</div><div class="line">					S.insert(sb);</div><div class="line">					Q.push(sb);</div><div class="line">				}</div><div class="line">				</div><div class="line">				go_to_table[s0.label][*it] = (* S.find(sb)).label;</div><div class="line">				<span class="comment">/* hw need */</span></div><div class="line">				hwPrint[(* S.find(sb)).label].push_back(make_pair(s0.label, *it));</div><div class="line">			}</div><div class="line">		}</div><div class="line">	}</div><div class="line">	<span class="comment">// build_action();</span></div><div class="line"><span class="preprocessor">#ifdef DEBUG	</span></div><div class="line">	<span class="built_in">printf</span>(<span class="string">"Total State: %d\n"</span>, label);</div><div class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; label; i++) {</div><div class="line">		<span class="keyword">if</span>(hwPrint[i].size() &gt; <span class="number">0</span>) {</div><div class="line">			<span class="built_in">printf</span>(<span class="string">"State %d from"</span>, i);</div><div class="line">			<span class="keyword">for</span>(<span class="stl_container"><span class="built_in">vector</span>&lt; pair&lt;<span class="keyword">int</span>, <span class="built_in">string</span>&gt;</span> &gt;::iterator it = hwPrint[i].begin();</div><div class="line">				it != hwPrint[i].end(); it++) {</div><div class="line">				<span class="built_in">printf</span>(<span class="string">"%cState %d(%s)"</span>, it == hwPrint[i].begin() ? <span class="string">' '</span> : <span class="string">','</span>, it-&gt;first, it-&gt;second.c_str());</div><div class="line">			}</div><div class="line">			<span class="built_in">puts</span>(<span class="string">""</span>);</div><div class="line">		} <span class="keyword">else</span> {</div><div class="line">			<span class="built_in">printf</span>(<span class="string">"State %d\n"</span>, i);</div><div class="line">		}</div><div class="line">		LRstates[i].print(*<span class="keyword">this</span>);</div><div class="line">		<span class="built_in">puts</span>(<span class="string">""</span>);</div><div class="line">	}</div><div class="line"><span class="preprocessor">#<span class="keyword">endif</span></span></div><div class="line">}</div><div class="line"><span class="keyword">int</span> Grammar::slr1driver(<span class="stl_container"><span class="built_in">queue</span>&lt;<span class="built_in">string</span>&gt;</span> tokens) {</div><div class="line">	<span class="stl_container"><span class="built_in">stack</span>&lt;<span class="keyword">int</span>&gt;</span> 		stateStk;</div><div class="line">	<span class="stl_container"><span class="built_in">stack</span>&lt;<span class="built_in">string</span>&gt;</span> 	tokenStk;</div><div class="line">	<span class="keyword">int</span> 			state;</div><div class="line">	<span class="built_in">string</span>			X;</div><div class="line">	</div><div class="line">	stateStk.push(<span class="number">0</span>); <span class="comment">/* push start state */</span></div><div class="line">	<span class="keyword">while</span>(!tokens.empty()) {</div><div class="line">		state = stateStk.top();</div><div class="line">		X = tokens.front();</div><div class="line"><span class="preprocessor">#ifdef DEBUG </span></div><div class="line">		<span class="built_in">puts</span>(<span class="string">""</span>);</div><div class="line">		<span class="built_in">printf</span>(<span class="string">"state %d front %s\n"</span>, state, X.c_str());</div><div class="line">		LRstates[state].print(*<span class="keyword">this</span>);</div><div class="line">		<span class="keyword">for</span> (std::<span class="stl_container"><span class="built_in">stack</span>&lt;<span class="keyword">int</span>&gt;</span> dump = stateStk; !dump.empty(); dump.pop())</div><div class="line">        	std::<span class="built_in">cout</span> &lt;&lt; <span class="string">"state stack "</span>&lt;&lt; dump.top() &lt;&lt; <span class="string">'\n'</span>;</div><div class="line">		<span class="keyword">for</span> (std::<span class="stl_container"><span class="built_in">stack</span>&lt;<span class="built_in">string</span>&gt;</span> dump = tokenStk; !dump.empty(); dump.pop())</div><div class="line">        	std::<span class="built_in">cout</span> &lt;&lt; <span class="string">"token stack "</span>&lt;&lt; dump.top() &lt;&lt; <span class="string">'\n'</span>;</div><div class="line"><span class="preprocessor">#<span class="keyword">endif</span></span></div><div class="line">		<span class="keyword">int</span> reduce = <span class="number">0</span>, shift = <span class="number">0</span>;</div><div class="line">		Production P;</div><div class="line">		<span class="keyword">for</span>(<span class="stl_container"><span class="built_in">set</span>&lt; pair&lt;Production, ConfigurationSet::State&gt;</span> &gt;::iterator it = LRstates[state].configs.begin(); </div><div class="line">			it != LRstates[state].configs.end(); it++) {</div><div class="line">			Production q = it-&gt;first;</div><div class="line">			ConfigurationSet::State s = it-&gt;second;</div><div class="line">			<span class="keyword">if</span>(follow_set[q.LHS].find(X) != follow_set[q.LHS].end() && </div><div class="line">					(s.dot == q.RHS.size() || q.RHS[<span class="number">0</span>] == Grammar::lambda)) {</div><div class="line">				reduce++;</div><div class="line">				P = q;</div><div class="line">			}</div><div class="line">		}</div><div class="line">		<span class="keyword">if</span>(go_to_table[state].find(X) != go_to_table[state].end())</div><div class="line">			shift++;</div><div class="line">		<span class="keyword">if</span>(reduce + shift &gt;= <span class="number">2</span>)</div><div class="line">			assert(<span class="keyword">false</span>); <span class="comment">// grammar can't use simple LR.</span></div><div class="line">		<span class="keyword">if</span>(reduce + shift == <span class="number">0</span>)</div><div class="line">			<span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">		<span class="keyword">if</span>(reduce == <span class="number">1</span>) { <span class="comment">// Reduce</span></div><div class="line">			<span class="keyword">for</span>(size_t i = <span class="number">0</span>; i &lt; P.RHS.size(); i++) </div><div class="line">				tokenStk.pop(), stateStk.pop();</div><div class="line"></div><div class="line">			tokenStk.push(P.LHS);</div><div class="line">			state = stateStk.top();</div><div class="line">			<span class="keyword">if</span>(go_to_table[state].find(P.LHS) == go_to_table[state].end()) {</div><div class="line">				<span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">			}</div><div class="line">			state = go_to_table[state][P.LHS];</div><div class="line">			stateStk.push(state);</div><div class="line">		} <span class="keyword">else</span> { <span class="comment">// shift</span></div><div class="line">			state = go_to_table[state][X];</div><div class="line">			stateStk.push(state);</div><div class="line">			tokenStk.push(X);</div><div class="line">			tokens.pop();</div><div class="line">		}</div><div class="line">	}</div><div class="line">	<span class="keyword">while</span>(!stateStk.empty()) {</div><div class="line">		state = stateStk.top();</div><div class="line">		X = Grammar::lambda;</div><div class="line"><span class="preprocessor">#ifdef DEBUG </span></div><div class="line">		<span class="built_in">puts</span>(<span class="string">""</span>);</div><div class="line">		<span class="built_in">printf</span>(<span class="string">"state %d front %s\n"</span>, state, X.c_str());</div><div class="line">		LRstates[state].print(*<span class="keyword">this</span>);</div><div class="line">		<span class="keyword">for</span> (std::<span class="stl_container"><span class="built_in">stack</span>&lt;<span class="keyword">int</span>&gt;</span> dump = stateStk; !dump.empty(); dump.pop())</div><div class="line">        	std::<span class="built_in">cout</span> &lt;&lt; <span class="string">"state stack "</span>&lt;&lt; dump.top() &lt;&lt; <span class="string">'\n'</span>;</div><div class="line">		<span class="keyword">for</span> (std::<span class="stl_container"><span class="built_in">stack</span>&lt;<span class="built_in">string</span>&gt;</span> dump = tokenStk; !dump.empty(); dump.pop())</div><div class="line">        	std::<span class="built_in">cout</span> &lt;&lt; <span class="string">"token stack "</span>&lt;&lt; dump.top() &lt;&lt; <span class="string">'\n'</span>;</div><div class="line"><span class="preprocessor">#<span class="keyword">endif</span></span></div><div class="line">		<span class="keyword">int</span> reduce = <span class="number">0</span>, shift = <span class="number">0</span>;</div><div class="line">		Production P;</div><div class="line">		<span class="keyword">for</span>(<span class="stl_container"><span class="built_in">set</span>&lt; pair&lt;Production, ConfigurationSet::State&gt;</span> &gt;::iterator it = LRstates[state].configs.begin(); </div><div class="line">			it != LRstates[state].configs.end(); it++) {</div><div class="line">			Production q = it-&gt;first;</div><div class="line">			ConfigurationSet::State s = it-&gt;second;</div><div class="line">			<span class="keyword">if</span>(follow_set[q.LHS].find(X) != follow_set[q.LHS].end() && </div><div class="line">					(s.dot == q.RHS.size() || q.RHS[<span class="number">0</span>] == Grammar::lambda)) {</div><div class="line">				reduce++;</div><div class="line">				P = q;</div><div class="line">			}</div><div class="line">		}</div><div class="line">		<span class="keyword">if</span>(go_to_table[state].find(X) != go_to_table[state].end())</div><div class="line">			shift++;</div><div class="line">		<span class="keyword">if</span>(reduce + shift &gt;= <span class="number">2</span>)</div><div class="line">			assert(<span class="keyword">false</span>); <span class="comment">// grammar can't use simple LR.</span></div><div class="line">		<span class="keyword">if</span>(reduce + shift == <span class="number">0</span>)</div><div class="line">			<span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">		<span class="keyword">if</span>(reduce == <span class="number">1</span>) { <span class="comment">// Reduce</span></div><div class="line">			<span class="keyword">for</span>(size_t i = <span class="number">0</span>; i &lt; P.RHS.size(); i++) </div><div class="line">				tokenStk.pop(), stateStk.pop();</div><div class="line"></div><div class="line">			tokenStk.push(P.LHS);</div><div class="line">			state = stateStk.top();</div><div class="line">			<span class="keyword">if</span>(go_to_table[state].find(P.LHS) == go_to_table[state].end()) {</div><div class="line">				<span class="keyword">if</span>(P.LHS == Grammar::start_symbol)</div><div class="line">					<span class="keyword">return</span> <span class="number">1</span>;</div><div class="line">				<span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">			}</div><div class="line">			state = go_to_table[state][P.LHS];</div><div class="line">			stateStk.push(state);</div><div class="line">		} <span class="keyword">else</span> { <span class="comment">// shift</span></div><div class="line">			state = go_to_table[state][X];</div><div class="line">			stateStk.push(state);</div><div class="line">			tokenStk.push(X);</div><div class="line">			tokens.pop();</div><div class="line">		}</div><div class="line">	}</div><div class="line">	<span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">}</div><div class="line"><span class="keyword">void</span> parsingProduction(<span class="built_in">string</span> r, Grammar &g) {</div><div class="line">	<span class="keyword">static</span> <span class="keyword">int</span> 		production_label = <span class="number">0</span>;</div><div class="line">	<span class="built_in">stringstream</span> 	<span class="built_in">sin</span>(r);</div><div class="line">	<span class="built_in">string</span> 			lhs, foo;</div><div class="line">	<span class="stl_container"><span class="built_in">vector</span>&lt;<span class="built_in">string</span>&gt;</span> 	tokens;</div><div class="line">	<span class="built_in">sin</span> &gt;&gt; lhs &gt;&gt; foo;</div><div class="line">	<span class="keyword">while</span>(<span class="built_in">sin</span> &gt;&gt; foo)</div><div class="line">		tokens.push_back(foo);</div><div class="line">	Production p(lhs, tokens);</div><div class="line">	p.label = ++production_label;</div><div class="line">	g.rules.push_back(p);</div><div class="line">}</div><div class="line"><span class="keyword">bool</span> isNumber(<span class="built_in">string</span> str) {</div><div class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; str.length(); i++) {</div><div class="line">		<span class="keyword">if</span>(!<span class="built_in">isdigit</span>(str[i]))</div><div class="line">			<span class="keyword">return</span> <span class="keyword">false</span>;</div><div class="line">	}</div><div class="line">	<span class="keyword">return</span> <span class="keyword">true</span>;</div><div class="line">}</div><div class="line"><span class="keyword">int</span> scanTokens(<span class="keyword">char</span> s[], <span class="stl_container"><span class="built_in">queue</span>&lt;<span class="built_in">string</span>&gt;</span>& tokens, <span class="stl_container"><span class="built_in">vector</span>&lt;<span class="built_in">string</span>&gt;</span>& val) {</div><div class="line">	<span class="built_in">string</span> keyword[<span class="number">18</span>] = {<span class="string">"AND"</span>, <span class="string">"THEN"</span>, <span class="string">"GO"</span>, <span class="string">"KEEP"</span>, </div><div class="line">			<span class="string">"RIGHT"</span>, <span class="string">"LEFT"</span>, <span class="string">"FIRST"</span>, <span class="string">"SECOND"</span>, <span class="string">"THIRD"</span>, </div><div class="line">			<span class="string">"AT"</span>, <span class="string">"RECORD"</span>, <span class="string">"TIME"</span>, <span class="string">"TO"</span>, <span class="string">"KMH"</span>, <span class="string">"CHANGE"</span>,</div><div class="line">			<span class="string">"AVERAGE"</span>, <span class="string">"SPEED"</span>, <span class="string">"CAS"</span>};</div><div class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; s[i]; i++) {</div><div class="line">		<span class="keyword">if</span>(s[i] == <span class="string">'"'</span>) {</div><div class="line">			<span class="comment">// s-word can't empty, and after the opening speech marks no more space.</span></div><div class="line">			<span class="keyword">if</span>(s[i + <span class="number">1</span>] == <span class="string">'"'</span> || <span class="built_in">isspace</span>(s[i + <span class="number">1</span>]))	</div><div class="line">				<span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">			i++;</div><div class="line">			<span class="keyword">while</span>(s[i] != <span class="string">'"'</span>) {</div><div class="line">				<span class="keyword">if</span>(<span class="built_in">isupper</span>(s[i])) {}</div><div class="line">				<span class="keyword">else</span> <span class="keyword">if</span>(<span class="built_in">isspace</span>(s[i])) {s[i] = <span class="string">'_'</span>;}</div><div class="line">				<span class="keyword">else</span> <span class="keyword">if</span>(s[i] == <span class="string">'.'</span>) {</div><div class="line">					<span class="keyword">if</span>(<span class="built_in">isspace</span>(s[i - <span class="number">1</span>]) || s[i - <span class="number">1</span>] == <span class="string">'_'</span>) {</div><div class="line">						<span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">					}</div><div class="line">				} <span class="keyword">else</span> {</div><div class="line">					<span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">				}</div><div class="line">				i++;</div><div class="line">			}</div><div class="line">			<span class="keyword">if</span>(s[i] == <span class="string">'\0'</span> || <span class="built_in">isspace</span>(s[i - <span class="number">1</span>]) || s[i - <span class="number">1</span>] == <span class="string">'_'</span>)</div><div class="line">				<span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">		}</div><div class="line">	}</div><div class="line">	<span class="built_in">stringstream</span> 	<span class="built_in">sin</span>(s);</div><div class="line">	<span class="built_in">string</span> 			token;</div><div class="line">	<span class="keyword">while</span>(<span class="built_in">sin</span> &gt;&gt; token) {</div><div class="line">		<span class="keyword">int</span> f = <span class="number">0</span>;</div><div class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">18</span>; i++) {</div><div class="line">			<span class="keyword">if</span>(token == keyword[i])</div><div class="line">				tokens.push(token), val.push_back(token), f = <span class="number">1</span>;</div><div class="line">		}</div><div class="line">		<span class="keyword">if</span>(f)	<span class="keyword">continue</span>;</div><div class="line">		<span class="keyword">if</span>(token[<span class="number">0</span>] == <span class="string">'"'</span>)</div><div class="line">			tokens.push(<span class="string">"SIGNWORDS"</span>), val.push_back(token), f = <span class="number">1</span>;</div><div class="line">		<span class="keyword">if</span>(f)	<span class="keyword">continue</span>;</div><div class="line">		<span class="keyword">if</span>(isNumber(token))</div><div class="line">			tokens.push(<span class="string">"NNN"</span>), val.push_back(token), f = <span class="number">1</span>;</div><div class="line">		<span class="keyword">if</span>(f)	<span class="keyword">continue</span>;</div><div class="line">		<span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">	}</div><div class="line">	<span class="keyword">return</span> <span class="number">1</span>;</div><div class="line">}</div><div class="line"><span class="keyword">int</span> main() {</div><div class="line"><span class="comment">//	freopen("in.txt", "r+t", stdin);</span></div><div class="line"><span class="comment">//	freopen("out.txt", "w+t", stdout);</span></div><div class="line">	Grammar g;</div><div class="line">	parsingProduction(<span class="string">"&lt;instruction&gt; 	-&gt; &lt;navigational&gt;"</span>, g);</div><div class="line">	parsingProduction(<span class="string">"&lt;instruction&gt; 	-&gt; &lt;time-keeping&gt;"</span>, g);</div><div class="line">	parsingProduction(<span class="string">"&lt;instruction&gt; 	-&gt; &lt;navigational&gt; AND &lt;time-keeping&gt;"</span>, g);</div><div class="line">	parsingProduction(<span class="string">"&lt;navigational&gt; 	-&gt; &lt;directional&gt;"</span>, g);</div><div class="line">	parsingProduction(<span class="string">"&lt;navigational&gt; 	-&gt; &lt;navigational&gt; AND THEN &lt;directional&gt;"</span>, g);</div><div class="line">	parsingProduction(<span class="string">"&lt;directional&gt; 	-&gt; &lt;how&gt; &lt;direction&gt;"</span>, g);</div><div class="line">	parsingProduction(<span class="string">"&lt;directional&gt; 	-&gt; &lt;how&gt; &lt;direction&gt; &lt;where&gt;"</span>, g);</div><div class="line">	parsingProduction(<span class="string">"&lt;how&gt; 			-&gt; GO"</span>, g);</div><div class="line">	parsingProduction(<span class="string">"&lt;how&gt; 			-&gt; GO &lt;when&gt;"</span>, g);</div><div class="line">	parsingProduction(<span class="string">"&lt;how&gt;			-&gt; KEEP"</span>, g);</div><div class="line">	parsingProduction(<span class="string">"&lt;direction&gt; 		-&gt; RIGHT"</span>, g);</div><div class="line">	parsingProduction(<span class="string">"&lt;direction&gt;		-&gt; LEFT"</span>, g);</div><div class="line">	parsingProduction(<span class="string">"&lt;when&gt;			-&gt; FIRST"</span>, g);</div><div class="line">	parsingProduction(<span class="string">"&lt;when&gt;			-&gt; SECOND"</span>, g);</div><div class="line">	parsingProduction(<span class="string">"&lt;when&gt;			-&gt; THIRD"</span>, g);</div><div class="line">	parsingProduction(<span class="string">"&lt;where&gt; 			-&gt; AT &lt;sign&gt;"</span>, g);</div><div class="line">	parsingProduction(<span class="string">"&lt;sign&gt;			-&gt; SIGNWORDS"</span>, g);</div><div class="line">	parsingProduction(<span class="string">"&lt;time-keeping&gt; 	-&gt; &lt;record&gt;"</span>, g);</div><div class="line">	parsingProduction(<span class="string">"&lt;time-keeping&gt;	-&gt; &lt;change&gt;"</span>, g);</div><div class="line">	parsingProduction(<span class="string">"&lt;record&gt;			-&gt; RECORD TIME"</span>, g);</div><div class="line">	parsingProduction(<span class="string">"&lt;change&gt;			-&gt; &lt;cas&gt; TO NNN KMH"</span>, g);</div><div class="line">	parsingProduction(<span class="string">"&lt;cas&gt;			-&gt; CHANGE AVERAGE SPEED"</span>, g);</div><div class="line">	parsingProduction(<span class="string">"&lt;cas&gt; 			-&gt; CAS"</span>, g);</div><div class="line">	g.start_symbol = <span class="string">"&lt;instruction&gt;"</span>;</div><div class="line">		</div><div class="line">	g.fill_first_set();</div><div class="line">	g.fill_follow_set();</div><div class="line">	g.build_CFSM();</div><div class="line">	</div><div class="line">	<span class="keyword">char</span> 	line[<span class="number">1024</span>];</div><div class="line">	<span class="keyword">int</span> 	cases = <span class="number">0</span>;</div><div class="line">	<span class="keyword">while</span>(gets(line)) {</div><div class="line">		<span class="keyword">if</span>(!<span class="built_in">strcmp</span>(line, <span class="string">"#"</span>))</div><div class="line">			<span class="keyword">break</span>;</div><div class="line">		<span class="stl_container"><span class="built_in">queue</span>&lt;<span class="built_in">string</span>&gt;</span> tokens;</div><div class="line">		<span class="stl_container"><span class="built_in">vector</span>&lt;<span class="built_in">string</span>&gt;</span> val;</div><div class="line">		<span class="keyword">int</span> f = scanTokens(line, tokens, val);</div><div class="line">		<span class="built_in">printf</span>(<span class="string">"%3d."</span>, ++cases);</div><div class="line">		<span class="keyword">if</span>(!f) {</div><div class="line">			<span class="built_in">puts</span>(<span class="string">" Trap!"</span>);</div><div class="line">			<span class="keyword">continue</span>;</div><div class="line">		}</div><div class="line">		f = g.slr1driver(tokens);</div><div class="line">		<span class="keyword">if</span>(!f) {</div><div class="line">			<span class="built_in">puts</span>(<span class="string">" Trap!"</span>);</div><div class="line">			<span class="keyword">continue</span>;</div><div class="line">		}</div><div class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; val.size(); i++) {</div><div class="line">			<span class="keyword">if</span>(val[i][<span class="number">0</span>] == <span class="string">'"'</span>)</div><div class="line">				<span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; val[i].length(); j++)</div><div class="line">					<span class="keyword">if</span>(val[i][j] == <span class="string">'_'</span>)</div><div class="line">						val[i][j] = <span class="string">' '</span>;</div><div class="line">			<span class="built_in">printf</span>(<span class="string">" %s"</span>, val[i].c_str());</div><div class="line">		}</div><div class="line">		<span class="built_in">puts</span>(<span class="string">""</span>);</div><div class="line">	}</div><div class="line">	<span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">}</div></pre></td></tr></table></figure>


          </div>
          <div class="toggle-input article-more-link"><a>Read More +</a></div>
        
      
    </div>

  </div>
  
</article>


  
    <article id="post-oj/uva/uva-345" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2014/06/19/oj/uva/uva-345/" class="article-date">
  <time datetime="2014-06-18T23:08:16.000Z" itemprop="datePublished">Jun 19 2014</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/解題區/">解題區</a>►<a class="article-category-link" href="/categories/解題區/解題區-UVa/">解題區 - UVa</a>
  </div>

  </div>
  <div class="article-inner ">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2014/06/19/oj/uva/uva-345/">UVa 345 - It&#39;s Ir-Resist-Able</a>
    </h1>
  

      </header>
        
    <footer class="article-footer">
      <a data-url="http://morris821028.github.io/2014/06/19/oj/uva/uva-345/" data-id="c4u3qght0y48kh52" class="article-share-link">Share</a>
      
        <a href="http://morris821028.github.io/2014/06/19/oj/uva/uva-345/#disqus_thread" class="article-comment-link">Comments</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/高斯消去/">高斯消去</a></li></ul>

    </footer>
    <div class="article-entry article-index" itemprop="articleBody">
      
          
        
          <div class="toggle-content">
            <h2 id="Problem">Problem</h2>
<p>A common component in electronic circuits is the resistor. Each resistor has two terminals, and when current flows through a resistor, some of it is converted to heat, thus ``resisting”; the flow of the current. The extent to which it does this is indicated by a single positive numeric value, cleverly called the resistance of the resistor. By the way, the units of resistance are Ohms. Here’s what a single resistor looks like in a diagram of an electronic circuit:</p>
<p>When two resistors are connected in series, as shown below, then their equivalent resistance is just the sum of the resistances of the individual resistors. For example, if the two resistors below had resistances of 100 and 200 Ohms, respectively, then the combined resistance (from point A to point B) would be 300 Ohms. Of course, combining three or more resistors in series would yield a resistance equal to sum of all the individual resistances.</p>
<p>Resistors may also be connected in parallel, like this:</p>
<p>If these two resistors had resistances of 100 and 150 Ohms, then the parallel combination would yield an equivalent resistance between points A and B of</p>
<p>displaymath61</p>
<p>Connecting three resistors in parallel uses the same rule, so a 100 Ohm, 150 Ohm, and 300 Ohm resistor in parallel would yield a combined resistance of just 50 Ohms: that is,</p>
<p>displaymath63</p>
<p>In this problem you’re provided one or more descriptions of resistors and their interconnections. Each possible interconnection point (the terminals of a resistor) is identified by a unique positive integer, its label. And each resistor is specified by giving its two interconnection point labels and its resistance (as a real number).</p>
<p>For example, the input</p>
<p>1 2 100</p>
<p>would tell us that a 100 Ohm resistor was connected between points 1 and 2. A pair of resistors connected in series might be specified like this:</p>
<p>1 2 100<br>2 3 200</p>
<p>Here we’ve got our 100 Ohm resistor connected at points 1 and 2, and another 200 Ohm resistor connected to points 2 and 3. Two resistors in parallel would be similarly specified:</p>
<p>1 2 100<br>1 2 150</p>
<p>Once you know how the resistors are interconnected, and the resistance of each resistor, it’s possible to determine the equivalent resistance between any two points using the simple rules given above. In some cases, that is. Some interconnections of resistors can’t be solved using this approach: you won’t encounter any of these in this problem, however.</p>
<p>Notes</p>
<ul>
<li>Be aware that there may be input test cases with some resistors that don’t contribute to the overall resistance between the indicated points. For example, in the last case shown in the Sample Input section below, the resistor between points 1 and 2 is unused. There must be some flow through a resistor if it is to contribute to the overall resistance.</li>
<li>No resistor will have its ends connected together. That is, the labels associated with the ends of a resistor will always be distinct. </li>
</ul>
<h2 id="Input">Input</h2>
<p>There will be one or more cases to consider. Each will begin with a line containing three integers N, A, and B. A and B indicate the labels of points between which you are to determine the equivalent resistance. N is the number of individual resistors, and will be no larger than 30. N, A and B will all be zero in the line following the last case. Following each <code>N A B</code> line will be N lines, each specifying the labels of the points where a resistor is connected, and the resistance of that resistor, given as a real number.</p>
<h2 id="Output">Output</h2>
<p>For each input case, display a line that includes the case number (they are numbered sequentially starting with 1) and the equivalent resistance, accurate to two decimal places.</p>
<h2 id="Sample_Input">Sample Input</h2>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line">2 1 3</div><div class="line">1 2 100</div><div class="line">2 3 200</div><div class="line">2 1 2</div><div class="line">1 2 100</div><div class="line">1 2 150</div><div class="line">6 1 6</div><div class="line">1 2 500</div><div class="line">1 3 15</div><div class="line">3 4 40</div><div class="line">3 5 100</div><div class="line">4 6 60</div><div class="line">5 6 50</div><div class="line">0 0 0</div></pre></td></tr></table></figure>

<h2 id="Sample_Output">Sample Output</h2>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">Case</span> <span class="number">1</span>: <span class="number">300.00</span> Ohms</div><div class="line"><span class="keyword">Case</span> <span class="number">2</span>: <span class="number">60.00</span> Ohms</div><div class="line"><span class="keyword">Case</span> <span class="number">3</span>: <span class="number">75.00</span> Ohms</div></pre></td></tr></table></figure>

<h2 id="Solution">Solution</h2>
<p><strong> 題目描述： </strong></p>
<p>給定指定的兩個端點 A B，接著會有 N 個電阻，每個電阻值位於端點 X Y 之間。<br>求 A B 之間的等效電阻，特別注意到端點編號是任意整數，並且有可能兩個端點相同 (A = B)，也有可能會有無會流經的電路區域。</p>
<p><strong> 題目解法： </strong></p>
<p>我們假設每個端點的電動勢 (Volt)，使用克希荷夫電路定律（Kirchhoff Circuit Laws）中的 <strong> 電流定律 </strong>，得到下列公式。</p>
<p>對於每一個端點而言，入電流總量等於出電流總量：</p>
<span>$$\sum_{j = 1}^{n} \frac{V_{j} - V_{i}}{R_{i, j}} = 0$$</span>

<p>但是題目給定的起點和終點並不會在其中，因此假設起點 <code>V[A] = INF</code>，終點 <code>V[B] = 0</code>，接著算出其他所有點的電動勢。共有 <code>n - 2</code> 條方程式，<code>n - 2</code> 個變數，使用高斯消去求解。</p>
<ul>
<li>必須預處理與起點、終點之間的電流關係。</li>
<li>特別注意到起點和終點相同，直接輸出等效電阻 0。</li>
<li>端點編號離散化集中處理。</li>
</ul>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div></pre></td><td class="code"><pre><div class="line"><span class="preprocessor">#<span class="keyword">include</span> &lt;stdio.h&gt; </span></div><div class="line"><span class="preprocessor">#<span class="keyword">include</span> &lt;string.h&gt;</span></div><div class="line"><span class="preprocessor">#<span class="keyword">include</span> &lt;algorithm&gt;</span></div><div class="line"><span class="preprocessor">#<span class="keyword">include</span> &lt;vector&gt;</span></div><div class="line"><span class="preprocessor">#<span class="keyword">include</span> &lt;math.h&gt;</span></div><div class="line"><span class="preprocessor">#<span class="keyword">include</span> &lt;map&gt;</span></div><div class="line"><span class="preprocessor">#<span class="keyword">include</span> &lt;iostream&gt;</span></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"><span class="comment">// learn: http://blog.csdn.net/jiangshibiao/article/details/28661223		</span></div><div class="line"><span class="preprocessor">#<span class="keyword">define</span> MAXN 105</span></div><div class="line"><span class="preprocessor">#<span class="keyword">define</span> INF 1e+6</span></div><div class="line"><span class="preprocessor">#<span class="keyword">define</span> eps 1e-9</span></div><div class="line"><span class="keyword">double</span> R[MAXN][MAXN] = {}, V[MAXN] = {}; <span class="comment">// R: resist, V: voltage</span></div><div class="line"><span class="keyword">double</span> f[MAXN][MAXN] = {}; <span class="comment">// function need solved;</span></div><div class="line"><span class="keyword">int</span> main() {</div><div class="line">	<span class="keyword">int</span> N, A, B;</div><div class="line">	<span class="keyword">int</span> x, y, l;</div><div class="line">	<span class="keyword">int</span> cases = <span class="number">0</span>;</div><div class="line">	<span class="keyword">double</span> w;</div><div class="line">	<span class="keyword">char</span> s1[<span class="number">105</span>], s2[<span class="number">105</span>];</div><div class="line">	<span class="keyword">while</span>(<span class="built_in">scanf</span>(<span class="string">"%d %d %d"</span>, &amp;N, &amp;A, &amp;B) == <span class="number">3</span>) {</div><div class="line">		<span class="keyword">if</span>(N == <span class="number">0</span>)</div><div class="line">			<span class="keyword">break</span>;</div><div class="line">		<span class="stl_container"><span class="built_in">map</span>&lt;<span class="keyword">int</span>, <span class="keyword">int</span>&gt;</span> label;</div><div class="line">		l = label[A];</div><div class="line">		<span class="keyword">if</span>(l == <span class="number">0</span>)	label[A] = label.size();</div><div class="line">		A = label[A];</div><div class="line">		</div><div class="line">		l = label[B];</div><div class="line">		<span class="keyword">if</span>(l == <span class="number">0</span>)	label[B] = label.size();</div><div class="line">		B = label[B];</div><div class="line">		</div><div class="line">		<span class="built_in">memset</span>(R, <span class="number">0</span>, <span class="keyword">sizeof</span>(R));</div><div class="line">		<span class="built_in">memset</span>(V, <span class="number">0</span>, <span class="keyword">sizeof</span>(V));</div><div class="line">		<span class="built_in">memset</span>(f, <span class="number">0</span>, <span class="keyword">sizeof</span>(f));</div><div class="line">		<span class="stl_container"><span class="built_in">vector</span>&lt;<span class="keyword">double</span>&gt;</span> g[MAXN][MAXN];</div><div class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; N; i++) {</div><div class="line">			<span class="built_in">scanf</span>(<span class="string">"%d %d %lf"</span>, &amp;x, &amp;y, &amp;w);</div><div class="line">			</div><div class="line">			l = label[x];</div><div class="line">			<span class="keyword">if</span>(l == <span class="number">0</span>)	label[x] = label.size();</div><div class="line">			x = label[x];</div><div class="line">			</div><div class="line">			l = label[y];</div><div class="line">			<span class="keyword">if</span>(l == <span class="number">0</span>)	label[y] = label.size();</div><div class="line">			y = label[y];</div><div class="line">			</div><div class="line">			g[x][y].push_back(w);</div><div class="line">			g[y][x].push_back(w);</div><div class="line">		}</div><div class="line">		N = label.size();</div><div class="line"></div><div class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i++) {</div><div class="line">			<span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= N; j++) {</div><div class="line">				<span class="keyword">if</span>(g[i][j].size()) {</div><div class="line">					<span class="keyword">double</span> r = <span class="number">0</span>;</div><div class="line">					<span class="keyword">for</span>(<span class="keyword">int</span> k = <span class="number">0</span>; k &lt; g[i][j].size(); k++) {</div><div class="line">						r += <span class="number">1.0</span> / g[i][j][k];</div><div class="line">					}</div><div class="line">					R[i][j] = <span class="number">1.0</span> / r;</div><div class="line">				}</div><div class="line">			}</div><div class="line">		}</div><div class="line">		V[A] = INF, V[B] = <span class="number">0</span>;</div><div class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i++) {</div><div class="line">			<span class="keyword">if</span>(i == A)	<span class="keyword">continue</span>;</div><div class="line">			<span class="keyword">if</span>(i == B)	<span class="keyword">continue</span>;</div><div class="line">			<span class="keyword">if</span>(R[i][A] &gt; <span class="number">0</span>)</div><div class="line">				f[i][i] -= <span class="number">1.0</span> / R[i][A], f[i][N + <span class="number">1</span>] -= V[A] / R[i][A];</div><div class="line">			<span class="keyword">if</span>(R[i][B] &gt; <span class="number">0</span>)</div><div class="line">				f[i][i] -= <span class="number">1.0</span> / R[i][B], f[i][N + <span class="number">1</span>] -= V[B] / R[i][B];</div><div class="line">			<span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= N; j++) {</div><div class="line">				<span class="keyword">if</span>(R[i][j] &gt; <span class="number">0</span> &amp;&amp; i != j &amp;&amp; j != A &amp;&amp; j != B)</div><div class="line">					f[i][j] = <span class="number">1.0</span> / R[i][j], f[i][i] -= <span class="number">1.0</span> / R[i][j];</div><div class="line">			}</div><div class="line">		}</div><div class="line">		<span class="comment">// Gaussian Elimination</span></div><div class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i++) {</div><div class="line">			<span class="keyword">int</span> k = i;</div><div class="line">			<span class="keyword">for</span>(<span class="keyword">int</span> j = i + <span class="number">1</span>; j &lt;= N; j++)</div><div class="line">				<span class="keyword">if</span>(f[j][i] &gt; <span class="number">0</span>)</div><div class="line">					k = j;</div><div class="line">			<span class="keyword">if</span>(<span class="built_in">fabs</span>(f[k][i]) &lt; eps)</div><div class="line">				<span class="keyword">continue</span>;</div><div class="line">			<span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= N + <span class="number">1</span>; j++)</div><div class="line">				swap(f[i][j], f[k][j]);</div><div class="line">			<span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= N; j++) {</div><div class="line">				<span class="keyword">if</span>(i == j)	<span class="keyword">continue</span>;</div><div class="line">				<span class="keyword">for</span>(<span class="keyword">int</span> k = N + <span class="number">1</span>; k &gt;= i; k--)</div><div class="line">					f[j][k] = f[j][k] - f[j][i] / f[i][i] * f[i][k];</div><div class="line">			}</div><div class="line">		}</div><div class="line"></div><div class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i++) {</div><div class="line">			<span class="keyword">if</span>(i == A)	<span class="keyword">continue</span>;</div><div class="line">			<span class="keyword">if</span>(i == B)	<span class="keyword">continue</span>;</div><div class="line">			<span class="keyword">if</span>(<span class="built_in">fabs</span>(f[i][i]) &gt; eps)</div><div class="line">				V[i] = f[i][N + <span class="number">1</span>] / f[i][i];</div><div class="line">		}</div><div class="line">		</div><div class="line">		<span class="keyword">double</span> IB = <span class="number">0</span>;</div><div class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i++)</div><div class="line">			<span class="keyword">if</span>(R[i][B] &gt; <span class="number">0</span>)</div><div class="line">				IB += V[i] / R[i][B];</div><div class="line">		<span class="keyword">if</span>(<span class="built_in">fabs</span>(IB) &lt; eps)</div><div class="line">			<span class="built_in">printf</span>(<span class="string">"Case %d: %.2lf Ohms\n"</span>, ++cases, <span class="number">0</span>);</div><div class="line">		<span class="keyword">else</span></div><div class="line">			<span class="built_in">printf</span>(<span class="string">"Case %d: %.2lf Ohms\n"</span>, ++cases, (V[A] - V[B]) / IB);</div><div class="line">	}</div><div class="line">	<span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">}</div></pre></td></tr></table></figure>
          </div>
          <div class="toggle-input article-more-link"><a>Read More +</a></div>
        
      
    </div>

  </div>
  
</article>


  
    <article id="post-oj/uva/uva-313" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2014/06/17/oj/uva/uva-313/" class="article-date">
  <time datetime="2014-06-16T23:19:14.000Z" itemprop="datePublished">Jun 17 2014</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/解題區/">解題區</a>►<a class="article-category-link" href="/categories/解題區/解題區-UVa/">解題區 - UVa</a>
  </div>

  </div>
  <div class="article-inner ">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2014/06/17/oj/uva/uva-313/">UVa 313 - Intervals</a>
    </h1>
  

      </header>
        
    <footer class="article-footer">
      <a data-url="http://morris821028.github.io/2014/06/17/oj/uva/uva-313/" data-id="p6w39oz3mlmzpbd4" class="article-share-link">Share</a>
      
        <a href="http://morris821028.github.io/2014/06/17/oj/uva/uva-313/#disqus_thread" class="article-comment-link">Comments</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/幾何/">幾何</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/掃描線/">掃描線</a></li></ul>

    </footer>
    <div class="article-entry article-index" itemprop="articleBody">
      
          
        
          <div class="toggle-content">
            <h2 id="Problem">Problem</h2>
<p>In the ceiling in the basement of a newly open developers building a light source has been installed. Unfortunately, the material used to cover the floor is very sensitive to light. It turned out that its expected life time is decreasing dramatically. To avoid this, authorities have decided to protect light sensitive areas from strong light by covering them. The solution was not very easy because, as it is common, in the basement there are different pipelines under the ceiling and the authorities want to install the covers just on those parts of the floor that are not shielded from the light by pipes. To cope with the situation, the first decision was to simplify the real situation and, instead of solving the problem in 3D space, to construct a 2D model first.</p>
<p>Within this model, the x-axis has been aligned with the level of the floor. The light is considered to be a point light source with integer co-ordinates tex2html_wrap_inline36 . The pipes are represented by circles. The center of the circle i has the integer co-ordinates tex2html_wrap_inline40 and an integer radius tex2html_wrap_inline42 . As pipes are made from solid material, circles cannot overlap. Pipes cannot reflect the light and the light cannot go through the pipes. You have to write a program which will determine the non-overlapping intervals on the x-axis where there is, due to the pipes, no light from the light source.</p>
<h2 id="Input">Input</h2>
<p>The input file consists of blocks of lines, each of which except the last describes one situation in the basement. The first line of each block contains a positive integer number N &lt; 500 expressing the number of pipes. The second line of the block contains two integers tex2html_wrap_inline48 and tex2html_wrap_inline50 separated by one space. Each of the next N lines of the block contains integers tex2html_wrap_inline54 , tex2html_wrap_inline56 and tex2html_wrap_inline42 , where tex2html_wrap_inline60 . Integers in individual lines are separated by one space. The last block consists of one line containing n = 0.</p>
<h2 id="Output">Output</h2>
<p>The output file consists of blocks of lines, corresponding to the blocks in the file (except the last one). One empty line must be put after each block in the output file. Each of the individual lines of the blocks in the output file will contain two real numbers, the endpoints of the interval where there is no light from the given point light source. The reals are exact to two decimal places and separated by one space. The intervals are sorted according to increasing x-coordinate.</p>
<h2 id="Sample_Input">Sample Input</h2>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line">6</div><div class="line">300 450</div><div class="line">70 50 30</div><div class="line">120 20 20</div><div class="line">270 40 10</div><div class="line">250 85 20</div><div class="line">220 30 30</div><div class="line">380 100 100</div><div class="line">1</div><div class="line">300 300</div><div class="line">300 150 90</div><div class="line">1</div><div class="line">300 300</div><div class="line">390 150 90</div><div class="line">0</div></pre></td></tr></table></figure>

<h2 id="Sample_Output">Sample Output</h2>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">0.72 78.86</div><div class="line">88.50 133.94</div><div class="line">181.04 549.93</div><div class="line"></div><div class="line">75.00 525.00</div><div class="line"></div><div class="line">300.00 862.50</div></pre></td></tr></table></figure>

<h2 id="Solution">Solution</h2>
<p><strong> 題目描述： </strong></p>
<p>現在天花板上面有一盞燈，然後下方有數個圓，請問陰影部分的區間由小至大輸出分別為何。<br>假設不會有圓的高度大於燈的位置，而陰影呈現在 x 軸上。</p>
<p><strong> 題目解法： </strong></p>
<p>求圓 (cx, cy, r) 外一點的切線，由於點 (a, b) 在圓外，通常此點切於圓的線會有兩條。</p>
<p>假設該線斜率為 m，則通過的線為 <code>y = m * (x - a) + b</code>。</p>
<p>藉由點線距公式 <code>|m * (cx - a) - cy + b |/sqrt(m*m + 1) = r</code>，求得 m 之後得到兩條切線，往後求交 x 軸的位置即可。(特別考慮 m 不存在的情況)</p>
<p>最後使用掃描線算法來算聯集。</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div></pre></td><td class="code"><pre><div class="line"><span class="preprocessor">#<span class="keyword">include</span> &lt;stdio.h&gt;</span></div><div class="line"><span class="preprocessor">#<span class="keyword">include</span> &lt;algorithm&gt;</span></div><div class="line"><span class="preprocessor">#<span class="keyword">include</span> &lt;vector&gt;</span></div><div class="line"><span class="preprocessor">#<span class="keyword">include</span> &lt;math.h&gt;</span></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"></div><div class="line"><span class="keyword">int</span> main() {</div><div class="line">    <span class="keyword">int</span> N;</div><div class="line">    <span class="keyword">double</span> bx, by, cx, cy, cr;</div><div class="line">    <span class="keyword">while</span> (<span class="built_in">scanf</span>(<span class="string">"%d"</span>, &N) == <span class="number">1</span> && N) {</div><div class="line">    	<span class="built_in">scanf</span>(<span class="string">"%lf %lf"</span>, &bx, &by);</div><div class="line">        <span class="stl_container"><span class="built_in">vector</span>&lt; pair&lt;<span class="keyword">double</span>, <span class="keyword">double</span>&gt;</span> &gt; interval;</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; N; i++) {</div><div class="line">            <span class="built_in">scanf</span>(<span class="string">"%lf %lf %lf"</span>, &cx, &cy, &cr);</div><div class="line">            <span class="keyword">double</span> a, b, c;</div><div class="line">            a = (cx - bx) * (cx - bx) - cr * cr;</div><div class="line">            b = <span class="number">2</span> * (cx - bx) * (by - cy);</div><div class="line">            c = (by - cy) * (by - cy) - cr * cr;</div><div class="line">            <span class="keyword">if</span> (b * b - <span class="number">4</span> * a * c &gt; <span class="number">0</span>) {</div><div class="line"><span class="preprocessor">#<span class="keyword">define</span> eps 1e-6</span></div><div class="line">                <span class="keyword">if</span> (<span class="built_in">fabs</span>(a) &gt; eps) {</div><div class="line">                    <span class="keyword">double</span> m1 = (-b + <span class="built_in">sqrt</span>(b * b - <span class="number">4</span> * a * c))/(<span class="number">2</span> * a);</div><div class="line">                    <span class="keyword">double</span> m2 = (-b - <span class="built_in">sqrt</span>(b * b - <span class="number">4</span> * a * c))/(<span class="number">2</span> * a);</div><div class="line">                    <span class="keyword">double</span> l, r;</div><div class="line">                    c = by - m1 * bx;</div><div class="line">                    l = -c / m1;</div><div class="line">                    c = by - m2 * bx;</div><div class="line">                    r = -c / m2;</div><div class="line">                    <span class="keyword">if</span> (l &gt;= r)</div><div class="line">                        swap(l, r);</div><div class="line">                    interval.push_back(make_pair(l, r));</div><div class="line">                } <span class="keyword">else</span> {</div><div class="line">                    <span class="keyword">double</span> m1 = -c / b;</div><div class="line">                    <span class="keyword">double</span> l, r;</div><div class="line">                    c = by - m1 * bx;</div><div class="line">                    l = -c / m1;</div><div class="line">                    r = bx;</div><div class="line">                    <span class="keyword">if</span> (l &gt;= r)</div><div class="line">                        swap(l, r);</div><div class="line">                    interval.push_back(make_pair(l, r));</div><div class="line">                }</div><div class="line">            }</div><div class="line">        }</div><div class="line">        sort(interval.begin(), interval.end());</div><div class="line">        <span class="keyword">double</span> coverL, coverR;</div><div class="line">        coverL = interval[<span class="number">0</span>].first;</div><div class="line">        coverR = interval[<span class="number">0</span>].second;</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; interval.size(); i++) {</div><div class="line">            <span class="keyword">if</span> (interval[i].first &lt;= coverR) {</div><div class="line">                coverR = max(coverR, interval[i].second);</div><div class="line">            } <span class="keyword">else</span> {</div><div class="line">                <span class="built_in">printf</span>(<span class="string">"%.2lf %.2lf\n"</span>, coverL, coverR);</div><div class="line">                coverL = interval[i].first;</div><div class="line">                coverR = interval[i].second;</div><div class="line">            }</div><div class="line">        }</div><div class="line">        <span class="built_in">printf</span>(<span class="string">"%.2lf %.2lf\n"</span>, coverL, coverR);</div><div class="line">        <span class="built_in">puts</span>(<span class="string">""</span>);</div><div class="line">    }</div><div class="line">    <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">}</div></pre></td></tr></table></figure>


          </div>
          <div class="toggle-input article-more-link"><a>Read More +</a></div>
        
      
    </div>

  </div>
  
</article>


  
  
    <nav id="page-nav">
      <a class="extend prev" rel="prev" href="/page/56/">&laquo; Prev</a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/55/">55</a><a class="page-number" href="/page/56/">56</a><span class="page-number current">57</span><a class="page-number" href="/page/58/">58</a><a class="page-number" href="/page/59/">59</a><span class="space">&hellip;</span><a class="page-number" href="/page/66/">66</a><a class="extend next" rel="next" href="/page/58/">Next &raquo;</a>
    </nav>
  
</section>
          
            <aside id="sidebar">
  <div id="ukagaka_panel"></div>
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Categories</h3>
    <div class="widget">
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/學校課程/">學校課程</a><span class="category-list-count">63</span><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/學校課程/介面設計/">介面設計</a><span class="category-list-count">5</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/學校課程/作業系統/">作業系統</a><span class="category-list-count">6</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/學校課程/大學專題/">大學專題</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/學校課程/巨量資料/">巨量資料</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/學校課程/敏捷方法/">敏捷方法</a><span class="category-list-count">3</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/學校課程/編譯器/">編譯器</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/學校課程/自然語言/">自然語言</a><span class="category-list-count">5</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/學校課程/虛擬實境/">虛擬實境</a><span class="category-list-count">4</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/學校課程/計算型智慧/">計算型智慧</a><span class="category-list-count">3</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/學校課程/計算幾何/">計算幾何</a><span class="category-list-count">6</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/學校課程/資料庫系統/">資料庫系統</a><span class="category-list-count">4</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/學校課程/資訊安全/">資訊安全</a><span class="category-list-count">9</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/學校課程/通識課程/">通識課程</a><span class="category-list-count">14</span></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/手札日記/">手札日記</a><span class="category-list-count">24</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/網頁設計/">網頁設計</a><span class="category-list-count">14</span><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/網頁設計/About-This-Blog/">About This Blog</a><span class="category-list-count">6</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/網頁設計/HTML5/">HTML5</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/網頁設計/JQuery/">JQuery</a><span class="category-list-count">4</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/網頁設計/Markdown/">Markdown</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/網頁設計/NodeJs/">NodeJs</a><span class="category-list-count">2</span></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/解題區/">解題區</a><span class="category-list-count">552</span><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/解題區/Latex/">Latex</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/解題區/出題解題/">出題解題</a><span class="category-list-count">16</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/解題區/解題區-POJ/">解題區 - POJ</a><span class="category-list-count">3</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/解題區/解題區-UVa/">解題區 - UVa</a><span class="category-list-count">453</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/解題區/解題區-Zerojudge/">解題區 - Zerojudge</a><span class="category-list-count">50</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/解題區/解題區-其他題目/">解題區 - 其他題目</a><span class="category-list-count">28</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/解題區/解題區-未解題目/">解題區 - 未解題目</a><span class="category-list-count">1</span></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/雜言筆記/">雜言筆記</a><span class="category-list-count">4</span></li></ul>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recents</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a class="text" href="/2015/07/15/zj-b446/">
              
                <i class="icon-file-o"></i> 
              
            b446. 搜索美學 史蒂芙的煩惱</a>
          </li>
        
          <li>
            <a class="text" href="/2015/07/15/zj-b443/">
              
                <i class="icon-file-o"></i> 
              
            b443. 我愛 Fibonacci</a>
          </li>
        
          <li>
            <a class="text" href="/2015/07/13/zj-b444/">
              
                <i class="icon-file-o"></i> 
              
            b444. 期望試驗 快速冪次</a>
          </li>
        
          <li>
            <a class="text" href="/2015/07/12/diary-20150712/">
              
                <i class="icon-file-o"></i> 
              
            在醒不來的夢中探索</a>
          </li>
        
          <li>
            <a class="text" href="/2015/07/12/zj-b440/">
              
                <i class="icon-file-o"></i> 
              
            b440. 互質對</a>
          </li>
        
          <li>
            <a class="text" href="/2015/07/12/zj-b441/">
              
                <i class="icon-file-o"></i> 
              
            b441. 延展尺寸</a>
          </li>
        
          <li>
            <a class="text" href="/2015/07/12/zj-b438/">
              
                <i class="icon-file-o"></i> 
              
            b438. 裁剪尺寸</a>
          </li>
        
          <li>
            <a class="text" href="/2015/07/11/zj-b442/">
              
                <i class="icon-file-o"></i> 
              
            b442. 快取實驗 矩陣乘法</a>
          </li>
        
          <li>
            <a class="text" href="/2015/07/11/zj-b439/">
              
                <i class="icon-file-o"></i> 
              
            b439. 快取置換機制</a>
          </li>
        
          <li>
            <a class="text" href="/2015/07/11/zj-b435/">
              
                <i class="icon-file-o"></i> 
              
            b435. 尋找原根</a>
          </li>
        
      </ul>
    </div>
  </div>

  
    <div class="widget-wrap">
    <h3 class="widget-title">Links</h3>
    <div class="widget">   
      	<ul>
	      <li><a href="http://mypaper.pchome.com.tw/zerojudge" target="_blank" title="Old Blog"><i class="icon-star"></i> Morris' Blog (pchome)</a></li>
	      <li><a href="http://flere114.blogspot.tw/" target="_blank" title="蘿莉勿觸"><i class="icon-googles"></i> flere's Blog</a></li>
	      <li><a href="http://dreamoon4.blogspot.tw/" target="_blank" title="夢月"><i class="icon-googles"></i> dreamoon's Blog</a></li>
	      <li><a href="http://m80126colin.github.io" target="_blank" title="許胖們"><i class="icon-github-alt"></i> m80126colin's Blog</a></li>
	      <li><a href="http://sd12582000.blogspot.tw/" target="_blank" title="妮可妮可"><i class="icon-github-alt"></i> Nico's Blog</a></li>
	      <li><a href="http://kuoe0.logdown.com/" target="_blank" title="郭至軒大神"><i class="icon-github-alt"></i> KuoE0's Dots</a></li>
	      <li><a href="http://tyan.io/" title=""><i class="icon-github-alt"></i> Tyan Blog</a></li>
    	</ul>
    </div>
</div>

  
    
<script src="/js/jquery-ui.js"></script>
<script src="/js/ukagaka/jquery.morris.ukagaka.resource.js"></script>
<script src="/js/ukagaka/typed.js"></script>
<script type="text/javascript">
  $('#ukagaka_panel').ukagaka();
</script>
  
</aside>
          
        
      </div>
      <footer id="footer">
  
  <div class="outer">    
    <div class="social-group">
      
      <a href="https://github.com/morris821028" target="_blank" title="github"><i class="icon-github"></i></a>
      
      
      <a href="https://plus.google.com/u/0/108158678174364359204" target="_blank" title="Google+"><i class="icon-google-plus-sign"></i></a>
      
      
      <a href="https://www.facebook.com/Morris1028" target="_blank" title="facebook"><i class="icon-facebook-sign"></i></a>
      
      
      <a href="http://uhunt.felix-halim.net/id/46705" target="_blank" title="uhunt" ><span class="icon-uhunt">UVa<span></a>
      
    </div>
    <div id="footer-info" class="inner">
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a> and Theme by <a href="https://github.com/morris821028/hexo-theme-landscape" target="_blank" title="landscape">landscape</a> &copy; 2015 Shiang-Yun Yang 
    </div>  

  </div>
</footer>


    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link"><i class=icon-home ></i>&nbsp&nbspHome</a>
  
    <a href="/about" class="mobile-nav-link"><i class=icon-user ></i>&nbsp&nbspAbout</a>
  
    <a href="/archives" class="mobile-nav-link"><i class=icon-archive ></i>&nbsp&nbspArchives</a>
  
    <a href="/tags" class="mobile-nav-link"><i class=icon-tags ></i>&nbsp&nbspTags</a>
  
    <a href="/picture" class="mobile-nav-link"><i class=icon-camera ></i>&nbsp&nbspPictures</a>
  
    <a href="/works" class="mobile-nav-link"><i class=icon-trophy ></i>&nbsp&nbspWorks</a>
  
</nav>
    
<script>
  var disqus_shortname = 'morris1028';
  
  (function(){
    var dsq = document.createElement('script');
    dsq.type = 'text/javascript';
    dsq.async = true;
    dsq.src = '//go.disqus.com/count.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
  })();
</script>


<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css" type="text/css">

  <script src="/fancybox/jquery.fancybox.pack.js" type="text/javascript"></script>



<script src="/js/jquery.lazyload.js" type="text/javascript"></script>

<script src="/js/jquery.als-1.6.js" type="text/javascript"></script>


<script src="/js/script.js" type="text/javascript"></script>


  </div>
</body>
</html>